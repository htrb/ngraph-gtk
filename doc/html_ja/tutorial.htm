<HTML>
<HEAD>
<TITLE>Tutorial</TITLE>
</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000" LINK="#0000FF" ALINK="#0000FF" VLINK="#0000FF">
<A NAME="TOP">&nbsp;</A>
<A HREF="./ngraph.htm"><B>チュートリアル</B></A>
<UL>
<LI><A HREF="#VIEW">外観</A>
<OL>
<LI>起動画面
</OL>
<LI><A HREF="#GRAPH">グラフ作成の概略</A>
<OL>
<LI>データファイルを用意する
<LI>グラフの種類を決める
<LI>データファイルを開く
<LI>描画する
</OL>
<LI><A HREF="#SCALE">軸のスケール</A>
<OL>
<LI>スケールを変える
<LI>スケールをクリアする
<LI>一部を拡大する
<LI>スケールの値を元に戻す
</OL>
<LI><A HREF="#PLOT">プロット方法</A>
<OL>
<LI>プロット方法を変える
<LI>曲線＋点でプロットする
<LI>データ点の評価・マスク・移動
</OL>
<LI><A HREF="#LEGEND">グラフを飾りづける</A>
<OL>
<LI>Legend を入れる
<LI>Viewer Window 上での移動、設定変更
<LI>レジェンドの複製
<LI>legend.nsc を使う
<LI>込み合っているレジェンドの選択方法
</OL>
<LI><A HREF="#OUTPUT">グラフの印刷・保存・読み込み、ファイルへの出力</A>
<OL>
<LI>グラフの印刷
<LI>グラフの保存
<LI>グラフの読み込み
<LI>外部ドライバによるファイルへの出力
<LI>GRAファイルへの出力
</OL>
<LI><A HREF="#FIT">フィッティング</A>
<OL>
<LI>通常のフィット
<LI>任意関数によるフィット
</OL>
<LI><A HREF="#MATH">数式変換機能を使う</A>
<OL>
<LI>データを数式で変換してプロットする
</OL>
<LI><A HREF="#MULTI">複数のグラフ</A>
<OL>
<LI>複数のグラフの作り方
<LI>append.nsc を使う
<LI>軸の名称
<LI>プロットする軸の指定
<LI>軸の連携
</OL>
</UL>

<BR>
<HR SIZE="5">
<BR>

<BR>
<A NAME="VIEW">&nbsp;</A>
<A HREF="#TOP"><B>外観</B></A>
<OL>
<LI><B>起動画面</B>
<BR>
<BR>
Ngraph を起動すると下図の様に4つのウィンドウが開かれます。
<BLOCKQUOTE>
<IMG SRC="./tutorial/window.jpg" WIDTH="450" HEIGHT="359" ALT="">
</BLOCKQUOTE>
ここでは、簡単に各ウィンドウの説明をします。
<UL>
<DL>
<DT>Viewer Window
<DD>Ngraphのメインウィンドウです。グラフはこの Viewer Window に表示されます。
メニュー、コントロールボタンなども、このウィンドウに付いています。
<DT>コントロールボタン(上部)
<DD>通常のウィンドウアプリケーションと同様に、ファイルのオープンなど頻繁に使うメニューコマンドがボタンに割り当てられています。
<DT>コントロールボタン(左サイド)
<DD>
Viewer Window上でのマウスによる操作モードを指定するトグルボタン列です。グラフィックスオブジェクトの選択モード、レジェンド種類別の作成モード、プロットされたデータの評価モード、画面の拡大縮小モードなどを切り替えます。
<DT>Data Window
<DD>開かれたデータファイルが一覧表示されます。また、プロットの為の各種パラメターも一覧表示されます。このリストをダブルクリックするとデータダイアログボックスが開き、各種設定を変更する事ができます。
<DT>Axis Window
<DD>座標軸の名前と、スケールの数値などの各種パラメターが一覧表示されます。このリストをダブルクリックすると軸ダイアログボックスが開き、各種設定を変更する事ができます。
<DT>Coordinate Window
<DD>Viewer Windowのマウスカーソルの位置が表示されます。また、座標軸が有る場合にはマウスカーソルの位置に対応する軸の座標も表示されます。
</DL>
</UL>
<BLOCKQUOTE>
この他にも、レジェンドを一覧表示する "Legend Window"、合成ファイルを一覧表示する "Merge Window"、フィットの結果等を表示する "Information Window" などのウィンドウを開く事ができます。
また、各ウィンドウ上でマウスの右ボタンをクリックすると、それぞれのウィンドウで異なるポップアップメニューを出す事ができ、各種操作が行えるようになっています。
</BLOCKQUOTE>

<BLOCKQUOTE>
各ウィンドウの位置は独立して動かせますが、同時に全てのウィンドウの位置を動かしたい時には、CtlキーあるいはAltキーを押しながら Viewer Window をドラッグしてください。
あるいは、[ウィンドウ]-[子ウィンドウの自動移動]を選択して Viewer Window をドラッグしてください。
</BLOCKQUOTE>

</OL>

<BR>
<HR>
<BR>

<A NAME="GRAPH">&nbsp;</A>
<A HREF="#TOP"><B>グラフ作成の概略</B></A>
<OL>
<LI><B>データファイルを用意する</B>
<BR>
<BR>
Ngraphはデータファイルからデータを読み込みグラフを作成します。
従って、まずデータファイルを用意しなければなりません。エディター、計算プログラム、あるいは測定装置コントロールソフトなどからデータファイルを作成します。
<BR>
<BR>

<LI><B>グラフの種類を決める</B>
<BR>
<BR>
グラフにするデータファイルを用意したらNgraphを起動します。次に作成したいグラフの種類を決めます。Ngraphでは以下の3つに分類されています。
<BLOCKQUOTE>
<TABLE BORDER=1>
<TR>
<TD ALIGN=CENTER><IMG SRC="./tutorial/graphf.jpg" WIDTH="150" HEIGHT="146" ALT=""></TD>
<TD ALIGN=CENTER><IMG SRC="./tutorial/graphs.jpg" WIDTH="150" HEIGHT="146" ALT=""></TD>
<TD ALIGN=CENTER><IMG SRC="./tutorial/graphc.jpg" WIDTH="150" HEIGHT="146" ALT=""></TD>
</TR>
<TR>
<TD>フレームグラフ(Frame graph)<BR>4つの軸で囲まれたグラフ</TD>
<TD>方眼グラフ(Section graph)<BR>4つの軸で囲まれ、方眼線の入ったグラフ</TD>
<TD>交差グラフ(Cross graph)<BR>X-Y２軸のグラフ</TD>
</TABLE>
</BLOCKQUOTE>
初期状態ではフレームグラフが一つ作成されています。フレームグラフの４つの軸のスケールはまだ設定されていませんので、軸の基線を示す枠だけが表示されています。
これで良ければ次に進みます。
他の種類のグラフを作成するには、[グラフ]-[新規作成]([Graph]-[New graph])メニューで作成するグラフの種類を指定します。
<BR>
<BR>

<LI><B>データファイルを開く</B>
<BR>
<BR>
次に、準備してあるデータファイルを開きます。
データファイルを開くには様々な方法が有りますが、取り敢えず[データ]-[開く]([Data]-[Open])メニューを選び、ファイル選択のダイアログボックスでデータファイルを開いてください。<BR>
<BLOCKQUOTE>
データファイルを開く方法は他にも用意されています。
<OL>
<LI>下図のコントロールボタンを押す。<BR>
<IMG SRC="./tutorial/fopen.jpg" WIDTH="490" HEIGHT="50" ALT="file open control button">
<LI>Data Window上でマウス右ボタンを押してポップアップメニューを出し、"Open" メニューを選ぶ。
<LI>エクスプローラ等からデータファイルを選び、Viewer Window上にドラッグ&amp;ドロップする。
</OL>
</BLOCKQUOTE>
いずれの方法でも、データファイルを指定すると次いでプロット方法などを指定するデータダイアログボックスが開きますが、取り敢えず OK で閉じてください。
<BR>
<BR>

<LI><B>描画する</B>
<BR>
<BR>
Ngraphではファイルを開いても自動的には描画しないようになっています。グラフを描画するには下図のボタンを押してください。<BR>
<IMG SRC="./tutorial/draw.jpg" WIDTH="490" HEIGHT="50" ALT="">
<BLOCKQUOTE>
描画する方法は他にも用意されています。
<OL>
<LI>[出力]-[描画]([Output]-[Draw])メニューを選択する。
<LI>Viewer Window をアクティブにしてスペースキーを押す。
</OL>
</BLOCKQUOTE>
この様にして描画すると軸のスケールは少し余白をとるように自動的に設定され、グラフが描画されます。
</OL>

<BR>
<HR>
<BR>

<A NAME="SCALE">&nbsp;</A>
<A HREF="#TOP"><B>軸のスケール</B></A>
<OL>
<LI><B>スケールを変える</B>
<BR>
<BR>
特にスケ−ル (座標軸の上限・下限)を設定せずに描画した場合にはオ−トスケ−ルで値が決められます。
また Axis Window には軸が一覧表示されています。フレームグラフの場合には軸は４つあり、それぞれ "fX1", "fY1", "fU1", "fR1" と名前が付いています。
これらの軸のスケールを変更するには、下図の様に Axis Window の一覧から変更したい軸を選んでダブルクリックしてください。
<BLOCKQUOTE>
<IMG SRC="./tutorial/awindow.jpg" WIDTH="250" HEIGHT="149" ALT="">
</BLOCKQUOTE>
<BLOCKQUOTE>
軸ダイアログボックスを開く方法は他にも用意されています。
<OL>
<LI>[軸]-[設定] ([Axis]-[Update]) メニューでプ変更したい軸を選ぶ。
<LI>下図ボタンのいずれか一方(どちらでも良いです)を押してグラフィックスオブジェクト選択モード(あるいは軸のみの選択モード)にしてViewer Window 上で軸をダブルクリックし、次いで出てくるダイアログボックスで変更したい軸のボタンを押す。<BR>
<IMG SRC="./tutorial/axispo.jpg" WIDTH="460" HEIGHT="50" ALT="">
</OL>
</BLOCKQUOTE>
この様にすると下図の軸ダイアログボックスが開かれます。
ここで、「最小値」「最大値」「増分」に軸のスケ−ルの最小，最大，増分を指定してください。
目盛数字は増分に対して付けられます。
「分割数」は「増分」をさらに何等分して目盛線を引くかを決めます。
この値が0の時は自動的に分割数が決められます。
「スケール法」では通常の線形軸（linear）、ログ(log）、逆数(inverse)の中から１つを選ぶ事ができます。
「ファイル」ボタンを押すとスケールを開いたデータファイル中から指定したファイルでオ−トスケ−ルを行って決める事ができます。<BR>
「クリア」はスケールの設定を未設定状態にします。
<BLOCKQUOTE>
<IMG SRC="./tutorial/adialog.jpg" WIDTH="300" HEIGHT="130" ALT="">
</BLOCKQUOTE>
さらに軸に関する細かい設定ができるように「軸基線」「目盛線」「目盛数字」「フォント」「位置」のボタンが用意されています。
「軸基線」ボタンを押して軸の基線の太さ、色などの設定を行います。
軸の端に矢印をつけたりすることもできます。
「目盛線」ボタンを押して軸の"ゲ−ジ"の長さ、太さ、色などの設定を行います。
また、目盛線をグラフの内側に描くか外側に描くかを決めたり(「位置」)、軸を全部描かずに一部だけにしたり(「範囲最小値」、「範囲最大値」)できます。
「目盛数字」ボタンを押して、その"ゲ−ジ" に振る目盛数字に関する設定を行います。
目盛数字を振り始めるスケ−ルの位置を変えたり（「開始点」、0で自動設定)、間隔を変えたり(「間隔」、0で自動設定)、個数を変えたり(「個数」、-1で自動設定)できます。
「フォント」ボタンを押して目盛数字のフォントの設定を行います。
<BR>
<BR>

<LI><B>スケールをクリアする</B>
<BR>
<BR>
前節で説明したように、軸ダイアログボックスの「クリア」ボタンで、軸のスケール設定を未設定状態にできますが、複数の軸をクリアしたいような場合には[軸]-[スケールクリア]メニューでクリアしたい軸を複数指定し、一括してクリアする事ができます。
あるいは下図ボタンを押しても同じように複数の軸をクリアできます。
<BLOCKQUOTE>
<IMG SRC="./tutorial/aclear.jpg" WIDTH="490" HEIGHT="50" ALT="">
</BLOCKQUOTE>

<LI><B>一部を拡大する</B>
<BR>
<BR>
前節のように軸のスケールは数値を入力して変更しますが、グラフの一部を拡大して描画したい時などはグラフィカルに変更する事もできます。
それには下図ボタンを押してトリミングモードにして Viewer Window 上で軸の範囲をマウスで指定します。
<BLOCKQUOTE>
<IMG SRC="./tutorial/trimming.jpg" WIDTH="460" HEIGHT="50" ALT="">
</BLOCKQUOTE>

<LI><B>スケールの値を元に戻す</B>
<BR>
<BR>
軸のスケールの設定は、各軸10個まで履歴が記憶されています。
従って前節のように一部を拡大描画した後に、元のスケールの設定に簡単に戻す事ができます。
それには下図ボタンを押して設定を戻したい軸を指定してください。
<BLOCKQUOTE>
<IMG SRC="./tutorial/scundo.jpg" WIDTH="490" HEIGHT="50" ALT="">
</BLOCKQUOTE>

</OL>

<BR>
<HR>
<BR>

<A NAME="PLOT">&nbsp;</A>
<A HREF="#TOP"><B>プロット方法</B></A>
<OL>
<LI><B>プロット方法を変える</B>
<BR>
<BR>
デフォルトの状態では、黒い点でデータ点がプロットされます。また、Data Window には開いたデータファイルが一覧表示されています。
プロット方法を変える為に、Data Window の一覧表示をダブルクリックしてデータダイアログボックスを開いてください。
<BLOCKQUOTE>
<IMG SRC="./tutorial/fwindow.jpg" WIDTH="250" HEIGHT="149" ALT="">
</BLOCKQUOTE>
<BR>
<BLOCKQUOTE>
データダイアログボックスを開く方法はその他に
<OL>
<LI>[データ]-[設定] ([Data]-[Update]) メニューでプロットしたいデータファイルを選ぶ
<LI>下図ボタンを押してデータ選択モードにして Viewer Window 上でデータをクリックする
<IMG SRC="./tutorial/datapo.jpg" WIDTH="460" HEIGHT="50" ALT="">
<LI>Data Window上でマウス右ボタンを押してポップアップメニューを出し、"Update" メニューを選ぶ
</OL>
があります。
</BLOCKQUOTE>
この様にすると下左図に示すデータダイアログボックスが現れます。
<BLOCKQUOTE>
<TABLE BORDER=0>
<TR><TD><IMG SRC="./tutorial/filedlg.jpg" WIDTH="300" HEIGHT="214" ALT=""></TR><TD><IMG SRC="./tutorial/fdialog.jpg" ALT="148" HEIGHT="123" ALT=""></TD></TR>
</TABLE>
</BLOCKQUOTE>
例えばプロット方法を変更してデータを曲線で結ぶようにするには上右図にの様にプロットタイプを "curve" にします。
その後、データダイアログボックスを OK で閉じ、もう一度描画してください。<BR>
データダイアログボックスでは、その他にドットの大きさ、幅、色などの設定が行えます。
またデ−タファイルの先頭に何のデ−タであるかの注釈をつけておく事が多いと思いますが、その部分を読み飛ばすのには「読み込み」ボタンを押して「先頭スキップ行」を設定します。
<BR>
<BR>

<LI><B>曲線+点でプロットする</B>
<BR>
<BR>
データを曲線と点の両方でプロットするようにするには、同じデータファイルを二度開き、片方を曲線で、もう片方を点でプロットするように設定します。
同じデータ2度開くのも基本的には前節で示した方法で、二回開けば良いのですが、すでに開いて有るファイルをもう一度開くには下図に示したように Data Window 上でマウス右ボタンを押してポップアップメニューを出し "Duplicate" メニューを選び複製を生成するのがより簡単です。
Data Window でINSキーを押す事でも同様の操作が行えます。
下左図は Data Window でポップアップメニューを出した状態です。"Duplicate"メニューを選ぶ事で下右図のように Data Window には同じファイルが2つリストされるようになります。<BR>
<BLOCKQUOTE>
<TABLE BORDER=0>
<TR><TD><IMG SRC="./tutorial/fdup.jpg" WIDTH="250" HEIGHT="156" ALT=""></TD><TD><IMG SRC="./tutorial/fwindow2.jpg" WIDTH="250" HEIGHT="149" ALT=""></TD></TR>
</TABLE>
</BLOCKQUOTE>
このようにして2度開いたファイルのプロットの設定を、片方のプロットを mark に、もう片方を curve にする事で、データは曲線と点の両方でプロットされるようになります。<BR>
<BLOCKQUOTE>
<TABLE BORDER=0>
<TR><TD><IMG SRC="./tutorial/fdialog2.jpg" WIDTH="150" HEIGHT="125" ALT=""></TD><TD><IMG SRC="./tutorial/fdialog.jpg" WIDTH="148" HEIGHT="123" ALT=""></TD></TR>
</TABLE>
</BLOCKQUOTE>
<BR>

<LI><B>データ点の評価・マスク・移動</B>
<BR>
<BR>
プロットしたデータの値はグラフの座標値から読み取る時に、Viewer Window でマウス右ボタンを押してポップアップメニューを出し、"Show cross" を選ぶと、マウスカーソルに縦横のクロスゲージが現れますので、座標値を読み取るのに便利です。
また、もっと直接的に数値を知りたいときには、下図のコントロールボタンを押して「評価モード」にしてから Viewer Window 上でデータをクリックします。<BR>
<BLOCKQUOTE>
<IMG SRC="./tutorial/eval.jpg" WIDTH="460" HEIGHT="50" ALT="">
</BLOCKQUOTE>
するとマウスポインターに近いデータの一覧がリストアップされます。
<BLOCKQUOTE>
<IMG SRC="./tutorial/evaldlg.jpg" WIDTH="350" HEIGHT="183" ALT="">
</BLOCKQUOTE>
ここでリストアップされた項目の「ID」はデータファイルの番号、
「行」はそのファイル中の行数、「Ｘ、Ｙ」が座標値を示してします。
リストボックスの中の項目を選択し「Mask」ボタンを押す事で、データの一部だけを描かなくすることができます。また、「Move」ボタンを押すと、データを移動させる事もできます。
これらマスク、移動の解除はデータダイアログボックスの「マスク」「移動」で行います。

</OL>

<BR>
<HR>
<BR>

<A NAME="LEGEND">&nbsp;</A>
<A HREF="#TOP"><B>グラフを飾りづける</B></A>
<OL>
<LI><B>Legend を入れる</B>
<BR>
<BR>
図にテキスト、矢印などを入れるには、下図のコントロールボタンを押して Legend の種類を選び、マウスで位置を決めます。<BR>
<BLOCKQUOTE>
<IMG SRC="./tutorial/legend.jpg" WIDTH="460" HEIGHT="60" ALT="">
</BLOCKQUOTE>
<BLOCKQUOTE>
<TABLE BORDER=1>
<TR><TD><IMG SRC="./img/bline.gif" WIDTH="20" HEIGHT="20" ALT=""></TD><TD>直線・矢印を作成します。</TD></TR>
<TR><TD><IMG SRC="./img/bcurve.gif" WIDTH="20" HEIGHT="20" ALT=""></TD><TD>曲線を作成します。</TD></TR>
<TR><TD><IMG SRC="./img/bpolygon.gif" WIDTH="20" HEIGHT="20" ALT=""></TD><TD>閉多角形を作成します。</TD></TR>
<TR><TD><IMG SRC="./img/brect.gif" WIDTH="20" HEIGHT="20" ALT=""></TD><TD>矩形を作成します。</TD></TR>
<TR><TD><IMG SRC="./img/barc.gif" WIDTH="20" HEIGHT="20" ALT=""></TD><TD>円・楕円を作成します。</TD></TR>
<TR><TD><IMG SRC="./img/bmark.gif" WIDTH="20" HEIGHT="20" ALT=""></TD><TD>データプロット形式 "mark"に対応するマークを作成します。</TD></TR>
<TR><TD><IMG SRC="./img/btext.gif" WIDTH="20" HEIGHT="20" ALT=""></TD><TD>テキストを作成します。</TD></TR>
<TR><TD><IMG SRC="./img/bgauss.gif" WIDTH="20" HEIGHT="20" ALT=""></TD><TD>ガウス関数, ローレンツ関数, 放物線, 正弦曲線を作成します。<BR>作成した曲線はただちにレジェンド-曲線に展開されるので, 一度作成すると関数としての変更はできません。</TD></TR>
</TABLE>
</BLOCKQUOTE>
<BR>
文字列を Viewer Window にドラッグ&amp;ドロップすることでもテキストを作成できます。
<BR>

<LI><B>Viewer Window 上での移動、設定変更</B>
<BR>
<BR>
Viewer でマウスによって Legend、Axis などの設定の変更、移動、拡大縮小などを行う事もできます。
Ngraph には、その為のマウスポインターのモードが４種類あるので注意が必要です(下図)。
<BLOCKQUOTE>
<IMG SRC="./tutorial/pointer.jpg" WIDTH="460" HEIGHT="70" ALT="">
</BLOCKQUOTE>
ここで、"legend+axis" のポインターモードでは、レジェンドと軸を選択する事ができます。
"legend" のポインターモードではレジェンドのみが選択対象になります。
軸とレジェンドが込み合っていて軸を選択したく無いような場合に使ってください。
"axis" のポインターモードでは逆に軸のみが選択対象になります。
"data" のポインターモードではプロットしたデータが選択対象になり、プロットした点に対応するデータファイルの設定を行う事ができます。
<BR>
選択したいグラフィックスオブジェクトに合ったコントロールボタンを押してモードを決め、マウスで目的のグラフィックスをクリックすると、フォーカスされている事を示す点線枠が表示されます(下図)。<BR>
<BLOCKQUOTE>
<IMG SRC="./tutorial/focus.jpg" WIDTH="127" HEIGHT="68" ALT="">
</BLOCKQUOTE>
マウスのドラッグで移動、拡大・縮小ができます。
移動の際に CTL キーを押しながらドラッグすると、水平垂直方向にしか動きませんので、位置合わせをするのに便利です。
また、移動の際はグリッドが効いています。このグリッドを解除するには SHIFT キーを押しながらドラッグしてください。
ダブルクリックでダイアログボックスが開き各種設定の変更が行えます。
<BR>
<BR>

<LI><B>レジェンドの複製</B>
<BR>
<BR>
同じ様なレジェンドを沢山作成しなければならない時の為に、１つ作成してそれの複製を生成する機能があります。
それには前節で説明した方法で、複製を作成したいレジェンドがフォーカス(選択)された状態(点線枠で囲まれた状態)にします。
もし、複数のレジェンドの複製を作りたいのであれば、それら複数のレジェンドをマウスで囲むようにしてフォーカスされた状態にしてください。
ここで INS キーを押すと(あるいはポップアップメニューを出して"Duplicate"メニューを選択する)、フォーカスされているレジェンドの複製が生成されます。
複製は同じ位置に生成されますので、重なって１つしか見えません。
ですが、複製後は複製されたレジェンドのみがフォーカスされていますので、そのままドラッグすれば複製されたものだけが移動します。
<BR>
<BR>

<LI><B>legend.nsc を使う</B>
<BR>
<BR>
Ngraph にはアドインと呼ばれる複プログラムを使う機能が用意されています。その一つにデータの凡例を自動生成する LGEND が用意されています。
[アドイン]-[実行] ([Addin]-[Execute]) メニューの中から LEGEND を選び実行すると、現在開かれているデータファイルの凡例が自動生成されます。
下図は LEGEND アドインによる凡例の作成例です。<BR>
<BLOCKQUOTE>
<IMG SRC="./tutorial/alegend.jpg" WIDTH="169" HEIGHT="38" ALT="">
</BLOCKQUOTE>
<BR>

<LI><B>込み合っているレジェンドの選択方法</B>
<BR>
<BR>
"Legend Window" はデフォルトでは開いていませんが、下図のボタンを押すと開かれます。
<BLOCKQUOTE>
<IMG SRC="./tutorial/lwindow.jpg" WIDTH="490" HEIGHT="50" ALT="">
</BLOCKQUOTE>
"Legend Window" には legend の一覧が表示されています。
"File Window" や "Axis Window" と同様に一覧をダブルクリックするとダイアログボックスが開き、各種設定を行う事ができます。
また、一覧の中から適当な legend を選びスペースを押す(あるいはポップアップメニューを出して"Focus"メニューを選ぶ)と、Viewer Window で対応するグラフィックスオブジェクトがフォーカスされます。
作成したlegendが重なりあってしまい、目的の legend だけをマウスで選択するのが困難な時にこの機能を使うと便利です。

</OL>

<BR>
<HR>
<BR>

<A NAME="OUTPUT">&nbsp;</A>
<A HREF="#TOP"><B>グラフの印刷・保存・読み込み、ファイルへの出力</B></A>
<OL>
<LI><B>グラフの印刷</B>
<BR>
<BR>
印刷は[グラフ]-[印刷]メニューで行います。
<BR>
<BR>

<LI><B>グラフの保存</B>
<BR>
<BR>
グラフの保存は[グラフ]-[保存]メニューで行います。
このメニューを選択すると保存するファイル名を聞いてきた後、各種セーブオプション指定の為のダイアログボックスが開きます。
ここで OK を押せば、Ngraph の保存形式で NGP の拡張子を持つファイルが作成されます。
一方、Ngraphは予め用意してあるデータファイルを読み込んでグラフにしています。
従って、グラフを完全に保存するにはグラフの状態を保存した NGP ファイルだけでなく、データファイルも保存しておく必要がある事になります。
ところが、このように NGP ファイルとデータファイルを別々に保存しておくと、フォルダ構成の異なるコンピュータにコピーした時に正常にデータファイルが読み込めなくなってしまいます。
これを回避する為に幾つかのセーブオプションが用意されています。
<BR>
<BR>
<DL>
<DT>パス情報
<DD>
セーブする時にデータファイルのパス情報をどうするかを指定します。
unchange では何の変更もしません。
full にするとデータパスをフルパスでセーブします。
relative はカレントフォルダからの相対パスでセーブします。
base はパス名をつけずファイル名だけでセーブします。
</DD>
<DT>データファイルを含める
<DD>
このオプションをチェックすると、データファイルの内容も NGP ファイルに埋め込まれます。
したがって、グラフの保存にデータファイルはもはや不要となります。
埋め込まれたデータファイルはNGPファイルの読み込み時に展開されます。
</DD>
<DT>合成タファイルを含める
<DD>
上記同様に合成ファイル(GRAファイル)をNGPファイルに埋め込みます。
</DD>
</DL>
<BR>

<LI><B>グラフの読み込み</B>
<BR>
<BR>
セーブしてあるNGPファイル(*.ngp)を読み込むには[グラフ]-[開く]メニューで行います。
PRM File(*.prm) を指定して、DOS版Ngraphのグラフを読み込む事もできます。
このメニューを選択すると読み込むファイル名を聞いてきた後、各種読み込みオプション指定の為のダイアログボックスが開きます。
各オプションの意味は以下の通りです。
<DL>
<DT>データファイル展開
<DD>
データファイルが埋め込まれている NGP ファイルを読みこむとき、埋め込まれているデータファイルを展開するかどうかを指定します。
展開するフォルダは「展開ファルダ」で指定できます。デフォルトではカレントフォルダ(.\)になっています。
</DD>
<DT>パス情報無視
<DD>
このオプションをチェックすると、データファイルのパス情報は無視され、データファイルはカレントフォルダにあるものとみなされます。
フォルダ構成が変わってしまい、かつデータファイルがカレントフォルダに有る場合にはこのオプションをチェックしてください。
</DD>
</DL>
<BR>

<LI><B>外部ドライバによるファイルへの出力</B>
<BR>
<BR>
Ngraph用の外部ドライバを用いて、EPSFなど各種形式でファイルへ出力することができます。
外部ドライバは別に配布されている事がありますので、必要な外部ドライバは別途入手してください。
入手したドライバをNgraphから使えるようにする為に[設定]-[外部ドライバ]で登録してください。
登録したら登録内容を保存する為に[設定]-[初期状態としてセーブ]メニューで外部ドライバをチェックして OK を押してください。
<BR>
外部ドライバの登録が終わったら[出力]-[外部ドライバ]で適当なドライバを選び、「ファイル」に出力ファイルを指定して OK を押せばファイルに出力する事ができます。
<BR>
<BR>

<LI><B>GRAファイルへの出力</B>
<BR>
<BR>
GRAファイルとは、直線、円などのグラフィックス命令を記述したNgraph独自のファイル形式です。
グラフの合成に使う事ができます。GRAファイルの作成は[出力]-[GRAファイル]で行います。
そのようにして出力したGRAファイルを[合成]-[開く]メニューで指定する事で取り込む事ができます。
<BR>

</OL>

<BR>
<HR>
<BR>

<A NAME="FIT">&nbsp;</A>
<A HREF="#TOP"><B>フィッティング</B></A>
<OL>
<LI><B>通常のフィット</B>
<BR>
<BR>
データのフィッティングをするには下図の様にデータダイアログボックスでプロット形式を fit にします。
<BLOCKQUOTE>
<TABLE BORDER=0>
<TR><TD><IMG SRC="./tutorial/filedlg.jpg" WIDTH="300" HEIGHT="214" ALT=""><TD><IMG SRC="./tutorial/fdialog3.jpg" WIDTH="150" HEIGHT="120" ALT=""></TD></TR>
</TABLE>
</BLOCKQUOTE>
その後、「フィット」ボタンを押すと下図のフィットダイアログボックスが開きますので、そこでフィッティングの方法を指定します。
<BLOCKQUOTE>
<IMG SRC="./tutorial/fitdlg.jpg" WIDTH="300" HEIGHT="285" ALT="">
</BLOCKQUOTE>
フィットダイアログボックスの「種類」には "poly", "pow", "exp", "log" から選択します。
"user" を選ぶとユーザ指定の関数でフィットできますが、それは次節で説明します。
また "poly" (多項式フィット)の場合には「多項式次元」も指定してください。
その後、描画するとフィッティングが行われます。
フィット結果は線としてグラフに表示されますが、フィッティング結果を数値で知りたい時には下図のボタンを押して Information Window を開いてください。
あるいはフィットダイアログボックスの「結果表示」ボタンでもフィット結果が数値で表示されます。<BR>
<BLOCKQUOTE>
<IMG SRC="./tutorial/infowin.jpg" WIDTH="490" HEIGHT="50" ALT="">
</BLOCKQUOTE>
<BR>

<LI><B>任意関数によるフィット</B>
<BR>
<BR>
任意関数でフィットする場合には、フィットダイアログボックスの「種類」で "user" を選びます。
フィット関数を「フィット式」に指定します。
例として
<BLOCKQUOTE>
Y=a*(X+b)^2
</BLOCKQUOTE>
のフィットの場合を説明します。
フィッティングパラメターは a と b です。
フィッティングパラメターは「フィット式」の中では %00 から %09 で指定します。
つまりフィッテングパラメターは最大 10 個までに制限されています。
上の例では「フィット式」に
<BLOCKQUOTE>
%00*(X+%01)^2
</BLOCKQUOTE>
と入力してください．
任意関数のフィットでは一気にパラメタ−の値を決めるのではなく、パラメタ−の値を変えながら誤差が最小になる点を探して行きます。
探し方はパラメタ−の初期値を決め、その時のパラメタ−空間での誤差の勾配から新たなパラメタ−の値を決めると言う動作をパラメタ−の値が変わらなくなるまで(収束するまで)繰り返します。
「%00:〜%09:」「収束(%)」「微分式指定」「dF/d(%00):〜dF/d(%09):」でこの繰り返し動作を制御します。
パラメタ−空間での誤差の勾配を求めるにはフィット関数を各パラメタ−で偏微分した式が必要です。
「微分式指定」をチェックし、これら微分式を「dF/d(%00):〜dF/d(%09):」に入力してください。
上の例の場合 %00*(X+%01)^2 を %00, %01 で偏微分した式を入力します。
具体的には
<BLOCKQUOTE>
dF/d(%00): (X+%01)^2<BR>
dF/d(%01): %00*2*(X+%01)
</BLOCKQUOTE>
としてください。
「微分式指定」をチェックしなければ、微分式の近似値を数値的に求めますが、明示的に微分式を指定した方が収束は速くなります。
また、フィットパラメタ−の初期値を「%00:〜%09:」で指定してください。
パラメタ−の値が変わらなくなった時を収束したと判断していますが、全く変化しなくなる事はありません。
変化しなくなったと見なす基準を「収束(%):」で指定します。
デフォルトでは  1% ですのでフィット結果の有効桁数は２桁です。
<BR>
これらのオプションを指定したら、ダイアログボックスを閉じて描画すればフィットが行われます。
前節で説明した Information Window を開いてあれば、収束までの繰り返し処理の途中経過が表示されます。
また、時として
<BLOCKQUOTE>
singular matrix あるいは too small number of data
</BLOCKQUOTE>
のエラーが出たり、収束せずにフィット処理がいつまでも続いてしまう事があります(ESC キーを押すか、<IMG SRC="./img/bstop.gif" WIDTH="20" HEIGHT="20" ALT="">コントロールボタンを押して中断してください)。
このような場合にはフィットパラメタ−の初期値を変えて再度挑戦してみてください。
フィット関数によっては初期値をかなり慎重に選ばないと収束してくれません。
</OL>

<BR>
<HR>
<BR>

<A NAME="MATH">&nbsp;</A>
<A HREF="#TOP"><B>数式変換機能を使う</B></A>
<OL>
<LI><B>データを数式で変換してプロットする</B>
<BR>
<BR>
Ngraph ではデ−タファイルのデ−タをそのままグラフにするだけではなく、デ−タを指定した数式で変換してからグラフにする機能を持っています。
変換する為の式はデータダイアログボックスで「変換数式」ボタンを押して、「変換数式:」に入力します。
変換数式は各データファイルで独立しています。
下図のボタンを押して、複数のデータファイルの変換数式を一括して入力する事もできます。
<BLOCKQUOTE>
<IMG SRC="./tutorial/math.jpg">
</BLOCKQUOTE>

例えば、縦軸デ−タを二乗したものをグラフにしたい時には「(Y)カラム数式変換」に
<BLOCKQUOTE>
Y^2 (あるいは同じ事ですが SQR(Y))
</BLOCKQUOTE>
と入力してください。もしデータダイアログボックスの「(Y)カラム」が 2 となっている場合には
<BLOCKQUOTE>
%02^2 (あるいは同じ事ですが SQR(%02))
</BLOCKQUOTE>
でも同じ結果を得ることができます。%02 の意味は "デ−タファイルの2カラム目のデ−タ"です。
このように %01〜%99 で特定のカラムを取り出す事ができます。
一方、
Xはデータダイアログボックスの「(X)カラム」に指定したカラムのデータであり、Yはデータダイアログボックスの「(Y)カラム」に指定したカラムのデータです。
ですから、「(Y)カラム」を 3 にすると、今度は "Y" と "%03" が同じ値を示すようになります。
<BR>
縦軸デ−タをカラム 1 とカラム2 の和をプロットしたい時には変換数式に
<BLOCKQUOTE>
%01+%02
</BLOCKQUOTE>
と入力してください。このようにカラム間の演算ができます。
また、0番目(Data Window のリストの先頭の数字)のデータのカラム 1 と、1 番目のデータのカラム2 の和をプロットしたい時には変換数式に
<BLOCKQUOTE>
%F0001+%F0102
</BLOCKQUOTE>
と入力してください。このようにファイル間の演算もできます。
<BR>
数式変換では四則演算、括弧のほか多くの関数が使用できます。
<BR>
<BR>

</OL>

<BR>
<HR>
<BR>

<A NAME="MULTI">&nbsp;</A>
<A HREF="#TOP"><B>複数のグラフ</B></A>
<OL>
<LI><B>複数のグラフの作り方</B>
<BR>
<BR>
<UL>
<LI>グラフを新たに作成する
<BR>
<BR>
一枚の紙に複数のグラフを作成したい場合には、 [軸]-[追加作成]メニューの中から作成したいグラフの種類を指定します。
あるいは下図のコントロールボタン
<BLOCKQUOTE>
<IMG SRC="./tutorial/addgraph.jpg" WIDTH="460" HEIGHT="50" ALT="">
</BLOCKQUOTE>
を押して、グラフ(軸)の作成モードにして Viewer Window 上でマウスを使って位置を指定し作成する事もできます。
<BR>
<BR>
<LI>すでに作成してあるグラフを複製する
<BR>
<BR>
既に一つのグラフが作成してあり、それと同じ様なグラフを新たに追加するのには、その既に作成してあるグラフを複製してしまうのが、より簡単で現実的です。
それには、下図ボタンを押してマウスをポインター(選択)モードにします。このモードでは軸とレジェンドが選択対象になります(legendも一緒に複製する事を考えています)。
<BLOCKQUOTE>
<IMG SRC="./tutorial/lapoint.jpg" WIDTH="460" HEIGHT="50" ALT="">
</BLOCKQUOTE>
次いで、Viewer Window 上で複製ーしたいグラフ全体を囲むようにマウスで範囲を指定します。
すると、マウスの範囲に入っているグラフとレジェンドが全て選択され、点線枠で囲まれます。
この状態で INS キーを押す(あるいはポップアップメニューを出して"Duplicate"メニューを選択する)と、選択されているグラフとレジェンドが複製されます。
この時、フォーカス(選択)されているのは新たに複製されたグラフとレジェンドだけで、複製元は選択されていません。
この状態でマウスでドラッグして位置をずらしてください。
通常、複数のグラフを作成する場合には縦、あるいは横に位置を揃えたい場合が多いですが、マウスで位置をずらす時に CTRL キーを押しながらドラッグすれば水平・垂直方向にしか移動しませんので、簡単に揃える事ができます。
</UL>
<BR>

<LI><B>append.nscを使う</B>
<BR>
<BR>
NGP ファイルとして保存されている別のグラフを、現在のグラフと同じページに取り込むのはもっと簡単です。
Ngraph にはアドインと呼ばれる複プログラムを使う機能が用意されています。その一つにNGPファイルに保存されているグラフを現在のグラフに追加する APPEND が用意されています。
[アドイン]-[実行] ([Addin]-[Execute]) メニューの中から APPEND を選び実行しNGPファイル名を指定するだけで、現在のグラフに追加する事ができます。
<BR>
<BR>

<LI><B>軸の名称</B>
<BR>
<BR>
フレームグラフや方眼グラフは4つの軸(X軸、Y軸、U軸、R軸)から構成されます。
また交差グラフは2つの軸(X軸、Y軸)から構成されます。
これらの軸には複数のグラフを作成しても一意になるように名前が自動的に付けられます。
軸の名前は以下の形式をしています。
<BLOCKQUOTE>
<TABLE BORDER=1>
<TR ALIGN="CENTER"><TD>グラフの種類</TD><TD>軸</TD><TD>グラフの番号</TD></TR>
<TR><TD>f: フレームグラフ<BR>s: 方眼グラフ<BR>c: 交差グラフ</TD>
<TD>X<BR>Y<BR>U<BR>R</TD>
<TD>グラフの種類毎に 1 から振られます</TD></TR>
</TABLE>
</BLOCKQUOTE>
例えば、最初に作成したフレームグラフの軸の名前は fX1, fY1, fU1, fR1 となり、二番目作成したフレームグラフの軸の名前は fX2, fY2, fU2, fR2 です。
<BR>
Axis Window の "name" の部分には、この名前が一覧表示されます。
またこれとは別に他のグラフィックオブジェクトと同様に0からの通し番号が付いています。
Axis Window の "#" の部分に表示されている数字がこの番号です。
<BR>
<BR>

<LI><B>プロットする軸の指定</B>
<BR>
<BR>
データをプロットする軸はデータダイアログボックスの「軸」に軸の通し番号を指定します。
ただし、分かりやすい様にコンボボックスのリストには前節で説明した軸の名前が一覧表示されるようになっています。
<BR>
<BR>

<LI><B>軸の連携</B>
<BR>
<BR>
Ngraph の座標軸は軸の間で連携する為の機能を2つもたせてあります。
<BR>
<BR>
<DL>
<DT>Reference パラメタ
<DD>
座標軸の最大・最小値が設定されていない時, Reference パラメタに他の座標軸番号が指定されていれば, その軸から最大・最小値を自動的に読み取ります。
主にフレームグラフの U軸, R軸の為に使われます。<BR>
</DD>
<DT>Adjust パラメタ
<DD>
他の軸番号が指定されている場合には, その軸とAdjust position で交差するように自分自身を平行移動させます。主に交差グラフの軸に対して使われます。<BR>
</DD>
</DL>
<BR>
これらは「参照軸」、「位置ボタン」-「交差軸」でそれぞれ指定できます。
<BR>
<BR>
軸には前で説明した様に、0からの通し番号が付けられています。
さらに、(他のグラフィックオブジェクトと同様に)実行時に一意に決まる番号も付いています(^で始まる数字として指定します)。
Axis Window の最後の "^#" の部分に表示されている数字がこの番号です。
上記「参照軸」や「位置ボタン」-「交差軸」のコンボボックスリストから軸の名前を選んだ場合に実際に入力されるのは、この「実行時に一意に決まる番号」になります。
「通し番号」で指定してあると、軸が削除されたような場合に番号が変わってしまい、結果として参照関係が壊れてしまい不便なので、このように「実行時に一意に決まる番号」で指定するようになっているのです。

<BR>
複数のグラフで X 軸を共通にしたい場合、下図の様に Reference パラメタを設定すると fX2 軸のスケールを変えるだけで fU2, fX1, FfU1 の軸のスケールを揃える事ができます。
<BLOCKQUOTE>
<IMG SRC="./tutorial/axisref.jpg" WIDTH="250" HEIGHT="244" ALT="">
</BLOCKQUOTE>
<BR>
</OL>

<BR>
<HR>
<BR>
</BODY></HTML>
