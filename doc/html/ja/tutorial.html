
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Tutorial</title>
</head>
<body>
<a name="TOP">&nbsp;</a>
<h1><a href="./ngraph.html">チュートリアル</a></h1>
<ul>
 <li><a href="#VIEW">外観</a>
      <ol>
       <li>起動画面
      </ol>
 <li><a href="#GRAPH">グラフ作成の概略</a>
      <ol>
       <li>データファイルを用意する
       <li>グラフの種類を決める
       <li>データファイルを開く
       <li>描画する
      </ol>
 <li><a href="#SCALE">軸のスケール</a>
      <ol>
       <li>スケールを変える
       <li>スケールをクリアする
       <li>一部を拡大する
       <li>スケールの値を元に戻す
      </ol>
 <li><a href="#PLOT">プロット方法</a>
      <ol>
       <li>プロット方法を変える
       <li>曲線＋点でプロットする
       <li>データ点の評価・マスク・移動
      </ol>
 <li><a href="#LEGEND">グラフを飾りづける</a>
      <ol>
       <li>Legend を入れる
       <li>グラフ上での移動、設定変更
       <li>レジェンドの複製
       <li>legend.nsc を使う
       <li>込み合っているレジェンドの選択方法
      </ol>
 <li><a href="#OUTPUT">グラフの印刷・保存・読込、ファイルへの出力</a>
      <ol>
       <li>グラフの印刷
       <li>グラフの保存
       <li>グラフの読込
       <li>外部ドライバによるファイルへの出力
       <li>GRAファイルへの出力
      </ol>
 <li><a href="#FIT">フィッティング</a>
      <ol>
       <li>通常のフィット
       <li>任意関数によるフィット
      </ol>
 <li><a href="#MATH">数式変換機能を使う</a>
      <ol>
       <li>データを数式で変換してプロットする
      </ol>
 <li><a href="#MULTI">複数のグラフ</a>
      <ol>
       <li>複数のグラフの作り方
       <li>append.nsc を使う
       <li>軸の名称
       <li>プロットする軸の指定
       <li>軸の連携
      </ol>
</ul>

<hr size="5">

<a name="VIEW">&nbsp;</a>
<h2><a href="#TOP">外観</a></h2>
<ol>
 <li><h3>起動画面</h3>
      <p>
      Ngraph を起動すると下図のウィンドウが開かれます。
      </p>
      <p>
      <img src="./tutorial/window.png" WIDTH="526" HEIGHT="351" ALT="">
      </p>
      <p>
      ここでは、簡単にウィンドウの説明をします。
      </p>
      <ul>
       <dl>
	<dt> コントロールボタン(上部)
	<dd> 通常のウィンドウアプリケーションと同様に、ファイルのオープン
	     など頻繁に使うメニューコマンドがボタンに割り当てられています。
	<dt> コントロールボタン(左サイド)
	<dd> マウスによる操作モードを指定するトグルボタン列です。グラフィッ
	     クスオブジェクトの選択モード、レジェンド種類別の作成モード、
	     プロットされたデータの評価モード、画面の拡大縮小モードなどを
	     切り替えます。
	<dt> サイドバー
	<dd> <p>グラフの右に表示され、上部にデータや軸などを一覧表示する
	     タブ、下部にマウスカーソル位置やフィッティングの情報を表示す
	     る場所があります。タブの順番・位置はドラッグ＆ドロップで自由
	     に変更できます。</p>
	     <dl>
	      <dt> Data タブ
	      <dd> <p> 開かれたデータファイルが一覧表示されます。また、プ
		   ロットの為の各種パラメターも一覧表示されます。このリス
		   トをダブルクリックするとデータダイアログボックスが開き、
		   各種設定を変更する事ができます。</p>
	      <dt> Axis タブ
	      <dd> <p>座標軸の名前と、スケールの数値などの各種パラメター
		   が一覧表示されます。このリストをダブルクリックすると軸
		   ダイアログボックスが開き、各種設定を変更する事ができま
		   す。</p>
	      <dt> Merge タブ
	      <dd> <p>合成ファイルと各種パラメターが一覧表示されます。こ
		   のリストをダブルクリックすると合成ダイアログボックスが
		   開き、各種設定を変更する事ができます。</p>
	      <dt> Path, Rectangle, Arc, Mark, Text タブ
	      <dd> <p>各レジェンドを一覧表示します。このリストをダブルク
		   リックすると各レジェンドのダイアログボックスが開き、各
		   種設定を変更する事ができます。</p>
	      <dt> Coordinate 表示
	      <dd> <p>グラフのマウスカーソルの位置が表示されます。
		   また、座標軸が有る場合にはマウスカーソルの位置に対応す
		   る軸の座標も表示されます。</p>
	      <dt> Information 表示
	      <dd> <p>フィットの結果等が表示されます。</p>
	     </dl>
       </dl>
      </ul>
      <p>
      [表示]-[シングルウィンドウモード] ([View]-[single window mode]) の
      チェックを外すことで、左側のタブを独立したウィンドウに分離すること
      もできます。この場合、データ一覧を表示する "Data Window"、軸の一覧
      を表示する "Axis Window"、グラフ上のマウスカーソル位置が表示される
      "Coordinate Window"、レジェンドを一覧表示する "Legend Window"、合成
      ファイルを一覧表示する "Merge Window"、フィットの結果等を表示する
      "Information Window" の各ウィンドウを開く事ができます。また、各ウィ
      ンドウ上でマウスの右ボタンをクリックすると、それぞれのウィンドウで
      異なるポップアップメニューを出す事ができ、各種操作が行えるようになっ
      ています。
      </p>

</ol>

<hr>

<a name="GRAPH">&nbsp;</a>
<h2><a href="#TOP">グラフ作成の概略</a></h2>
<ol>
 <li><h3>データファイルを用意する</h3>
      <p>
      Ngraphはデータファイルからデータを読み込みグラフを作成します。
      従って、まずデータファイルを用意しなければなりません。
      エディター、計算プログラム、あるいは測定装置コントロールソフトなどからデータファイルを作成します。
      </p>

 <li><h3>グラフの種類を決める</h3>
      <p>
      グラフにするデータファイルを用意したらNgraphを起動します。次に作成
      したいグラフの種類を決めます。
      Ngraphでは以下の3つに分類されています。
      </p>
      <p>
      <table border=1>
       <tr>
	<td align=CENTER><img src="./tutorial/graphf.jpg" WIDTH="150" HEIGHT="146" ALT=""></td>
	<td align=CENTER><img src="./tutorial/graphs.jpg" WIDTH="150" HEIGHT="146" ALT=""></td>
	<td align=CENTER><img src="./tutorial/graphc.jpg" WIDTH="150" HEIGHT="146" ALT=""></td>
       </tr>
       <tr>
	<td>フレームグラフ(Frame graph)<br>4つの軸で囲まれたグラフ</td>
	<td>方眼グラフ(Section graph)<br>4つの軸で囲まれ、方眼線の入ったグラフ</td>
	<td>交差グラフ(Cross graph)<br>X-Y２軸のグラフ</td>
       </tr>
      </table>
      </p>
      <p>
      初期状態ではフレームグラフが一つ作成されています。
      フレームグラフの４つの軸のスケールはまだ設定されていませんので、軸の基線を示す枠だけが表示されています。
      これで良ければ次に進みます。
      他の種類のグラフを作成するには、[グラフ]-[新規作成]([Graph]-[New graph])メニューで作成するグラフの種類を指定します。
      </p>

 <li><h3>データファイルを開く</h3>
      <p>
      次に、準備してあるデータファイルを開きます。
      データファイルを開くには様々な方法が有りますが、
      取り敢えず[データ]-[追加]メニューを選び、
      ファイル選択のダイアログボックスでデータファイルを開いてください。
      </p>
      <p>
      データファイルを開く方法は他にも用意されています。
      <ol>
       <li>下図のコントロールボタンを押す。
	    <pre>
	    <img src="../img/fopen.png" ALT="file open control button">
	    </pre>
       <li>Data タブ上でマウス右ボタンを押してポップアップメニューを出し、"追加(A)" メニューを選ぶ。
       <li>ファイルマネージャー等からデータファイルを選び、グラフまたは
	    Data タブ上にドラッグ&amp;ドロップする。
      </ol>
      </p>
      <p>
      いずれの方法でも、
      データファイルを指定すると次いでプロット方法などを指定するデータダイアログボックスが開きますが、
      取り敢えず OK で閉じてください。
      </p>

 <li><h3>描画する</h3>
      <p>
      Ngraphではファイルを開いても自動的には描画しないようになっています。
      グラフを描画するには下図のボタンを押してください。
      </p>
      <p>
      <img src="../img/draw.png" ALT="">
      </p>
      <p>
      描画する方法は他にも用意されています。
      <ol>
       <li>[表示]-[描画]([View]-[Draw])メニューを選択する。
       <li>グラフ上でクリックしてスペースキーを押す。
      </ol>
      </p>
      <p>
      この様にして描画すると軸のスケールは少し余白をとるように自動的に設定され、グラフが描画されます。
      </p>
</ol>
<hr>

<a name="SCALE">&nbsp;</a>
<h2><a href="#TOP">軸のスケール</a></h2>
<ol>
 <li><h3>スケールを変える</h3>
      <p>
      特にスケール (座標軸の上限・下限)を設定せずに描画した場合にはオートスケールで値が決められます。
      また Axis タブには軸が一覧表示されています。
      フレームグラフの場合には軸は４つあり、それぞれ "fX1", "fY1", "fU1", "fR1" と名前が付いています。
      これらの軸のスケールを変更するには、下図の様に Axis タブの一覧から変更したい軸を選んでダブルクリックしてください。
      <p>
      <img src="./tutorial/awindow.png" WIDTH="578" HEIGHT="222" ALT="">
      </p>
      <p>
      軸ダイアログボックスを開く方法は他にも用意されています。
      <ol>
       <li>[軸]-[設定] ([Axis]-[Update]) メニューでプ変更したい軸を選ぶ。
       <li>下図ボタンのいずれか一方
	    (どちらでも良いです)を押してグラフィックスオブジェクト選択モード
	    (あるいは軸のみの選択モード)にしてグラフ上で軸をダブルクリックし、
	    次いで出てくるダイアログボックスで変更したい軸のボタンを押す。
	    <pre>
	    <img src="../img/axispo.png" ALT="">
	    </pre>
      </ol>
      </p>
      <p>
      この様にすると下図の軸ダイアログボックスが開かれます。
      ここで、「最小値」「最大値」「増分」に軸のスケールの最小，最大，増分を指定してください。
      目盛数字は増分に対して付けられます。
      「分割数」は「増分」をさらに何等分して目盛線を引くかを決めます。
      この値が0の時は自動的に分割数が決められます。
      「スケール法」では通常の線形軸（linear）、ログ(log）、逆数(inverse)、MJD の中から１つを選ぶ事ができます。
      「ファイル」ボタンを押すとスケールを開いたデータファイル中から指定したファイルでオートスケールを行って決める事ができます。
      「クリア」はスケールの設定を未設定状態にします。
      </p>
      <p>
      <img src="./tutorial/adialog.png" WIDTH="305" HEIGHT="262" ALT="">
      </p>
      <p>
      さらに軸に関する細かい設定ができるように「軸基線」「目盛線」「目盛数字」「フォント」「位置」のボタンが用意されています。
      「軸基線」ボタンを押して軸の基線の太さ、色などの設定を行います。
      軸の端に矢印をつけたりすることもできます。
      「目盛線」ボタンを押して軸の"ゲージ"の長さ、太さ、色などの設定を行います。
      また、目盛線をグラフの内側に描くか外側に描くかを決めたり(「位置」)、軸を全部描かずに一部だけにしたり(「範囲最小値」、「範囲最大値」)できます。
      「目盛数字」ボタンを押して、その"ゲージ" に振る目盛数字に関する設定を行います。
      目盛数字を振り始めるスケールの位置を変えたり（「開始点」、0で自動設定)、
      間隔を変えたり(「間隔」、0で自動設定)、
      個数を変えたり(「個数」、-1で自動設定)できます。
      「フォント」ボタンを押して目盛数字のフォントの設定を行います。
      </p>

 <li><h3>スケールをクリアする</h3>
      <p>
      前節で説明したように、軸ダイアログボックスの「クリア」ボタンで、
      軸のスケール設定を未設定状態にできますが、
      複数の軸をクリアしたいような場合には[軸]-[スケールクリア]メニューでクリアしたい軸を複数指定し、一括してクリアする事ができます。
      あるいは下図ボタンを押しても同じように複数の軸をクリアできます。
      </p>
      <p>
      <img src="../img/aclear.png" ALT="">
      </p>

 <li><h3>一部を拡大する</h3>
      <p>
      前節のように軸のスケールは数値を入力して変更しますが、グラフの一部を拡大して描画したい時などはグラフィカルに変更する事もできます。
      それには下図ボタンを押してトリミングモードにしてグラフ上で軸の範囲をマウスで指定します。
      </p>
      <p>
      <img src="../img/trimming.png" ALT="">
      </p>

 <li><h3>スケールの値を元に戻す</h3>
      <p>
      軸のスケールの設定は、各軸10個まで履歴が記憶されています。
      従って前節のように一部を拡大描画した後に、元のスケールの設定に簡単に戻す事ができます。
      それには下図ボタンを押して設定を戻したい軸を指定してください。
      </p>
      <p>
      <img src="../img/scundo.png" ALT="">
      </p>

</ol>

<hr>

<a name="PLOT">&nbsp;</a>
<h2><a href="#TOP">プロット方法</a></h2>
<ol>
 <li><h3>プロット方法を変える</h3>
      <p>
      デフォルトの状態では、黒い点でデータ点がプロットされます。また、Data タブには開いたデータファイルが一覧表示されています。
      プロット方法を変える為に、Data タブの一覧表示をダブルクリックしてデータダイアログボックスを開いてください。
      </p>
      <p>
      <img src="./tutorial/fwindow.png" WIDTH="580" HEIGHT="236" ALT="">
      </p>
      <p>
      データダイアログボックスを開く方法はその他に
      <ol>
       <li>[データ]-[設定] ([Data]-[Update]) メニューでプロットしたいデータファイルを選ぶ
       <li>下図ボタンを押してデータ選択モードにしてグラフ上でデータをクリックする
	    <img src="../img/datapo.png" ALT="">
       <li>Data タブ上でマウス右ボタンを押してポップアップメニューを出し、"プロパティ(P)" メニューを選ぶ
      </ol>
      があります。
      </p>
      <p>
      この様にすると下左図に示すデータダイアログボックスが現れます。
      </p>
      <p>
      <table border=0>
       <tr>
	<td><img src="./tutorial/filedlg.png" WIDTH="388" HEIGHT="312" ALT=""></td>
	<td><img src="./tutorial/fdialog.png" ALT="244" HEIGHT="244" ALT=""></td>
       </tr>
      </table>
      </p>
      <p>
      例えばプロット方法を変更してデータを曲線で結ぶようにするには上右図にの様にプロットタイプを "曲線" にします。
      その後、データダイアログボックスを OK で閉じ、もう一度描画してくだ
      さい。
      </p>
      <p>
      データダイアログボックスでは、その他にドットの大きさ、幅、色などの設定が行えます。
      またデータファイルの先頭に何のデータであるかの注釈をつけておく事が多いと思いますが、
      その部分を読み飛ばすのには「読込」ボタンを押して「先頭スキップ行」を設定します。
      </p>

 <li><h3>曲線+点でプロットする</h3>
      <p>
      データを曲線と点の両方でプロットするようにするには、
      同じデータファイルを二度開き、片方を曲線で、もう片方を点でプロットするように設定します。
      同じデータ2度開くのも基本的には前節で示した方法で、
      二回開けば良いのですが、すでに開いて有るファイルをもう一度開くには下図に示したように
      Data タブ上でマウス右ボタンを押してポップアップメニューを出し "複製(D)" メニューを選び複製を生成するのがより簡単です。
      Data タブでINSキーを押す事でも同様の操作が行えます。
      下左図は Data タブでポップアップメニューを出した状態です。
      "複製(D)"メニューを選ぶ事で下右図のように Data タブには同じファイルが2つリストされるようになります。
      </p>
      <p>
      <table border=0>
       <tr>
	<td><img src="./tutorial/fdup.png" WIDTH="290" HEIGHT="221" ALT=""></td>
	<td><img src="./tutorial/fwindow2.png" WIDTH="290" HEIGHT="112" ALT=""></td>
       </tr>
      </table>
      </p>
      <p>
      このようにして2度開いたファイルのプロットの設定を、
      片方のプロットを "マーク" に、もう片方を "曲線" にする事で、
      データは曲線と点の両方でプロットされるようになります。
      </p>
      <p>
      <table border=0>
       <tr>
	<td><img src="./tutorial/fdialog2.png" WIDTH="244" HEIGHT="244" ALT=""></td>
	<td><img src="./tutorial/fdialog.png" WIDTH="244" HEIGHT="244" ALT=""></td>
       </tr>
      </table>
      </p>

 <li><h3>データ点の評価・マスク・移動</h3>
      <p>
      プロットしたデータの値はグラフの座標値から読み取る時に、
      グラフ上でマウス右ボタンを押してポップアップメニューを出し、
      "クロスゲージ(G)" を選ぶと、マウスカーソルに縦横のクロスゲージが現れますので、座標値を読み取るのに便利です。
      また、もっと直接的に数値を知りたいときには、
      下図のコントロールボタンを押して「評価モード」にしてからグラフ上でデータをクリックします。
      </p>
      <p>
      <img src="../img/eval.png" ALT="">
      </p>
      するとマウスポインターに近いデータの一覧がリストアップされます。
      <p>
      <img src="./tutorial/evaldlg.png" WIDTH="275" HEIGHT="206" ALT="">
      </p>
      <p>
      ここでリストアップされた項目の「#」はデータファイルの番号、
      「行」はそのファイル中の行数、「Ｘ、Ｙ」が座標値を示してします。
      リストボックスの中の項目を選択し「Mask」ボタンを押す事で、データの一部だけを描かなくすることができます。
      また、「Move」ボタンを押すと、データを移動させる事もできます。
      これらマスク、移動の解除はデータダイアログボックスの「マスク」「移動」で行います。
      </p>
</ol>


<hr>

<a name="LEGEND">&nbsp;</a>
<h2><a href="#TOP">グラフを飾りづける</a></h2>
<ol>
 <li><h3>Legend を入れる</h3>
      <p>
      図にテキスト、矢印などを入れるには、
      下図のコントロールボタンを押してLegend の種類を選び、マウスで位置を決めます。
      Legend の作成が終わるとマウスは選択モードに戻ります。
      複数の Legend を作成したいときは SHIFT キーを押しながらコントロールボタンをクリックしてください。
      また Legend の位置指定時に CTL キーを押しながらマウスを操作すると、角度や縦横の比を制限できます。
      </p>
      <p>
      <img src="../img/legend.png" ALT="">
      </p>
      <p>
      <table border=1>
       <tr><td><img src="../img/bline.png" WIDTH="20" HEIGHT="20" ALT=""></td><td>直線・曲線を作成します。</td></tr>
       <tr><td><img src="../img/brect.png" WIDTH="20" HEIGHT="20" ALT=""></td><td>矩形を作成します。</td></tr>
       <tr><td><img src="../img/barc.png" WIDTH="20" HEIGHT="20" ALT=""></td><td>円・楕円を作成します。</td></tr>
       <tr><td><img src="../img/bmark.png" WIDTH="20" HEIGHT="20" ALT=""></td><td>データプロット形式 "マーク" に対応するマークを作成します。</td></tr>
       <tr><td><img src="../img/btext.png" WIDTH="20" HEIGHT="20" ALT=""></td><td>テキストを作成します。</td></tr>
       <tr><td><img src="../img/bgauss.png" WIDTH="20" HEIGHT="20" ALT=""></td><td>ガウス関数, ローレンツ関数, 放物線, 正弦曲線を作成します。<br>作成した曲線はただちにレジェンド-曲線に展開されるので, 一度作成すると関数としての変更はできません。</td></tr>
      </table>
      </p>
      <p>
      文字列をグラフ上にドラッグ&amp;ドロップすることでもテキストを作成できます。
      </p>

 <li><h3>グラフ上での移動、設定変更</h3>
      <p>
      マウスによって Legend、Axis などの設定の変更、移動、拡大縮小などを行う事もできます。
      Ngraph には、その為のマウスポインターのモードが４種類あるので注意が必要です(下図)。
      </p>
      <p>
      <img src="../img/pointer.png" ALT="">
      </p>
      <p>
      ここで、"legend+axis" のポインターモードでは、レジェンドと軸を選択する事ができます。
      "legend" のポインターモードではレジェンドのみが選択対象になります。
      軸とレジェンドが込み合っていて軸を選択したく無いような場合に使ってください。
      "axis" のポインターモードでは逆に軸のみが選択対象になります。
      "data" のポインターモードではプロットしたデータが選択対象になり、プロットした点に対応するデータファイルの設定を行う事ができます。
      </p>
      <p>
      選択したいグラフィックスオブジェクトに合ったコントロールボタンを押してモードを決め、
      マウスで目的のグラフィックスをクリックするとフォーカスされている事を示す点線枠が表示されます(下図)。
      SHIFT キーを押しながらクリックすると複数のオブジェクトを複数選択できます。
      </p>
      <p>
      <img src="./tutorial/focus.jpg" WIDTH="127" HEIGHT="68" ALT="">
      </p>
      <p>
      マウスのドラッグで移動、拡大・縮小ができます。
      移動の際に CTL キーを押しながらドラッグすると、水平垂直方向にしか動きませんので、位置合わせをするのに便利です。
      また、移動の際はグリッドが効いています。このグリッドを解除するには SHIFT キーを押しながらドラッグしてください。
      ダブルクリックでダイアログボックスが開き各種設定の変更が行えます。
      </p>

 <li><h3>レジェンドの複製</h3>
      <p>
      同じ様なレジェンドを沢山作成しなければならない時の為に、１つ作成してそれの複製を生成する機能があります。
      それには前節で説明した方法で、複製を作成したいレジェンドがフォーカス(選択)された状態(点線枠で囲まれた状態)にします。
      もし、複数のレジェンドの複製を作りたいのであれば、それら複数のレジェンドをマウスで囲むようにしてフォーカスされた状態にしてください。
      ここで INS キーを押すと(あるいはポップアップメニューを出して "複製(D)" メニューを選択する)、
      フォーカスされているレジェンドの複製が生成されます。
      複製は同じ位置に生成されますので、重なって１つしか見えません。
      ですが、複製後は複製されたレジェンドのみがフォーカスされていますので、そのままドラッグすれば複製されたものだけが移動します。
      </p>

 <li><h3>legend.nsc を使う</h3>
      <p>
      Ngraph にはアドインと呼ばれる副プログラムを使う機能が用意されています。
      その一つにデータの凡例を自動生成する LGEND が用意されています。
      [アドイン] ([Addin]) メニューの中から [Legend...] を選び実行すると、現在開かれているデータファイルの凡例が自動生成されます。
      下図は LEGEND アドインによる凡例の作成例です。
      </p>
      <p>
      <img src="./tutorial/alegend.jpg" WIDTH="169" HEIGHT="38" ALT="">
      </p>

 <li><h3>込み合っているレジェンドの選択方法</h3>
      <p>
      "Path タブ"、"Rectangle タブ"、"Arc タブ"、"Mark タブ"、"Text タブ" には
      それぞれのオブジェクトの一覧が表示されています。
      "File タブ" や"Axis タブ" と同様に一覧をダブルクリックするとダイアログボックスが開き、
      各種設定を行う事ができます。
      また、一覧の中から適当な legendを選びスペースを押す
      (あるいはポップアップメニューを出して "フォーカス(F)" メニューを選ぶ)と、
      グラフで対応するグラフィックスオブジェクトがフォーカスされます。
      作成したlegendが重なりあってしまい、目的の legend だけをマウスで選択するのが困難な時にこの機能を使うと便利です。
      </p>
</ol>

<hr>

<a name="OUTPUT">&nbsp;</a>
<h2><a href="#TOP">グラフの印刷・保存・読込、ファイルへの出力</a></h2>
<ol>
 <li><h3>グラフの印刷</h3>
      <p>
      印刷は[グラフ]-[印刷]メニューで行います。
      </p>

 <li><h3>グラフの保存</h3>
      <p>
      グラフの保存は[グラフ]-[保存]メニューで行います。
      このメニューを選択すると保存するファイル名を聞いてきた後、各種セーブオプション指定の為のダイアログボックスが開きます。
      ここで OK を押せば、Ngraph の保存形式で NGP の拡張子を持つファイルが作成されます。
      一方、Ngraphは予め用意してあるデータファイルを読み込んでグラフにしています。
      従って、グラフを完全に保存するにはグラフの状態を保存した NGP ファイルだけでなく、データファイルも保存しておく必要がある事になります。
      ところが、このように NGP ファイルとデータファイルを別々に保存しておくと、
      フォルダ構成の異なるコンピュータにコピーした時に正常にデータファイルが読み込めなくなってしまいます。
      これを回避する為に幾つかのセーブオプションが用意されています。
      </p>
      <dl>
       <dt>パス情報
       <dd>
	    セーブする時にデータファイルのパス情報をどうするかを指定します。
	    unchange では何の変更もしません。
	    full にするとデータパスをフルパスでセーブします。
	    relative はカレントフォルダからの相対パスでセーブします。
	    base はパス名をつけずファイル名だけでセーブします。
	    </dd>
       <dt>データファイルを含める
       <dd>
	    このオプションをチェックすると、データファイルの内容も NGP ファイルに埋め込まれます。
	    したがって、グラフの保存にデータファイルはもはや不要となります。
	    埋め込まれたデータファイルはNGPファイルの読み込み時に展開されます。
	    </dd>
       <dt>合成タファイルを含める
       <dd>
	    上記同様に合成ファイル(GRAファイル)をNGPファイルに埋め込みます。
	    </dd>
      </dl>

 <li><h3>グラフの読込</h3>
      <p>
      セーブしてあるNGPファイル(*.ngp)を読み込むには[グラフ]-[開く]メニューで行います。
      ファイルマネージャー等からNGPファイルを選び、
      グラフ上にドラッグ&amp;ドロップしてもグラフを読み込むことが出来ます。
      PRM File(*.prm) を指定して、DOS版Ngraphのグラフを読み込む事もできます。
      このメニューを選択すると読み込むファイル名を聞いてきた後、
      各種読み込みオプション指定の為のダイアログボックスが開きます。
      各オプションの意味は以下の通りです。
      <dl>
       <dt>データファイル展開
       <dd>
	    データファイルが埋め込まれている NGP ファイルを読みこむとき、埋め込まれているデータファイルを展開するかどうかを指定します。
	    展開するフォルダは「展開ファルダ」で指定できます。デフォルトではカレントフォルダ(.\)になっています。
	    </dd>
       <dt>パス情報
       <dd>
	    データファイルのパス情報の扱いを選択します。
	    「フルパス」はフルパスで指定されていないデータファイルについて、
	    カレントフォルダから推測されるフルパスに変換します。
	    「ファイル名のみ」の場合、パス情報は無視され、
	    データファイルはカレントフォルダにあるものとみなされます。
	    フォルダ構成が変わってしまい、かつデータファイルがカレントフォルダに有る場合にはこのオプションをチェックしてください。
	    </dd>
      </dl>

 <li><h3>画像ファイルへのエクスポート</h3>
      <p>
      [グラフ]-[画像にエクスポート]で出力ファイル形式を指定してファイルに出力する事ができます。
      </p>

 <li><h3>GRAファイルへの出力</h3>
      <p>
      GRAファイルとは、直線、円などのグラフィックス命令を記述したNgraph独自のファイル形式です。
      グラフの合成に使う事ができます。
      GRAファイルの作成は[グラフ]-[画像にエクスポート]-[GRA ファイル]で行います。
      そのようにして出力したGRAファイルを[合成]-[開く]メニューで指定するか、
      ファイルマネージャー等からGRAファイルを選び、
      グラフまたはMerge タブ上にドラッグ&amp;ドロップ事で取り込む事ができます。
      </p>

</ol>

<hr>

<a name="FIT">&nbsp;</a>
<h2><a href="#TOP">フィッティング</a></h2>
<ol>
 <li><h3>通常のフィット</h3>
      <p>
      データのフィッティングをするには下図の様にデータダイアログボックスでプロット形式を fit にします。
      </p>
      <p>
      <table border=0>
       <tr>
	<td><img src="./tutorial/filedlg.png" WIDTH="388" HEIGHT="312" ALT=""></td>
	<td><img src="./tutorial/fdialog3.png" WIDTH="245" HEIGHT="243" ALT=""></td>
       </tr>
       </table>
       </p>
      <p>
      その後、「作成」ボタンを押すと下図のフィットダイアログボックスが開きますので、そこでフィッティングの方法を指定します。
      </p>
      <p>
      <img src="./tutorial/fitdlg.png" WIDTH="430" HEIGHT="327" ALT="">
      </p>
      <p>
      フィットダイアログボックスの「種類」には "多項式", "べき関数", "指数関数", "対数" から選択します。
      "ユーザ定義" を選ぶとユーザ指定の関数でフィットできますが、それは次節で説明します。
      また "多項式" (多項式フィット)の場合には「多項式次元」も指定してください。
      その後、描画するとフィッティングが行われます。
      フィット結果は線としてグラフに表示されます。またサイドバー右下にも情報が表示されます。
      あるいはフィットダイアログボックスの「結果表示」ボタンでもフィット結果が数値で表示されます。
      </p>
      <p>
      フィット結果の表示で&lt;DY^2&gt;はデータが (Xi, Yi)、フィットした関数が Y=f(X) のとき、
      &lt;DY^2&gt;=&lt;ΔY^2&gt;=&lt;[Yi-f(Xi)]^2&gt;=(1/N)Σ[Yi-f(Xi)]^2
      の意味です。また "|r| or |R|" は相関係数の絶対値です。
      </p>
      <p>
      <img src="../img/infowin.png" ALT="">
      </p>

      <li><h3>任意関数によるフィット</h3>
      <p>
      任意関数でフィットする場合には、フィットダイアログボックスの「種類」で "ユーザ定義" を選びます。
      フィット関数を「フィット式」に指定します。
      </p>
      <p>
      例として
      <pre>
      Y=a*(X+b)^2
      </pre>
      のフィットの場合を説明します。
      フィッティングパラメターは a と b です。
      フィッティングパラメターは「フィット式」の中では %00 から %09 で指定します。
      つまりフィッテングパラメターは最大 10 個までに制限されています。
      上の例では「フィット式」に
      <pre>
      %00*(X+%01)^2
      </pre>
      と入力してください．
      任意関数のフィットでは一気にパラメターの値を決めるのではなく、パラメターの値を変えながら誤差が最小になる点を探して行きます。
      探し方はパラメターの初期値を決め、その時のパラメター空間での誤差の勾配から新たなパラメターの値を決めると言う動作を
      パラメターの値が変わらなくなるまで(収束するまで)繰り返します。
      「%00:〜%09:」「収束(%)」「微分式指定」「dF/d(%00):〜dF/d(%09):」でこの繰り返し動作を制御します。
      パラメター空間での誤差の勾配を求めるにはフィット関数を各パラメターで偏微分した式が必要です。
      「微分式指定」をチェックし、これら微分式を「dF/d(%00):〜dF/d(%09):」に入力してください。
      上の例の場合 %00*(X+%01)^2 を %00, %01 で偏微分した式を入力します。
      具体的には
      <pre>
      dF/d(%00): (X+%01)^2
      dF/d(%01): %00*2*(X+%01)
      </pre>
      としてください。
      「微分式指定」をチェックしなければ、微分式の近似値を数値的に求めますが、明示的に微分式を指定した方が収束は速くなります。
      また、フィットパラメターの初期値を「%00:〜%09:」で指定してください。
      パラメターの値が変わらなくなった時を収束したと判断していますが、全く変化しなくなる事はありません。
      変化しなくなったと見なす基準を「収束(%):」で指定します。
      デフォルトでは  1% ですのでフィット結果の有効桁数は２桁です。
      これらのオプションを指定したら、ダイアログボックスを閉じて描画すればフィットが行われます。
      また、時として
      <pre>
      singular matrix あるいは too small number of data
      </pre>
      のエラーが出たり、収束せずにフィット処理がいつまでも続いてしまう事
      があります(描画進行状況を示すダイアログの「停止」ボタンを押して中断してください)。
      このような場合にはフィットパラメターの初期値を変えて再度挑戦してみてください。
      フィット関数によっては初期値をかなり慎重に選ばないと収束してくれま
      せん。
      </p>
      <p>
      なおフィッティングのユーザ定義関数では下記の定数、関数は使用できません。
      <ul>
       <li> F(), G(), H()
       <li> CIOLOR(), ALPHA()
       <li> OBJ_COLOR(), OBJ_ALPHA()
       <li> RGB(), RGB2()
       <li> HSB(), HSB2()
       <li> MARKSIZE(), MARKTYPE()
       <li> NUM
       <li> MINX, MAXX
       <li> MINY, MAXY
       <li> SUMX, SUMY
       <li> SUMXX, SUMYY, SUMXY
       <li> AVX, AVY
       <li> SGX, SGY
       <li> FIRST
       <li> MASK, MOVE
       <li> COLX, COLY
       <li> AXISX, AXISY
       <li> HSKIP, RSTEP, FLINE
       <li> FILE_OBJ, PATH_OBJ, RECT_OBJ, ARC_OBJ, MARK_OBJ, TEXT_OBJ
       <li> %D, %N
      </ul>
      </p>
</ol>

<hr>

<a name="MATH">&nbsp;</a>
<h2><a href="#TOP">数式変換機能を使う</a></h2>
<ol>
 <li><h3>データを数式で変換してプロットする</h3>
      <p>
      Ngraph ではデータファイルのデータをそのままグラフにするだけではなく、データを指定した数式で変換してからグラフにする機能を持っています。
      変換する為の式はデータダイアログボックスで「変換数式」ボタンを押して、「変換数式:」に入力します。
      変換数式は各データファイルで独立しています。
      下図のボタンを押して、複数のデータファイルの変換数式を一括して入力する事もできます。
      </p>
      <p>
      <img src="./tutorial/math.jpg">
      </p>

      <p>
      例えば、縦軸データを二乗したものをグラフにしたい時には「(Y)カラム数式変換」に
      <pre>
      Y^2 (あるいは同じ事ですが SQR(Y))
      </pre>
      と入力してください。もしデータダイアログボックスの「(Y)カラム」が 2 となっている場合には
      <pre>
      %02^2 (あるいは同じ事ですが SQR(%02))
      </pre>
      でも同じ結果を得ることができます。%02 の意味は "データファイルの2カラム目のデータ"です。
      このように %01〜%99 で特定のカラムを取り出す事ができます。
      一方、Xはデータダイアログボックスの「(X)カラム」に指定したカラムのデータであり、
      Yはデータダイアログボックスの「(Y)カラム」に指定したカラムのデータです。
      ですから、「(Y)カラム」を 3 にすると、今度は "Y" と "%03" が同じ値を示すようになります。
      </p>
      <p>
      縦軸データをカラム 1 とカラム2 の和をプロットしたい時には変換数式に
      <pre>
      %01+%02
      </pre>
      と入力してください。このようにカラム間の演算ができます。
      また、0番目(Data タブのリストの先頭の数字)のデータのカラム 1 と、1 番目のデータのカラム2 の和をプロットしたい時には変換数式に
      <pre>
      %F0001+%F0102
      </pre>
      と入力してください。このようにファイル間の演算もできます。
      </p>
      <p>
      数式変換では四則演算、括弧のほか多くの関数が使用できます。
      </p>

</ol>

<hr>

<a name="MULTI">&nbsp;</a>
<h2><a href="#TOP">複数のグラフ</a></h2>
<ol>
 <li><h3>複数のグラフの作り方</h3>
      <ul>
       <li>グラフを新たに作成する
	    <p>
	    一枚の紙に複数のグラフを作成したい場合には、 [軸]-[追加作成]メニューの中から作成したいグラフの種類を指定します。
	    あるいは下図のコントロールボタン
	    <pre>
	    <img src="../img/addgraph.png" ALT="">
	    </pre>
	    を押して、グラフ(軸)の作成モードにして グラフ上でマウスを使って位置を指定し作成する事もできます。
	    </p>
       <li>すでに作成してあるグラフを複製する
	    <p>
	    既に一つのグラフが作成してあり、それと同じ様なグラフを新たに追加するのには、
	    その既に作成してあるグラフを複製してしまうのが、より簡単で現実的です。
	    それには、下図ボタンを押してマウスをポインター(選択)モードにします。
	    このモードでは軸とレジェンドが選択対象になります(legendも一緒に複製する事を考えています)。
	    <pre>
	    <img src="../img/lapoint.png" ALT="">
	    </pre>
	    次いで、グラフ上で複製ーしたいグラフ全体を囲むようにマウスで範囲を指定します。
	    すると、マウスの範囲に入っているグラフとレジェンドが全て選択され、点線枠で囲まれます。
	    この状態で INS キーを押す(あるいはポップアップメニューを出して "複製(D)" メニューを選択する)と、
	    選択されているグラフとレジェンドが複製されます。
	    この時、フォーカス(選択)されているのは新たに複製されたグラフとレジェンドだけで、複製元は選択されていません。
	    この状態でマウスでドラッグして位置をずらしてください。
	    通常、複数のグラフを作成する場合には縦、あるいは横に位置を揃えたい場合が多いですが、
	    マウスで位置をずらす時に CTRL キーを押しながらドラッグすれば水平・垂直方向にしか移動しませんので、簡単に揃える事ができます。
	    </p>
      </ul>

 <li><h3>append.nscを使う</h3>
      <p>
      NGP ファイルとして保存されている別のグラフを、現在のグラフと同じページに取り込むのはもっと簡単です。
      Ngraph にはアドインと呼ばれる副プログラムを使う機能が用意されています。
      その一つにNGPファイルに保存されているグラフを現在のグラフに追加する APPEND が用意されています。
      [アドイン] ([Addin]) メニューの中から [Append...] を選び実行しNGPファイル名を指定するだけで、現在のグラフに追加する事ができます。
      </p>

 <li><h3>軸の名称</h3>
      <p>
      フレームグラフや方眼グラフは4つの軸(X軸、Y軸、U軸、R軸)から構成されます。
      また交差グラフは2つの軸(X軸、Y軸)から構成されます。
      これらの軸には複数のグラフを作成しても一意になるように名前が自動的に付けられます。
      軸の名前は以下の形式をしています。
      </p>
      <p>
      <table border=1>
       <tr align="CENTER"><td>グラフの種類</td><td>軸</td><td>グラフの番号</td></tr>
       <tr><td>f: フレームグラフ<br>s: 方眼グラフ<br>c: 交差グラフ</td>
	<td>X<br>Y<br>U<br>R</td>
	<td>グラフの種類毎に 1 から振られます</td></tr>
      </table>
      </p>
      <p>
      例えば、最初に作成したフレームグラフの軸の名前は fX1, fY1, fU1, fR1 となり、二番目作成したフレームグラフの軸の名前は fX2, fY2, fU2, fR2 です。
      </p>
      <p>
      Axis タブの "name" の部分には、この名前が一覧表示されます。
      またこれとは別に他のグラフィックオブジェクトと同様に0からの通し番号が付いています。
      Axis タブの "#" の部分に表示されている数字がこの番号です。
      </p>
 <li><h3>プロットする軸の指定</h3>
      <p>
      データをプロットする軸はデータダイアログボックスの「軸」に軸の通し番号を指定します。
      ただし、分かりやすい様にコンボボックスのリストには前節で説明した軸の名前が一覧表示されるようになっています。
      </p>
      
 <li><h3>軸の連携</h3>
      <p>
      Ngraph の座標軸は軸の間で連携する為の機能を2つもたせてあります。
      </p>
      <dl>
       <dt>Reference パラメタ
       <dd>
	    <p>
	    座標軸の最大・最小値が設定されていない時、Reference パラメタに他の座標軸番号が指定されていれば、
	    その軸から最大・最小値を自動的に読み取ります。主にフレームグラフの U軸, R軸の為に使われます。
	    </p>
      </dd>
       <dt>Adjust パラメタ
       <dd>
	    <p>
	    他の軸番号が指定されている場合には、
	    その軸とAdjust position で交差するように自分自身を平行移動させます。
	    主に交差グラフの軸に対して使われます。
	    </p>
      </dd>
      </dl>
      <p>
      これらは「参照軸」、「位置ボタン」-「交差軸」でそれぞれ指定できます。
      </p>
      <p>
      軸には前で説明した様に、0からの通し番号が付けられています。
      さらに、(他のグラフィックオブジェクトと同様に)実行時に一意に決まる番号も付いています(^で始まる数字として指定します)。
      Axis タブの最後の"^#" の部分に表示されている数字がこの番号です。
      上記「参照軸」や「位置ボタン」-「交差軸」のコンボボックスリストから軸の名前を選んだ場合に実際に入力されるのは、
      この「実行時に一意に決まる番号」になります。
      「通し番号」で指定してあると、軸が削除されたような場合に番号が変わってしまい、
      結果として参照関係が壊れてしまい不便なので、
      このように「実行時に一意に決まる番号」で指定するようになっているのです。
      </p>
      <p>
      複数のグラフで X 軸を共通にしたい場合、
      下図の様に Reference パラメタを設定すると fX2 軸のスケールを変えるだけで fU2, fX1, fU1 の軸のスケールを揃える事ができます。
      </p>
      <p>
      <img src="./tutorial/axisref.jpg" WIDTH="250" HEIGHT="244" ALT="">
      </p>
</ol>
<hr>
</body>
</html>
