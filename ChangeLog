2018-02-21  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/math/math_basic_function.c (math_func_array): added.

	* src/math/math_equation.c (math_equation_add_func): use
	"math_function_get_arg_type_num()".

	* src/math/math_parser.c (get_argument): use
	"math_function_get_arg_type_num()".

	* src/math/math_expression.c (math_function_get_arg_type_num): added.
	(check_argument, call_func): use
	"math_function_get_arg_type_num()".

2018-02-20  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/gtk/x11opt.c (FontSettingDialogSetupItem)
	(MiscDialogSetupItem): use "gtk_font_chooser_set_font()" instead
	of "gtk_font_button_set_font_name()".
	(FontSettingDialogAddAlternative, FontSettingDialogClose)
	(set_font): use "gtk_font_chooser_get_font()" instead of
	"gtk_font_button_get_font_name()".

	* src/gtk/x11gui.c (message_beep): use "gdk_display_beep()".

2018-02-19  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/math/math_scanner.c (math_scanner_get_token): support
	shell-like-comment.

2018-02-17  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/gtk/x11file.c (set_text_to_source_buffer): added.
	(MathTextDialogChangeInputType, MathTextDialogSetup)
	(copy_entry_to_text): use "set_text_to_source_buffer().

2018-02-15  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/gtk/completion_info.h: added.

	* src/gtk/completion_info.c: added.

	* src/gtk/create_const_info.rb: added.

	* src/gtk/create_func_info.rb: added.

2018-02-11  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/odata.c (odata_get_functions, odata_get_constants)
	(get_functions, get_constants): added.
	(file2d): add fields "functions" and "constants".

2018-02-10  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/gtk/x11file.c (FileDialogCloseCommon, MathTextDialogSetup)
	(MathTextDialogClose, FileDialogSetup): save and restore
	math-transformation intput type.

	* src/gtk/ox11menu.c (menuinit): initialize
	"Menulocal.math_input_mode".

	* src/gtk/x11dialg.h (FileDialog): add member "math_input_tab".
	(MathTextDialog): add member "input_tab".

	* src/gtk/ox11menu.h (menulocal): add member "math_input_mode".

2018-02-09  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/gtk/gtk_entry_completion.c (entry_completion_load): don't
	save a string which includes line feed.

2018-02-08  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/gtk/gtk_action.c (create_application_window): don't use
	appmenu on Windows.

	* src/gtk/x11file.c (set_escaped_str): added.
	(file_list_set_val, MathDialogSetupItem): use "set_escaped_str()".
	(MathTextDialogSetup): don't use mnemonic label.

2018-02-07  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/gtk/gtk_widget.c (create_text_view_with_line_number): use
	"GtkSourceview".

	* configure.ac: ckeck "gtksourceview-3.0".

	* src/gtk/x11menu.c (menu_undo_common, menu_undo_internal): added.
	(menu_undo): use "menu_undo_common()".
	(menu_delete_undo): check undo id.
	(menu_save_undo_single, menu_save_undo): return undo id.
	(undo_info_push): save undo id.

2018-02-06  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/gtk/x11file.c: add multi line input feature for math-transformations.

2018-02-03  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/omerge.c (get_mtime): removed.
	(read_gra): check not only "st_mtime" but "st_size".

2018-02-02  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/omerge.c (OLD_GRA_HEADER): added.
	(USE_MERGE_CACHE): added.
	(gra_data_new, gra_data_free, gra_cache_new, gra_cache_get)
	(gra_cache_free, gra_cache_init, read_new_gra_file)
	(read_old_gra_file, read_gra_file, dup_cpar, draw_gra)
	(free_cache, read_gra, merge_cache_clear, draw_gra_data): added.
	(mergedraw): use "read_gra()" when "USE_MERGE_CACHE" is true.
	(gra_info): added.

2018-01-30  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/gtk/x11commn.c (check_ref_axis, file_auto_scale): added.
	(FileAutoScale): don't save undo information.

2018-01-29  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/gtk/x11menu.c (application): call "CmViewerDraw()" when
	"LoadNgpFile()" is not called.

	* src/gtk/x11commn.c (file_auto_scale): added.
	(FileAutoScale): use the function "file_auto_scale()".

2018-01-27  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/math/math_basic_function.c (math_func_m, math_func_rm):
	accepts negative index.
	(math_func_cm): add 2nd argument.

2018-01-26  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/gtk/x11gui.c (FileSelectionDialog): use
	"gtk_file_chooser_set_extra_widget()" instead of
	"gtk_box_pack_start()".

	* src/odata.c (file_draw_line, file_draw_rect, file_draw_arc):
	always restore current point.

2018-01-25  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/gtk/x11graph.c (CmGraphShell): use "set_graph_modified()"
	instead of "set_graph_modified_gra()".

2018-01-21  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/math/math_basic_function.c (math_func_am)
	(math_func_array_average, math_func_array_stdevp)
	(math_func_array_stdev): added.

2018-01-20  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/odata.c (file_draw_line): added.

2018-01-19  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/gtk/x11file.c (set_headline_table_array)
	(set_headline_table): check maximum column.

	* src/odata.c (column_array_push, column_array_clear): added.
	(getdataarray): use "column_array_clear()" and
	"column_array_push()".

	* src/math/math_basic_function.c (math_func_push): use
	"math_equation_push_array_val()".

	* src/math/math_equation.c (math_equation_push_array_val): added.

2018-01-18  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/odata.c (getdataarray): call the function
	"set_column_array()".
	(set_column_array): call the function
	"math_equation_clear_array()".
	(set_column_array): check the parameter "id".

	* src/math/math_basic_function.c (math_func_array_clear): added.
	(math_func_array_sum): added.
	(math_func_array_max, math_func_array_min): added.
	(math_func_array_compact): added.

	* src/math/math_equation.c (math_equation_clear_array): added.

2018-01-17  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/odata.c (getposition): use "getposition2()" and
	"_f2dtransf()".
	(f2dtransf): use "_f2dtransf()".
	(_f2dtransf): return integer.

2018-01-16  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/odata.c (f2ddata, f2dlocal): add member "column_array_id_x"
	and "column_array_id_y".
	(opendata): initialize "fp->column_array_id_x" and
	"fp->column_array_id_y".
	(f2dputmath): check "column" array.
	(f2dinit): initialize "f2dlocal->column_array_id_x" and
	"f2dlocal->column_array_id_y".
	(set_column_array): added.
	(get_data_from_source): use the function "set_column_array()".
	(file_draw_mark): added.

2018-01-14  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/odata.c (file_draw_arc, file_draw_rect): added.
	(FileFunc): add drawing functions.
	(opendata): initialize "fp->GC".
	(f2ddraw): set "fp->GC".
	(file_draw_rect, file_draw_arc): check the variable "fp".

	* src/gra.c (GRAcurrent_point): added.

	* src/odraw.c (curve_expand, curve_expand_points): moved from
	"opath.c".

	* src/opath.c (curve_expand_points): change parameters.
	(opath_curve_expand_points): added.
	(arrowdraw, arrowbbox, point_match): use
	"opath_curve_expand_points()".

2018-01-05  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* addin/gimg2gra.c (gra_save, fputcolor): don't draw fully
	transparent color information and image.

2017-12-31  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/gtk/x11commn.c (FileAutoScale): save undo information.

2017-12-27  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/odata.c (ofile_create_math_equation): use "STDEVPX" and
	"STDEVPY" instead of "SGX" and "SGY".
	(f2dstat): add fields "dstdevpx", "dstdevpyy", "dstdevx" and
	"dstdevy".

2017-12-26  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/math/math_basic_function.c (math_func_sumsq): added.

2017-12-21  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/gtk/x11view.c (create_axis): use "menu_undo()" to cancel
	creation of instances.

	* src/gtk/x11merge.c (CmMergeOpen): use "menu_undo()" to cancel
	edit.
	(CmMergeUpdate): call "MergeWinUpdate()" only when merge objects
	are updated.

	* src/gtk/x11file.c (CmFileHistory, CmRangeAdd): use "menu_undo()"
	instead of "menu_delete_undo()" to cancel creation of an instance.
	(FileWinFileUpdate): don't consider "IDDELETE".

	* src/gtk/x11axis.c (SectionDialogGrid): use "menu_undo()" to
	cancel edit.
	(CmAxisNewFrame, CmAxisNewSection, CmAxisNewCross)
	(CmAxisNewSingle, CmAxisGridNew): use "menu_undo()" to cancel
	creation.
	(CmAxisUpdate): check the returned value of the function
	"DialogExecute()" is "IDCANCEL" or not.

2017-12-20  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/gtk/x11view.c (new_merge_obj, new_file_obj)
	(create_single_axis, create_axis): don't consider "IDDELETE".
	(ViewUpdate): remove dodes related to "IDDELETE".

2017-12-19  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/gtk/x11file.c (CmFileMath): check the variable
	"modified".
	(MathTextDialog, MathDialog): initialize "modified" member
	variable.
	(MathTextDialogClose, MathDialogList): set "modified" member
	variable.

	* src/gtk/x11dialg.h (MathDialog, MathTextDialog): add member
	"modified".

2017-12-14  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/gtk/x11view.c (ViewUpdate): redraw only when the graph is
	modified.

	* src/gtk/x11axis.c (select_type): redraw data object when "type"
	field is changed.

2017-12-13  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/gtk/x11file.c (CmFileNew): removed.
	(update_file_obj_multi): "modified" is always true when "IDDELETE"
	is returned;

2017-12-12  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/gtk/x11menu.c (set_undo_menu_label): update undo and redo
	menu label when use GtkBuilder.

	* src/gtk/x11file.c (update_file_obj_multi): call
	"data_save_undo()" befor call "DialogExecute()".
	(update_file_obj_multi): return modified or not.

	* src/gtk/x11menu.c (MODIFIED_TYPE_UNMODIFIED): added.
	(undo_check_modified): call "set_graph_modified()" only when
	"modified_saved"is TRUE.

	* src/gtk/x11menu.h (MENU_UNDO_TYPE): add "UNDO_TYPE_DUMMY".

	* src/gtk/x11view.c (CmEditMenuCB): check "Menulock" and "Globallock".

	* src/gtk/gtk_subwin.c (update): call "d->undo_save" if available.
	(update): always call "set_graph_modified()" after call
	"DialogExecute()".
	(update): use "menu_undo(FALSE)" instead of "menu_delete_undo()".

2017-12-11  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/gtk/gtk_subwin.c (update): don't call "d->update()" if the
	returned value of the function "DialogExecute()" is "IDCANCEL".

	* src/gtk/x11file.c (FitDialogResult): use "markup_message_box()".
	(select_type): check the returned value of the function
	"show_fit_dialog()".
	(FileWinFileUpdate): don't call "d->update()" if the returned
	value of the function "DialogExecute()" is "IDCANCEL".

	* src/gtk/x11gui.c (markup_message_box): added.
	(message_box): use "markup_message_box()".

2017-12-07  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/omerge.c (set_bbox): added.
	(mergebbox, mergemove, mergezoom, mergegeometry): use
	"set_bbox()".

2017-12-06  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/omerge.c (get_mtime): added.
	(mergedraw): check mtime.
	(mergemove, mergegeometry): use saved bounding box.

	* src/odata.c (f2dredraw): check the returned value of the function "f2ddraw()".

2017-12-05  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/gtk/x11merge.c (MergeWinUpdate): call "draw_notify()".

	* src/osystem.c (system_set_draw_notify_func, system_draw_notify):
	added.

	* src/omerge.c (mergeredraw): call "system_draw_notify()".

	* src/odata.c (f2dredraw): call "system_draw_notify()".

	* src/gtk/x11view.c (graph_dropped): don't call "CmViewerDraw()".

	* src/gtk/x11menu.c (application): call "system_set_draw_notify_func()".
	(UpdateAll2): add 2nd argment.
	(ChangePage): call "draw_notify()".

	* src/gtk/x11graph.c (CmGraphNewMenu): call "UpdateAll2()" instead
	of "UpdateAll()".

	* src/gtk/x11view.c (Draw): call "draw_notify()".

	* src/gtk/x11menu.c (draw_notify): added.

	* src/gtk/x11menu.h (FileDrawFlag): added.

	* src/gtk/x11file.c (FileWinUpdate): call "draw_notify()".

	* src/gtk/gtk_subwin.c (update): redraw flag is now "FILE_DRAW_NOTIFY".

	* src/gtk/data/css/ngraph.css: add definition of "draw_notify" class.

2017-12-04  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/gtk/x11file.c (CmFileHistory, CmFileNew, CmFileOpen)
	(FileWinFileCopy, FileWinFileCopy2): don't redraw.

	* src/gtk/x11lgnd.c (LegendWinUpdate): add 3rd argument.

	* src/gtk/x11merge.c (MergeWinUpdate): add 3rd argument.

	* src/gtk/x11file.c (FileWinUpdate): add 3rd argument.

	* src/gtk/x11axis.c (AxisWinUpdate): add 3rd argument.

	* src/gtk/x11lgnd.c (TextListUpdate, MarkListUpdate)
	(RectListUpdate, ArcListUpdate, PathListUpdate): add 3rd argument.
	(ObjListUpdate): redraw object depend on the 3rd parameter.

2017-12-02  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/gtk/x11file.c (FileWinFileDraw): save undo information.

	* src/gtk/x11merge.c (MergeWinUpdate): draw merge object.

	* src/gtk/x11menu.c (UpdateAll): call only "UpdateAll2()".
	(check_update_obj): added.
	(UpdateAll2): use "check_update_obj()".

	* src/gtk/x11file.c (FileWinFileDraw): don't call "CmViewerDraw()".
	(FileWinUpdate): draw data object.

	* src/gtk/x11axis.c (AxisWinUpdate): draw axis, axisgrid and data
	objects.

2017-12-01  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/gtk/x11gui.c (message_beep): call "gdk_beep()" when the
	variable "parent" is NULL.

2017-11-30  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/gtk/x11gui.c (message_beep): use "gdk_window_beep()" instead
	of "gdk_beep()".
	(fsok): use "message_beep()" instead of "gdk_beep()".

2017-11-29  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* addin/timer.nsc: execute "gra::flush".

	* addin/img2gra.nsc: execute "gra::flush".

2017-11-27  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/gtk/x11menu.c (reset_graph_modified): call "reset_modified_info()".
	(undo_info_push): initialize the member "modified".
	(undo_check_modified): added.
	(menu_undo, menu_redo): save the modified information.
	(get_graph_modified): return "Menulocal.modified".
	(set_graph_modified_gra, reset_modified_info): added.

	* src/gtk/x11graph.c (CmGraphShell, CmGraphSwitch, CmGraphPage):
	call "set_graph_modified_gra()" instead of "set_graph_modified()".

	* src/gtk/ox11menu.c (menuinit): initialize "Menulocal.modified".
	(mxmodified): set value to "Menulocal.modified".

2017-11-09  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/math/math_parser.c (parse_primary_expression): the
	limitation of the length is not applied when the variable is start
	with the character '_'.

2017-10-27  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/math/math_scanner.c (math_scanner_get_token): accepts '_' as
	the first character of a symbol.

2017-10-12  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/gtk/x11print.c (CmOutputPrinter): fix memory leak.

2017-10-03  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/gtk/ox11menu.c (create_layer): added.
	(init_layer): use "create_layer()".

2017-09-30  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/gra.c (GRAtextextent, GRAdrawtext): use "g_strndup()"
	instead of "g_malloc()" and "strncpy()".
	(GRAtextextent): fix calculation of the bounding-box.

2017-09-28  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/gtk/x11commn.c (get_save_opt): check source field of data
	objects.

2017-09-25  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/gtk/ox11menu.c (MenuConfigToggleView): add "show_grid" configration.

	* src/gtk/x11menu.c (toggle_view): add case for MenuIdToggleGridLine.
	(ViewMenu): agg grid menu item.

	* src/gtk/x11view.c (draw_grid): added.

2017-09-22  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/gtk/x11menu.c (UpdateAll2): add parameter.

	* src/gtk/x11lgnd.c (LegendWinUpdate): add first parameter.

2017-09-18  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/gtk/x11menu.c (UpdateAll): don't redraw legends.

2017-09-12  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/gtk/x11gui.c (DialogExecute): dont connect "key-press-event"
	signal (use CSS).

2017-09-11  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/gtk/x11dialg.c (CopyDialog, SelectDialog): add "title" parameter.

	* src/gtk/x11commn.c (ProgressDialogCreate): use predefined function "gtk_true()".

	* src/gtk/x11gui.c (DialogExecute): remove redundant call of the
	function "gtk_window_set_title()".
	(DialogExecute): use predefined function "gtk_true()".

2017-09-07  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/gtk/ox11menu.c (MenuConfigMisc): add custom palette support.
	(add_color_ary_to_array, menu_config_set_custom_palette)
	(init_custom_palette): added.
	(menu_save_config_sub, mgtkloadconfig, menulocal_finalize)
	(menuinit): add custom palette support.

	* src/gtk/gtk_widget.c (add_default_color, add_default_gray)
	(set_default_palette, show_color_dialog, set_custom_palette):
	added.
	(create_color_button, select_obj_color): add custom palette
	support.

	* src/gtk/x11opt.c (edit_custom_palette, save_custom_palette)
	(create_custom_palette_buttons): added.
	(MiscDialogSetup, MiscDialogClose, MiscDialogSetupItem): add
	custom palette support.

2017-09-06  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/object.c (arraycmp, arraycpy): added.

2017-09-05  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/gtk/x11view.c (ViewerEvLButtonUp): don't call "UpdateAll()".
	(check_last_insts, focus_new_insts): static function.
	(focus_new_insts): save created objects.

	* src/odata.c (f2dredraw): don't call "ignorestdio()" and "restorestdio()".

	* src/gtk/ox11menu.c (mx_redraw): call "ignorestdio()" and "restorestdio()".

	* src/odata.c (f2derror): use snprintf() instead of sprintf().

2017-09-04  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/gtk/x11view.c (CmEditMenuCB): call the function
	"set_focus_sensitivity()".

	* src/omerge.c (mergeredraw): draw a rectangle instead of a image.

2017-09-03  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/gtk/x11axis.c (axis_save_undo): save undo information of the
	data object.

	* src/gtk/ox11menu.c (mx_redraw): use the function "GRArederaw()".

	* src/gra.c (_GRAredraw): now static function.

	* src/gtk/x11graph.c (CmGraphShell): call "set_graph_modified()".

2017-09-02  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/object.c (arraydup): bug fix: array->data can be NULL.

2017-09-01  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/odata.c (f2dredraw): call "ignorestdio()" and "restorestdio()".

	* src/gtk/x11lgnd.c (ObjListUpdate): set "NgraphApp.Viewer.allclear" as TRUE.

	* src/gtk/x11view.c (mouse_down_move_data, Evaluate): call "UpdateAll()".

	* src/gtk/x11commn.c (GetPageSettingsFromGRA): check alias name
	and duplications.

	* src/object.c (arrayuniq_all_str): added.

2017-08-30  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/gtk/gtk_subwin.c (update_viewer): added.

	* src/gtk/x11view.c (create_pix): dont set
	"Menulocal.local->cairo".

	* src/gtk/x11menu.c (script_exec): call "UpdateAll()" instead of
	"UpdateAll2()".

	* src/gtk/x11lgnd.c (ObjListUpdate): call "ViewerWinUpdate()".

	* src/gtk/x11commn.c (LoadNgpFile): call "CmViewerDraw()".

2017-08-27  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/gtk/x11view.c (create_layers): added.

	* src/gtk/ogra2cairo.c (set_cairo_antialias): added.

	* src/ogra.c (oGRAdrawparent, oGRAdraw): call "GRAlayer()".

	* src/gra.c (GRAlayer): added.

2017-08-26  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/gtk/x11view.c (ViewerEvPaint): draw background and
	foreground images.
	(update_bg): added.
	(create_pix): create background image.
	(draw_paper_frame): removed.

	* src/gtk/x11opt.c (ViewerDialogClose): call "update_bg()" anf
	"UpdateAll2()" when background color is changed.

	* src/gtk/ox11menu.c (mx_clear): fill "empty" image.

	* src/odata.c (file_alpha): add "break" statement.

2017-08-18  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/gtk/x11view.c (get_focused_obj_array): added.

	* src/gtk/x11file.c (data_save_undo): added.

	* src/gtk/x11axis.c (axis_save_undo): added.

	* src/gtk/x11menu.c (menu_redo, menu_undo, menu_clear_undo)
	(menu_delete_undo, menu_save_undo): save undo informations.
	(menu_save_undo_single): added.
	(set_undo_menu_label): added.
	(undo_info_pop, undo_info_push): added.
	(menu_undo_iteration): add second parameter.
	(menu_check_undo, menu_check_redo): check undo informations.

	* src/gtk/x11menu.h (MENU_UNDO_TYPE): added.

2017-08-12  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/gtk/x11axis.c (axis_check_history): added.

2017-08-11  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/gtk/x11lgnd.c (legend_menu_update_object): added.
	(CmLineUpdate, CmRectUpdate, CmArcUpdate, CmMarkUpdate)
	(CmTextUpdate): use "legend_menu_update_object()".
	(legend_menu_delete_object): added.
	(CmLineDel, CmRectDel, CmArcDel, CmMarkDel, CmTextDel): use
	"legend_menu_delete_object()".

2017-08-10  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/object.c: add undo related functions.

2017-08-09  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/odata.c (data_inst_dup, data_inst_free): added.

	* src/omerge.c (merge_inst_dup, merge_inst_free): added.

	* src/ofit.c (fit_inst_dup, fit_inst_free, create_math_equation): added.
	(fitput): use "create_math_equation()".

2017-08-08  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/gtk/x11view.c (move_objects): added.
	(mouse_up_drag, ViewerEvKeyUp): use "move_objects()".

2017-07-25  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* addin/gimg2gra.c (create_widgets): added.
	(main): use create_widgets().
	(create_widgets): use gdk_pixbuf_new_from_file() and
	gtk_image_new_from_pixbuf() instead of gtk_image_new_from_file().

2017-06-23  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/gtk/init.c (exec_console): use "system" to execute xterm on
	macOS.

	* src/otext.c (textmatch): fix point coordinates calculation.

2017-06-08  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/odata.c (getdata_skip_step): bug fix: use "rstep" instead of
	"hskip".

2017-06-07  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/gtk/x11file.c (CmRangeAdd): default plot type is "line" when
	data source is "range".

2017-05-25  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/gtk/x11menu.c (create_recent_menu): use RECENT_CHOOSER_LIMIT.

	* src/gtk/gtk_common.h (RECENT_CHOOSER_LIMIT): added.

2017-05-16  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/gtk/ox11menu.h (paper_id): add PAPER_ID_NORMAL and
	PAPER_ID_WIDE.


	* src/gtk/x11graph.c (pagelist): add "normal display" and "wide
	display".

2017-04-12  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/oiarray.c (iarray_sdev): check the value befor call sqrt.

	* src/odata.c (f2dstat_sub, set_const): check the value befor call
	sqrt.

	* src/odarray.c (darray_sdev): check the value befor call sqrt.

2017-03-31  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/ofit.c (show_poly_equation): improve tne notation of an
	equation.

2017-03-30  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/nstring.c (get_printf_format_str): check '^' flag.
	(str_to_pow): added.
	(add_printf_formated_str): support '^' flag.

2017-03-03  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/gtk/gtk_action.c (create_application_window): set
	G_APPLICATION_NON_UNIQUE flag to GtkApplication.

	* src/gtk/x11gui.c (FileSelectionDialog): don't use global variable.

2017-03-02  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/gtk/x11menu.c (setup_toolbar): added.
	(create_toplevel_window): call "setup_toolbar()" before realize the window.

	* src/gtk/x11commn.c (ProgressDialogCreate): don't destory existent widget.
	(ProgressDialogFinalize): don't destory widget.

2017-03-01  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/odata.c (getdataarray, f2dcolumn_file): remove extraneous parentheses.

	* src/math/math_parser.c (my_get_token): remove duplicate 'const'.

2017-02-26  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/gtk/x11menu.c (create_toolbar, create_menu_sub): use
	"gtk_image_new_from_resource()".

	* src/gtk/x11lgnd.c (LegendWinState): use
	"gtk_image_new_from_resource()".

	* src/gtk/gtk_widget.c (create_image_from_file): removed.

	* src/gtk/init.c (load_css): use
	"gtk_css_provider_load_from_resource()".

	* src/gtk/gtk_subwin.c (sub_window_create): use
	"gdk_pixbuf_new_from_resource()".

	* src/gtk/gtk_action.c (create_application_window): add
	GtkShortcutsWindow.
	(help_overlay_action): app menu is automatically generated by
	GtkApplication.

	* src/gtk/dir_defs.h: remove "PIXMAPDIR".

	* src/gtk/data/ngraph.resources.xml: add resource files as sources.

2017-02-24  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/gtk/x11menu.c (MainMenu): show "Help" menu because appmenu
	can be hidden.

	* src/gtk/gtk_action.c (AppEntries): add "preference" action (for macOS).
	(create_application_window): divide appmenu resource file.

2017-02-22  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/gtk/x11menu.c (create_toolbar): use
	"gtk_menu_tool_button_set_arrow_tooltip_text()".
	(SaveMenu, create_save_menu): added.
	(create_toolbar): use GtkMenuToolButton for save tool button.
	(create_save_menu): use GtkAction when "USE_GTK_BUILDER" is true.

2017-02-21  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/gtk/x11file.c (FileWinState): use
	"tree_view_set_no_expand_column()".

	* src/gtk/x11lgnd.c (LegendWinState): use
	"tree_view_set_no_expand_column()".

	* src/gtk/gtk_liststore.c (tree_view_set_no_expand_column): added.

2017-02-17  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/common.h (OSX): check OSX environment.

2017-02-16  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* configure.ac: check OSX environment.

	* src/gtk/x11menu.c (ObjectMenu): add "Object" menu.

2017-02-13  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/gtk/x11lgnd.c (create_color_combo_box): add "Stroke" and
	"Fill" menu items under the each submenu.

2017-02-10  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* configure.ac: remove GTK+2 support.
	(GTK3_REQUIRED_VERSION): support GTK+ 3.4.0 or later.

2017-02-09  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/gtk/x11menu.c (MainMenu): remove "Help" menu (integrated to
	the app menu).

2017-02-08  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/gtk/x11lgnd.c (Mlist): change step for mark size.
	(Tlist): change step size for font size.

	* src/gtk/gtk_widget.c (create_spin_entry_type): change step size for font size.

	* src/gtk/init.c (n_initialize): don't use "g_mem_set_vtable()".

	* src/osystem.c (system_mem_profile): removed.

	* src/common.h (MARK_TYPE_NUM): removed.

	* src/gtk/gtk_subwin.c (do_popup): set "d->select" before call
	"gtk_menu_popup_at_pointer()".

	* src/odata.c (line_number, add_func_sub, add_basic_func): added.
	(add_file_func, add_fit_func): use "add_func_sub()".
	(ofile_create_math_equation): call "add_basic_func()".

	* src/ntime.c (mjd2gd): fix time calculation.

2017-02-05  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/gtk/ox11dlg.c (get_toplevel_window): added.

	* addin/spellchecker.rb (NgraphSpellchecker): save and restore
	dialog position.

2017-02-02  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/gtk/x11view.c (do_popup): call "gtk_widget_realize()" when
	the popup menu is not realized.

2017-02-01  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/gtk/x11lgnd.c (LegendArrowDialogScale): added.
	(LegendArrowDialogScaleW, LegendArrowDialogScaleL): use
	"LegendArrowDialogScale()".

2017-02-01  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* plugins/ruby/ngraph.c (wrap_load_script): added.
	(load_script): use "wrap_load_script()" with "rb_protect()"
	instead of "rb_load_protect()".

	* plugins/ruby.c (require_files): added.
	(ngraph_plugin_open_ruby): use "require_files()" with
	"rb_protect()".

2017-01-31  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/gtk/gtk_combo.c (set_model): "gtk_cell_renderer_text_new()"
	shoud be called only when the variable "renderer" is true.

	* plugins/ruby.c (ngraph_plugin_open_ruby): use "rb_protect()" to
	avoid exception.

2017-01-27  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/gtk/x11menu.c (set_focus_sensitivity_sub): the merge object
	can be deleted and duplicated.

	* addin/spellchecker.rb (NgraphSpellchecker#spell_check): use
	"buttons" and "response_button" fields of the Ngraph::Dialog
	object.

	* src/gtk/x11gui.c (add_buttons): added.
	(DialogButton, DialogCombo, DialogComboEntry, DialogSpinEntry)
	(DialogCheck): use "add_buttons()".

	* src/gtk/ox11dlg.c (dlg_get_buttons): added.
	(dlginput, dlgradio, dlgcombo, dlgspin, dlgcheck): use
	"dlg_get_buttons()".
	(dialog): add "buttons" and "response_button" fields.

2017-01-26  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* plugins/ruby/ngraph.c (set_ngraph_obj_class_name): added.
	(get_ngraph_obj, add_obj_name_const): use "set_ngraph_obj_class_name()".

2017-01-25  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/odata.c (f2dlocal_array_sub, f2dstat_array, f2dstat_range): removed.
	(f2dstat_sub): renamed from "f2dstat_file()".
	(f2dstat): always use "f2dstat_sub()".
	(opendata): "fp->mtime" is always 1 for the source type
	"DATA_SOURCE_ARRAY" and "DATA_SOURCE_RANGE".

2017-01-23  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/math/math_parser.c (parse_primary_expression): now accepts
	two character variable.

	* src/shell.c (nsleep): use g_thread.

	* plugins/ruby/ngraph.c (nsleep): accepts real number (not only
	integer).

	* src/shellux.c (cmsleep): accepts real number (not only integer).

2017-01-01  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* plugins/ruby/Makefile.am: use "$(MAKE)" and "$(AM_MAKEFLAGS)".

	* src/Makefile.am (ngraph_DEPENDENCIES): set dependency.

2016-12-30  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/oio.c (io_open): check security.

2016-12-26  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/gtk/gtk_widget.c (set_widget_font): use PangoFontDescription
	to make css string.

2016-12-23  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/gtk/x11menu.c (create_icon): use image file for application
	icon (Windows).

	* src/gtk/gtk_subwin.c (sub_window_create): use image file instead
	of xpm data.

	* pixmap/Makefile.am (dist_pixmap_DATA): add application icons and
	48 dot window icons.

2016-12-13  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* mingw/windows64.sh: use mingw package for the installation.

	* src/gtk/init.c (set_dir_defs, set_path_env): add "BINDIR" to the
	windows "PATH" environment.

2016-11-29  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/gtk/gtk_ruler.c (_Nruler): hold widget style and foreground
	color.

	* initfile/Ngraph.ini.win (font): add "Malgun Gothic".

	* debian/control (Build-Depends): depend on "libreadline-dev".

2016-11-28  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/gtk/gtk_ruler.c (nruler_get_color): use cached color to
	avoid busy loop in the function "AppMainLoop()".

	* src/gtk/x11menu.c (check_pending_event): removed (redundant
	event check).

2016-11-25  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/gtk/ogra2x11.c (gtk_evloop): use "check_pending_event()"
	instead of "gtk_events_pending()".

2016-11-01  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/gtk/gtk_subwin.c (popup_menu_position): not used if the
	version of GTK+ is greater or equal to 3.22.

	* src/gtk/x11view.c (popup_menu_position): not used if the version
	of GTK+ is greater or equal to 3.22.

2016-10-26  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/gtk/x11menu.c (defaultwindowconfig)
	(create_toplevel_window): use "gdk_monitor_get_geometry();" if the
	version of GTK+ is greater or equal to 3.22.

	* src/gtk/x11lgnd.c (LegendArrowDialogScaleL)
	(LegendArrowDialogScaleW): use "gdk_window_invalidate_rect()" if
	the version of GTK+ is greater or equal to 3.22.

	* src/gtk/x11view.c (do_popup): use "gtk_menu_popup_at_pointer()"
	if the version of GTK+ is greater or equal to 3.22.
	(mouse_down_zoom2): don't use "show_zoom_animation()" if the
	version of GTK+ is greater or equal to 3.22.

	* src/gtk/gtk_subwin.c (do_popup): use
	"gtk_menu_popup_at_pointer()" if the version of GTK+ is greater or
	equal to 3.22.

2016-09-07  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/gtk/x11menu.c (check_pending_event): added.
	(AppMainLoop, reset_event, ChkInterrupt): use "check_pending_event()".

2016-08-01  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/gtk/gtk_widget.c (create_text_view_with_line_number): call
	"gtk_widget_set_margin_end()".

2016-07-29  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* addin/cal.nsc: use "ncal" instead of "cal".

	* src/gtk/gtk_widget.c (set_widget_font): us "*" as a selector.

	* initfile/ngraph.css: fix selector and style.

2016-07-28  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/shell.c (ngraphenvironment): check returned value of the
	function "g_strdup_printf()".

	* src/oshell.c (cmdshell): functions "shellsavestdio()" and
	"shellrestorestdio()" must be called always.

2016-01-05  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* debian/control (Build-Depends): depend on "libgsl-dev".

2016-01-01  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/gtk/x11menu.c (create_toolbar): set label for radio tool
	buttons.
	(show_recent_dialog): check "Menulock" and "Globallock".

	* src/gtk/gtk_subwin.c (spin_button_size_allocated)
	(start_editing): don't change allocated size.

	* src/gtk/x11file.c (FileDialogClose): save range parameters.

2015-09-21  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/math/math_expression.c: fix typo.

	* src/math/math_expression.h (MATH_EXPRESSION_TYPE_DOUBLE): fix typo.

	* src/math/math_equation.c (optimize_func_cb, check_const_sub): fix typo.

2015-08-19  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* initfile/Ngraph.nsc: unset used variables.

	* src/gtk/x11gui.c (FileSelectionDialog): call
	"gtk_file_chooser_set_local_only()".

	* src/gtk/x11graph.c (DirectoryDialogSetup): call
	"gtk_file_chooser_set_local_only()".

2015-08-03  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/gtk/gtk_action.c (ViewSidebarAction_activated)
	(ViewStatusbarAction_activated, ViewRulerAction_activated)
	(ViewScrollbarAction_activated)
	(ViewCommandToolbarAction_activated)
	(ViewToolboxAction_activated, ViewCrossGaugeAction_activated):
	check returned value of the function "toggle_view()".
	(ViewToggleSingleWindowModeAction_activated): check
	"Menulocal.single_window_mode".

	* src/gtk/x11menu.c (toggle_view, CmReloadWindowConfig)
	(CmToggleSingleWindowMode): check "Menulock" and "Globallock".
	(toggle_view): return success or false.

2015-07-30  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/osystem.c (WEB): The repository is moved from SourceForge to
	GitHub.

2015-07-15  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/shell.c (expand): remove "WILD_PERIOD" flag.

	* src/nconfig.c (replaceconfig, removeconfig): free "fil" when the
	variable "fptmp" is NULL.

	* src/gtk/init.c (load_css): this function is used only when the
	vertsion of the GTK+ is greater or equal to 3.16.

	* src/gtk/ox11menu.c (mx_show_lib_version): check
	"RL_VERSION_MAJOR" instead of "HAVE_READLINE_READLINE_H".

2015-07-14  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/gtk/x11menu.c (create_cursor): use
	"gdk_cursor_new_for_display()" instead of "gdk_cursor_new()".

	* src/gtk/x11info.c (InfoWinSetFont): use "set_widget_font()".

	* src/gtk/x11file.c (HEADLINE_FONT_COLUMN): added.
	(create_preview_table): add font column.
	(update_table_visibility, set_headline_table_array)
	(set_headline_table): set font.
	(FileDialogSetup, ArrayDialogSetup): dont setup font.

	* src/gtk/x11cood.c (CoordWinSetFont): use "set_widget_font()".

	* src/gtk/ogra2x11.c (gtkwait_action): use
	"gdk_cursor_new_for_display()" instead of "gdk_cursor_new()".

	* src/gtk/init.c (load_css): added.
	(n_initialize): use "load_css()".

	* src/gtk/gtk_widget.c (set_widget_font): added.
	(text_view_with_line_number_set_font): use "set_widget_font()".

	* src/gtk/gtk_ruler.c (nruler_get_color): remove 3rd parameter.
	(nruler_draw_ticks): use "gtk_render_background()".

2015-07-06  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/gtk/init.c (n_initialize): load css file.

	* initfile/ngraph.css: added.

	* initfile/Makefile.am (dist_ngraphui_DATA): add "ngraph.css"

2015-07-05  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/gtk/gtk_widget.c (set_linumber_color): not used if the
	vertsion of the GTK+ is greater or equal to 3.16.

	* src/gtk/gtk_common.h (LINE_NUMBER_WIDGET_NAME): added.

2015-07-04  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/math/math_expression.h: remove unnecessary definition of a
	variable "function_argument".

	* src/gtk/gtk_widget.c (set_button_icon): do nothing when the
	vertsion of the GTK+ is greater or equal to 3.12.
	(set_linumber_color): use "GTK_STATE_FLAG_*" instead of
	"GTK_STATE_*".

2015-07-01  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/gtk/gtk_liststore.c (add_line_style_item_to_cbox): use
	"g_strcmp0()" instead of "strcmp()".

2015-06-03  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/gtk/init.c (n_save_shell_history): "HistoryFile" is not
	declared when "HAVE_READLINE_READLINE_H" is false.

2015-05-09  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* use "void *" instead of "GtkAction *".

2015-04-03  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/shell.c (cmdexec): don't call "check_interrupt()" and
	"reset_interrupt()".

2015-03-13  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/shell.h: the function "set_signal()"is not used in Windows.

	* src/oshell.c (cmdshell): signal is not used in Windows.

2015-03-06  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/odata.c (set_data_progress): check not only "ninterrupt()"
	but "fp->interrupt".
	(file_calculate): "fp->interrupt" is true when "val->type" is
	"MATH_VALUE_INTERRUPT".
	(getdata_sub1): check "fp->interrupt".

	* src/math/math_expression.c (math_expression_calculate): retain
	"val->type" when the type is "MATH_VALUE_INTERRUPT".

	* src/math/math_basic_function.c (math_func_for)
	(math_func_while): return "MATH_VALUE_INTERRUPT" when interrupted.

	* src/math/math_equation.h (MATH_VALUE_INTERRUPT): added.

	* src/gtk/x11view.c (check_paint_lock): added.

	* src/gtk/x11menu.h (NgraphApp): remove member "Interrupt".

	* src/gtk/x11menu.c (kill_signal_handler): call "set_interrupt()".
	(AppMainLoop): don't reset interruption.
	(ChkInterrupt): call "check_interrupt()" when "DrawLock !=
	DrawLockDraw".

	* src/gtk/x11commn.c (stop_btn_clicked): use "set_interrupt()".
	(ProgressDialogCreate): call "reset_interrupt()".

	* src/gtk/x11axis.c (pos_edited_common, axis_prm_edited_common):
	call "menu_lock(FALSE)".
	(pos_y_edited, pos_x_edited): don't call "menu_lock(FALSE)".

2015-03-04  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/oshell.c (int_handler): added.
	(cmdshell): save, set and restore signal handler for the "SIGINT"
	signal.

	* src/shell.c (nsleep): use "reset_interrupt()" and
	"check_interrupt()".
	(set_signal): add 4th parameter.
	(set_interrupt, reset_interrupt, check_interrupt): added.
	(cmdexec): use "reset_interrupt()" and "check_interrupt()".

2015-02-28  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/math/math_function.h.in: add function "while".

	* src/math/math_basic_function.c (math_func_while): added.
	(math_func_for): check interruption.

2015-01-22  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* doc/html/ja/math.html (特殊関数): update document.

	* src/math/math_function.h.in: add function "mjd2unix".

	* src/math/math_basic_function.c (math_func_mjd2unix): added.

2014-12-24  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/gtk/x11axis.c (scale_tab_create): change label fron "File"
	to "Data".

2014-12-17  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* addin/fitrslt.c (savescript, create_format_frame) :add "shadow"
	check button.
	(frame_toggled): added.

	* addin/legend.c (savescript, create_option_frame): add "shadow"
	check button.
	(frame_toggled): added.

2014-12-13  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* addin/fitrslt.nsc: use "get" command.

	* addin/fitrslt.c (set_parameter): check variable "i".
	(set_parameter): use "data" object.

2014-11-20  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/gtk/gtk_widget.c (_create_spin_entry)
	(create_direction_entry): call "gtk_entry_set_max_width_chars()".

2014-11-13  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/gtk/x11view.c (graph_dropped): don't call "LoadDialog()".

	* src/gtk/x11graph.c (LoadDialog): free "data->exdir" if
	necessary.
	(CmGraphLoad, CmGraphHistory): don't call "LoadDialog()".

	* src/gtk/x11dialg.c (initdialog): initialize "DlgLoad.exdir".

	* src/gtk/x11commn.c (LoadNgpFile): call "LoadDialog()".

2014-11-12  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/oprm.c (addfontcontrol, remarkconv, prmload): support recent
	Ngraph objects.

	* src/gtk/x11view.c (graph_dropped): don't load PRM file.

	* src/gtk/x11menu.c (check_instance): call
	"set_axis_undo_button_sensitivity()".
	(application): don't load PRM file.

	* src/gtk/x11graph.c (PrmDialogSetup, PrmDialogClose, PrmDialog):
	removed.
	(CmGraphLoad): don't load PRM file.

	* src/gtk/x11dialg.c (initdialog): remove "PrmDialog".

	* src/gtk/x11commn.c (GraphSave): don't consider PRM file.
	(LoadPrmFile): removed.

	* src/gtk/ox11dlg.c (dlgconfirm, dlgmessage, dlginput)
	(dlgbutton, dlgradio, dlgcombo, dlgspin, dlgcheck): update title
	of the window.

	* addin/load_prm.nsc: added.

2014-10-26  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/gtk/x11menu.c (create_toolbar): use gettext to show
	tooltips.

2014-10-05  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/gtk/x11menu.c (set_widget_visibility): call
	"set_toggle_action_widget_state()" twice when "USE_GTK_BUILDER" is
	false.

2014-10-03  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/gtk/x11menu.c (create_toplevel_window): call
	"set_widget_visibility()" only once.

2014-10-02  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* debian/rules (override_dh_auto_configure): add
	"--with-versioned-symbol" option.

	* src/Makefile.am (libngraph_ldflags): use "vsymldflags".

	* configure.ac (vsymldflags): add "--with-versioned-symbol" option.

2014-09-27  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/gtk/x11view.c (ViewerWinSetup): check "d->popup".

	* src/gtk/x11menu.c (setupwindow): check "NgraphApp.Viewer.popup".
	(create_menu_sub): don't call "gtk_application_add_accelerator()".
	(create_toplevel_window): don't call
	"gtk_window_set_has_resize_grip()".

	* src/gtk/x11file.c (RangeDialogSetup): change width of numeric
	entries.

	* src/gtk/gtk_action.c (create_application_window): create popup
	menu.

2014-09-05  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* debian/libngraph0.install: added.

	* debian/libngraph0-dev.install: added (renamed from "ngraph-gtk-dev").

	* src/gtk/gtk_action.c (DataAddRecentFileAction_activated)
	(GraphRecentAction_activated): added.

	* src/gtk/x11menu.c (create_recent_filter, show_recent_dialog):
	added.
	(create_recent_menu): use "create_recent_filter()".

2014-08-26  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/gtk/x11menu.c (ActionWidget): add member "action".
	(ToolItem, MenuItem): add member "action_name".
	(add_addin_menu): added.
	(create_addin_menu): call "add_addin_menu()".
	(set_window_action_visibility): call "g_simple_action_set_enabled()".
	(clipboard_changed, unref_entry_history, get_subwindow_state):
	added.
	(save_entry_history): dont call "g_object_unref()".
	(toggle_view): added.
	(toggle_view_cb): use "toggle_view()".
	(set_toggle_action_widget_state): use "g_action_change_state()".
	(create_toolbar): call "gtk_actionable_set_action_name()".
	(create_menu_sub): initialize GActionMap.
	(create_toplevel_window): added.
	(application): use "create_toplevel_window()" and destroy
	"TopLevel" only when terminate signal is received.
	(script_exec, CmToggleSingleWindowMode): not static.
	(CmToggleSingleWindowMode): the variable "state" is given from the
	parameter "client_data" when the first parameter is NULL.

	* src/gtk/ox11menu.c (mx_get_accel_map): use GtkApplication if necessary.

	* src/gtk/x11view.c (ViewerWinClose): don't call "CloseGC()" and
	"CloseGRA()".
	(ViewerEvKeyDown): add case for "GDK_KEY_Return".

	* src/gtk/x11menu.h (NgraphApp): remove members "ghistory" and
	"fhistory", add member "recent_manager".

	* src/gtk/ox11menu.h (menulocal): remove member "ngpfilelist".

	* src/gtk/gtk_action.h: added.

	* src/gtk/gtk_action.c: added.

	* initfile/menus.ui: added.

2014-08-18  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/odata.c (getdata_skip_step): always return 0 when data
	source is "DATA_SOURCE_ARRAY" or "DATA_SOURCE_RANGE".
	(get_data_from_source): return 2 when remarked line.
	(getdata_sub1): call "getdata_sub2()" only when
	"get_data_from_source()" returns 0.
	(getdata2, getdataraw): continue loop when
	"get_data_from_source()" returns non zero.

2014-08-07  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* addin/fft.c (read_data): use "fgets()" and "sscanf()" instead of
	"fscanf()".

2014-07-31  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/gtk/x11menu.c (PlotAddMenu): add "recent data" menu item.
	(recent_filter): static function.
	(create_recent_menu): not static function.

	* src/gtk/x11file.c (add_menu_list): add "recent data" menu item.
	(file_setup_item): check source type.
	(FileDialogSetupItem): remove third parameter.
	(FileDialogSetupCommon): check source type.
	(RangeDialogSetup): renamed from "FuncDialogSetup()".
	(ArrayDialogClose, FuncDialogClose): removed.
	(FileDialog): always "0FileDialogClose" is used.
	(FileDefDialog): initialize "source" member.
	(draw_type_pixbuf, start_editing_type): don't check the "source"
	field.
	(create_type_color_combo_box): remove fifth parameter.

	* src/shell.c (gettok): second argument "len" is always
	initialized.

	* src/oplot.c (ERR_INVALID_RANGE): added.
	(f2ddata): add members "range_min", "range_max" and "range_div".
	(opendata): initialize members "range_min", "range_max" and
	"range_div".
	(put_func): don't use the variable "is_fuinc".
	(f2dinit): initialize fields "range_min", "range_max" and
	"range_div".
	(hskipdata, getdata_skip_step, get_data_from_source): handle case
	for "PLOT_SOURCE_RANGE".
	(get_func_prm, get_func_value, funcout): removed.
	(f2dcolumn_range): added.
	(f2dopendata, f2dgetdata, f2dopendataraw): don't check the
	"source" field.
	(f2dstat_range): added.
	(f2dstat): use "f2dstat_range()".
	(f2dboundings_func, save_data_func): removed.
	(solve_equation, calc_fit_equation, get_fit_parameter): don't
	check the "source" field.

2014-07-30  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* addin/fft.c (save_data): change numerical format of the output.

	* src/gtk/gtk_subwin.c (create_popup_menu_sub): add case for
	"POP_UP_MENU_ITEM_TYPE_RECENT_DATA".

	* src/gtk/x11commn.c (PlotFileArrayCB): removed.

	* src/odarray.c (darray_modified): added.
	(odarray): "darray_modified()" is called for the "@" field.

	* addin/fft.c (main, save_data, read_data): fix order of
	arguments.

2014-06-30  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/oplot.c (f2ddraw): call "GRAview()".

2014-06-08  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/oplot.c (open_array): check maximum value of the id.

	* src/gtk/x11commn.c (del_darray): added.
	(DeleteDrawable): call "del_darray()".
	(store_file, save_array, save_merge, save_plot): added.
	(SaveParent): use "save_plot()" and "save_merge()".

2014-06-05  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* debian/rules (XDG_RUNTIME_DIR): set environment variable
	(https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=750043).

2014-06-02  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/gtk/x11menu.h (obj_list_data): remove member "ev_button".

	* src/gtk/gtk_subwin.c (do_popup): "button" argument is always
	zero because this function is called from "button-release-event"
	or "key-press-event".

2014-05-27  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/oplot.c (f2dstat_file): add parameter "field".

2014-05-24  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/oplot.c (f2ddraw): add label "FinishDrawing" and use "goto"
	instead of "return 0".
	(f2dredraw): check "source" field.

	* src/gtk/x11file.c (copy_file_obj_field): ignore not only "file"
	but also "array" field.

2014-05-22  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/gtk/x11axis.c (Popup_list): add "_Add" sub menu.

	* src/gtk/x11file.c (popup_show_cb): check "source" field.

2014-05-21  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/gtk/x11merge.c (Popup_list): use "_Delete" instead of
	"_Close".

	* src/gtk/x11file.c (Popup_list): use "_Delete" instead of
	"_Close".

	* src/gtk/x11menu.c (create_recent_menu): call "g_signal_connect()".
	(create_toolbar): handle "TOOL_TYPE_RECENT_GRAPH" and
	"TOOL_TYPE_RECENT_GRAPH".
	(create_menu_sub): don't call "g_signal_connect()" for
	"GtkRecentChooserMenu".

	* src/gtk/x11merge.c (MergeWinState): use "tree_view_set_tooltip_column()".

	* src/gtk/x11lgnd.c (LegendWinState): use "tree_view_set_tooltip_column()".

	* src/gtk/x11file.c (FileWinState): use "tree_view_set_tooltip_column()".

	* src/gtk/x11axis.c (AxisWinState): use "tree_view_set_tooltip_column()".

	* src/gtk/gtk_liststore.c (tree_view_set_tooltip_column)
	(tree_view_set_tooltip_query_cb): added.

2014-05-14  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/oplot.c (save_data_func): don't check returned value of the
	function "math_equation_calculate()".

	* addin/fitrslt.c (loaddatalist): get and check "source" and
	"array" fields.

	* addin/text-in.nsc: use "plot" object and check "source" field.

	* addin/legend.nsc: use "plot" object and save "source" and
	"array" fields.

	* addin/legend.c (loaddatalist): get and check "source" and
	"array" fields.
	(set_parameter): set 3rd column based on "source" field.

	* addin/fitrslt.nsc: use "plot" object and save "source" and
	"array" fields.

	* addin/fft.nsc: use "plot" object.

	* addin/append.nsc: use "plot" object.

	* addin/Makefile.am (addins, pkglibexec_PROGRAMS): remove "calc"
	addin.

2014-05-13  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/oplot.c (file_fit_calc, file_fit_prm): use "plot" object.
	(add_file_prm): added.
	(opendata): check "src" and use "add_file_prm()".
	(f2dputmath): strip math string.
	(f2dinit): initialize "max", "min" and "div" field.
	(draw_fit): check "code->exp".
	(draw_fit): check "val.type" instead of the returned value of the
	function "math_equation_calculate()".
	(get_func_value): check "f2dlocal->codex[0]->exp" and
	"f2dlocal->codey[0]->exp".
	(funcout): initialize cnstant of the equation.
	(save_data_func): check "val.type", "f2dlocal->codex[0]->exp" and
	"f2dlocal->codey[0]->exp".
	(solve_equation): check "eq->exp".

	* src/ofit.c (fituser): check "var.type" instead of the returned
	value of the function "math_equation_calculate()".

	* src/math/math_equation.c (math_equation_calculate): check and
	initalize the parmetar "val".

	* src/gtk/x11file.c (add_menu_list): added.
	(move_tab_copy, mask_tab_copy): use "PlotFileArrayCB".
	(load_tab_setup_item): check "d->source".
	(load_tab_copy): use "PlotFileArrayCB".
	(load_tab_create, load_tab_set_value): check "d->source".
	(math_tab_copy): use "PlotFileArrayCB".
	(math_common_widgets_create): added.
	(math_tab_create): use "math_common_widgets_create()".
	(math_set_value_common): added.
	(math_tab_set_value): use "math_set_value_common()".
	(set_axis_combo_box, plot_axis_setup_item): added.
	(file_setup_item): use "plot_axis_setup_item()".
	(FileDialogSetupItem): check "d->source".
	(plot_tab_copy, file_settings_copy): use "PlotFileArrayCB".
	(FileDialogSetupCommon): use default width for the deta clumn
	entries.
	(CHECK_VISIBILITY_ARRAY): added.
	(set_headline_table_array): added.
	(update_table_visibility): check "d->source".
	(FileDialogSetup): change title of the dialog.
	(ArrayDialogSetup, FuncDialogSetupItem, FuncDialogSetup)
	(ArrayDialogClose, FuncDialogClose): added.
	(FileDialog): check "d->source".
	(CmFileHistory): use "data->dialog" instead of "&DlgFile".
	(CmFileNew): use "plot" object.
	(CmFileNew): use "data->dialog" instead of "&DlgFile".
	(CmFuncAdd): added.
	(CmFileOpen): use "plot" object.
	(update_file_obj_multi): use "data->dialog" instead of "&DlgFile".
	(CmFileUpdate): use "plot" object.
	(check_plot_obj_file): added.
	(CmFileEdit): use "plot" object, "PlotFileCB" and
	"check_plot_obj_file()".
	(CmOptionFileDef): use "plot" object.
	(get_plot_info_str): added.
	(file_list_set_val): use "get_plot_info_str()".
	(CmFileMath, GetDrawFiles, CmFileSaveData, select_type)
	(start_editing_type, FileWinState): use "plot" object.

2014-05-12  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/gtk/x11menu.c (create_toolbar): add 3rd parameter.
	(check_instance): use "plot" object.
	(PlotAddMenu): added.

	* src/gtk/x11dialg.h (FileDialog): add members "min", "max, "div"
	and "sourece".

	* src/gtk/x11dialg.c: add "DlgFunc" and "DlgArray".

	* src/gtk/x11commn.c (AxisDel2, AxisMove, FitClear)
	(DeleteDrawable, SaveParent, get_save_opt, FileAutoScale)
	(SetFileHidden): use "plot" object.
	(field_obj_del, get_plot_cb_str, ArrayDel, PlotFileCB)
	(PlotFileArrayCB): added.
	(FileCB): use "get_plot_cb_str()".
	(FitDel): use "field_obj_del()".

	* src/gtk/x11view.c (ViewerWinFileUpdate, Evaluate)
	(mouse_down_move_data, data_dropped): use "plot" object.
	(ViewerWinSetup): call "gtk_menu_attach_to_widget()".

	* src/gtk/x11opt.c (CmOptionSaveNgp): use "plot" object.

	* src/gtk/gtk_subwin.c (create_popup_menu_sub): added.
	(sub_win_create_popup_menu): use "create_popup_menu_sub()".

2014-05-11  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/shell.c (shprintfstdout, shprintfstderr): type of the first
	parameter is "const char *".

	* src/ogra.c (set_progress_val): type of the last parameter is
	"const char *".

	* src/object.c (vnprintf, seprintf): type of the first parameter
	is "const char *".
	(registerevloop): type of the first and second parameters are
	"const char *".

	* src/ngraph_api.c (ngraph_get_object_alias): added.

	* src/gtk/ox11menu.c (mgtkprintfstdout, mgtkprintfstderr): type of
	the first parameter is "const char *".

	* src/gtk/init.c (printfconsole): type of the first parameter is
	"const char *".

	* src/gra.c (_GRAopen, GRAopen, GRAaddlist, GRAinslist): type of
	some parameters are "const char *".

	* plugins/ruby/create_objs.rb (NgraphObj): now "alias" name can be
	used as an object.

	* src/gtk/x11axis.c (AxisDialogFile, file_button_show): use "plot"
	object.

2014-05-03  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/oaxis.c (get_reference_parameter): keep original axis type
	when the typeboth axis are linear or MJD.

2014-05-01  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/oaxis.c (calc_numbering_value, get_axis_math)
	(alloc_axis_math, free_axis_math, num_put_math): added.
	(numformat): use "calc_numbering_value()".
	(axisdraw, axis_get_numbering): use "alloc_axis_math()" and
	"free_axis_math()".
	(axis): add field "num_math".
	(axisdraw): don't call "get_axis_parameter()" twice when
	"aconf.code" is not NULL.

	* src/gtk/x11axis.c (Alist): add "num_math" column.
	(numbering_tab_set_value): save "num_math"field.
	(numbering_tab_setup_item): setup "num_math".
	(numbering_tab_create): add widget to set "num_math" field.
	(axis_list_set_val): set style depend on "num_math" field.
	(AxisWinState): min, max and inc column refer "num_math" column as
	the font style.

	* src/gtk/x11file.c (FileWinState): use "set_cell_attribute_source()".
	(set_source_attribute): removed.

	* src/gtk/gtk_subwin.c (set_cell_attribute_source): added.

2014-04-25  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* addin/spellchecker.rb: add "About" button.

2014-04-23  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* addin/spellchecker.rb: usr "Ruby/GTK3" if available.

2014-04-22  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* initfile/20append_addins_ruby.nsc: added.

	* initfile/Makefile.am (init_scripts): install "20append_addins_ruby.nsc".

	* src/osystem.c (get_basename): renemed from "get_plugin_name()".
	(get_plugin_name): added.
	(load_plugin_sub): use "get_plugin_name()".
	(system_plugin_check): added.
	(nsystem): add field "plugin_check".

	* addin/Makefile.am (ruby_addins): added.

	* addin/legend.c (main): change order of buttons.

	* addin/fitrslt.c (main): change order of buttons.
	(my_create_spin_button): use "gtk_widget_set_margin_end()" when
	the version of GTK+ is greater or equal to 3.12.

	* addin/calc.c (main): change order of buttons.

2014-04-19  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* addin/spell_check.rb: handle "LoadError".

2014-04-18  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/gtk/x11opt.c (MiscDialogSetupItem, MiscDialogSetup)
	(MiscDialogClose): don't use "Menulocal.browser" when ter version
	of GTK+ is greater or equal to "3.0.0".

	* src/gtk/x11gui.c (message_box): change order ob buttons in the
	case of "RESPONS_YESNOCANCEL".

	* debian/ruby-ngraph.install: install "usr/lib/*/ruby/*".

2014-04-16  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/gtk/x11lgnd.c (Tlist): add "bgcolor" column.
	(text_list_set_val, LegendWinState): set background color of the
	text column.

	* src/gtk/gtk_common.h (USE_HEADER_BAR): added.

2014-04-15  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/gtk/x11opt.c (MiscDialogSetup, ExViewerDialogSetup)
	(ViewerDialogSetup): use "GTK_RESPONSE_CANCEL" instead of
	"IDCANCEL".

	* src/gtk/x11gui.c (DialogExecute): use
	"gtk_dialog_new_with_buttons()" instead of "gtk_dialog_new()".
	(DialogInput, DialogRadio, DialogCombo, DialogComboEntry)
	(DialogSpinEntry, DialogCheck): add "GTK_DIALOG_USE_HEADER_BAR"
	flag.

2014-04-10  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/gtk/x11menu.c (create_toolbar, create_menu_sub): use
	"create_image_from_file()".

	* src/gtk/x11lgnd.c (LegendWinState): use "create_image_from_file()".

	* src/gtk/gtk_widget.c (create_image_from_file): added.

2014-04-04  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/gtk/x11file.c (MarkDialogSetup): use
	"gtk_widget_set_margin_start()" and "gtk_widget_set_margin_end()"
	when the version of GTK+ is greater or equal to 3.12.

	* src/gtk/gtk_widget.c (set_widget_margin): use
	"gtk_widget_set_margin_start()" and "gtk_widget_set_margin_end()"
	when the version of GTK+ is greater or equal to 3.12.

	* plugins/Makefile.am (RUBY_ARCH_INCLUDEDIR): added.

2014-04-03  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/gtk/x11lgnd.c (LegendWinState): show "text::text" field as a
	tool-tip.

	* src/gtk/x11file.c (FileWinState, file_list_set_val): show
	"file::file" field as a tool-tip.

	* src/gtk/x11view.c (AlignFocusedObj): swap "VIEW_ALIGN_HCENTER"
	and "VIEW_ALIGN_VCENTER".
	(ViewerEvLButtonDblClk, ViewerEvKeyDown): use "set_pointer_mode()"
	instead of "gtk_radio_action_set_current_value()".

	* src/gtk/x11merge.c (MergeWinState): renamed from "CmMergeWindow".

	* src/gtk/x11menu.c (set_pointer_mode, init_action_widget_list)
	(set_action_widget_sensitivity, set_subwin_state)
	(set_toggle_action_widget_state, create_toolbar)
	(create_menu_sub, create_menu, create_popup, toggle_subwindow)
	(set_subwindow_state): added.
	(CmViewerButtonArm): moved from "x11view.c".
	(set_axis_undo_button_sensitivity): use
	"set_action_widget_sensitivity()".
	(create_addin_menu): don't use "gtk_ui_manager_get_widget()".
	(set_action_sensitivity): removed.
	(set_focus_sensitivity_sub, set_window_action_visibility): don't
	use "GtkAction".
	(multi_to_single, destroy_sub_windows): call
	"set_subwindow_state()" instead of "window_action_set_active()".
	(setupwindow): don't use "GTkUIManager".
	(init_ngraph_app_struct): initialize member valiables
	"action_widget_id" and "state_func".
	(create_sub_windows): use "set_subwindow_state()".
	(set_modified_state): use set_action_widget_sensitivity()".
	(toggle_view_cb): inhibit recursive call.
	(set_widget_visibility): use "set_toggle_action_widget_state()".
	(check_instance): use "set_action_widget_sensitivity()".
	(application): don't use "GTkUIManager" and "GtkAction".
	(CmReloadWindowConfig): use "set_subwindow_state()" instead of
	"window_action_set_active()".
	(CmToggleSingleWindowMode): use "gtk_check_menu_item_get_active()"
	instead of "gtk_toggle_tool_button_get_active()".

	* src/gtk/x11lgnd.c (LegendWinState): renamed from "CmLegendWindow".

	* src/gtk/x11info.c (InfoWinState): renamed from "CmInformationWindow".

	* src/gtk/x11file.c (FileWinState): renamed from "CmFileWindow".

	* src/gtk/x11cood.c (CoordWinState): renamed from "CmCoordinateWindow".

	* src/gtk/x11axis.c (AxisWinState): renamed from "CmAxisWindow".

	* src/gtk/ox11menu.c (mx_show_win, mx_hide_win, mx_toggle_win):
	call "set_subwindow_state()" instead of
	"window_action_set_active()".
	(mx_get_ui): removed.
	(gtkmenu): remove field "get_ui".

	* src/gtk/init.c (n_initialize): use "rl_completion_func_t *"
	instead of "CPPFunction *".

	* src/gtk/gtk_subwin.c (sub_window_hide, sub_window_show): set
	"visible" member variable and call
	"set_toggle_action_widget_state()".
	(cb_del, ev_sub_win_key_down): call "set_subwindow_state()"
	instead of "window_action_set_active()".

2014-04-02  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/gtk/x11menu.c (create_ui_from_file, set_toolbar_caption)
	(set_btn_press_cb, get_toolbar, create_action_group)
	(create_action_widget, init_action_widget_list): removed.

2014-04-01  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/gtk/x11menu.c (window_action_toggle)
	(window_action_set_active, set_toggle_action): removed.

2014-03-27  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/gtk/x11menu.c (set_gdk_color): removed.

2014-03-01  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/gtk/gtk_widget.h (NUM_ENTRY_WIDTH): change width from 11 to
	12.

	* src/gtk/x11axis.c (font_tab_create): use
	"gtk_check_button_new_with_mnemonic()" instead of
	"gtk_check_button_new_with_label()".

2014-02-28  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/gtk/x11view.c (EvalDialogSetup): use
	"gtk_check_button_new_with_mnemonic()" and "set_button_icon()"
	instead of "gtk_button_new_from_stock()".
	(EvalDialogSetup): don't use "GtkStockItem".

	* src/gtk/x11opt_proto.h (CREATE_NAME): use
	"gtk_check_button_new_with_mnemonic()" and "set_button_icon()"
	instead of "gtk_button_new_from_stock()".
	(CREATE_NAME): don't use "GtkStockItem".

	* src/gtk/x11opt.c (PrefScriptDialogSetup)
	(PrefDriverDialogSetup, PrefFontDialogSetup, MiscDialogSetup)
	(ExViewerDialogSetup, ViewerDialogSetup): don't use
	"GtkStockItem".
	(FontSettingDialogSetup): use
	"gtk_check_button_new_with_mnemonic()" and "set_button_icon()"
	instead of "gtk_button_new_from_stock()".

	* src/gtk/x11merge.c (Popup_list): don't use "GtkStockItem".

	* src/gtk/x11menu.c (ActionEntry): don't use "GtkStockItem".
	(create_action_group): use "gtk_action_set_icon_name()";

	* src/gtk/x11lgnd.c (Popup_list): don't use "GtkStockItem".
	(points_setup, legend_dialog_setup_sub): use
	"gtk_check_button_new_with_mnemonic()" and "set_button_icon()"
	instead of "gtk_button_new_from_stock()".
	(LegendTextDialogSetup, LegendArrowDialogSetup)
	(LegendRectDialogSetup, LegendArcDialogSetup)
	(LegendMarkDialogSetup): don't use "GtkStockItem".

	* src/gtk/x11gui.c (DialogExecute, message_box, DialogInput)
	(DialogRadio, DialogCombo, DialogComboEntry, DialogSpinEntry)
	(DialogCheck, nGetOpenFileNameMulti, nGetSaveFileName): don't use
	"GtkStockItem".

	* src/gtk/x11graph.c (SwitchDialogSetup): use
	"gtk_check_button_new_with_mnemonic()" and "set_button_icon()"
	instead of "gtk_button_new_from_stock()".

	* src/gtk/x11file.c (Popup_list): don't use "GtkStockItem."
	(MathDialogSetup, FitDialogSetup)
	(move_tab_create,mask_tab_create): use
	"gtk_check_button_new_with_mnemonic()" and "set_button_icon()"
	instead of "gtk_button_new_from_stock()".
	(MathDialogSetup, FitSaveDialogSetup, FitDialogSetup): don't use
	"GtkStockItem".

	* src/gtk/x11dialg.c (SelectDialogSetup): use
	"gtk_check_button_new_with_mnemonic()" and "set_button_icon()"
	instead of "gtk_button_new_from_stock()".

	* src/gtk/x11commn.c (ProgressDialogCreate): use
	"gtk_check_button_new_with_mnemonic()" and "set_button_icon()"
	instead of "gtk_button_new_from_stock()".

	* src/gtk/x11axis.c (Popup_list): don't use "GtkStockItem".
	(scale_tab_create): use "gtk_button_new_with_mnemonic()" instead
	of "gtk_button_new_from_stock()".
	(font_tab_create): use "gtk_check_button_new_with_mnemonic()" and
	"set_button_icon()" instead of "gtk_check_button_new_with_label()"
	and "gtk_button_set_use_stock()".

	* src/gtk/gtk_widget.c (set_button_icon): added.
	(create_file_entry_with_cb, create_direction_entry): use
	"gtk_entry_set_icon_from_icon_name()" instead of
	"gtk_entry_set_icon_from_stock()".

	* src/gtk/gtk_subwin.h (subwin_popup_list): remove member
	"use_stock".

	* src/gtk/gtk_subwin.c (start_editing): use
	"gtk_entry_set_icon_from_icon_name()" instead of
	"gtk_entry_set_icon_from_stock()".
	(sub_win_create_popup_menu): use
	"gtk_menu_item_new_with_mnemonic()" instead of
	"gtk_image_menu_item_new_from_stock()".

	* initfile/NgraphUI.xml: remove preview tool button.

	* initfile/Ngraph.ini.in (browser): don't use "yelp".

	* addin/legend.c (main): don't use "GtkStockItem".

	* addin/fitrslt.c (main): don't use "GtkStockItem".

	* addin/calc.c (main): don't use "GtkStockItem".

2014-02-25  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/gtk/x11menu.c (single_to_multi): set
	"Menulocal.single_window_mode" true before call
	"CmReloadWindowConfig()".

	* src/gtk/gtk_subwin.c (sub_window_set_visibility): check
	"Menulocal.single_window_mode".

2014-02-15  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* plugins/Makefile.am (libruby_ldflags): don't link aginst libngraph.

	* configure.ac: use "AC_CHECK_LIB" to check libm.

2014-02-14  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/gtk/x11file.c (file_list_set_val)
	(create_type_color_combo_box, select_type, select_axis): support
	sourece type.
	(set_source_attribute): added.

2014-02-13  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* doc/html/ja/text.html: update document.

	* src/gtk/x11file.c (draw_type_pixbuf, file_list_set_val): support
	sourece type "function" and "array".

	* src/oplot.c (set_array): added.
	(open_array): return non zero when failed.
	(ERR_INVALID_OBJ): added.

	* src/gra.c (GRAdrawtext, GRAtextextent): add space between the
	lines setting.

2014-02-11  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/oplot.h: added.

	* src/oplot.c: added.

	* src/gtk/x11view.c (ViewerEvLButtonUp): call
	"gtk_widget_queue_draw()".

2014-02-02  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/odarray.c (calc_sum, calc_square_sum): removed.
	(cache_data): added.
	(darray_sum, darray_average, darray_rms, darray_sdev)
	(darray_min, darray_max): use "cache_data()".

2014-02-01  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/object.c (obj_do_tighten_all): added.

2014-01-28  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* addin/fft.c (save_data, read_data): added.
	(main): use "save_data()" and "read_data()".
	(MAXP): changed from 16 to 24.

2013-12-15  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* addin/legend.c (create_geometry_frame): use
	"create_spin_button()".

	* addin/fitrslt.c (my_create_spin_button, create_position_frame):
	use "create_spin_button()".

	* addin/addin_common.c (create_spin_button): added.
	(create_font_frame): use "create_spin_button()".

2013-12-07  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* plugins/ruby/ngraph.c (load_script): use File#expand_path to get
	full path name of the script.

	* plugins/ruby.c (ngraph_plugin_open_ruby): check returned value
	of th function "rb_require()".

2013-12-01  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* plugins/ruby/lib/ngraph/ngp2.rb: added.

2013-11-29  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* plugins/ruby/create_objs.rb: don't add '?' to some methods.

	* plugins/ruby.c (ngraph_plugin_exec_ruby): removed.

	* src/osystem.h: added.

	* src/osarray.c (sarrayerrorlist): bug fix: add ',' as the needed.

	* src/osystem.c (syserrorlist): bug fix: add ',' as the needed.
	(close_module, get_symbol, get_plugin_name, load_plugin_sub)
	(get_plugin_from_name, load_plugin, system_plugin_load)
	(free_argv, allocate_argv, system_plugin_exec)
	(system_plugin_get_module): added (moved from "oplugin.c").
	(sysdone): unload modules.

	* src/oplugin.c: removed.

	* plugins/ruby/ngraph.c (load_script): added.
	(ruby_ngraph_init): the function "ngraph_set_exec_func()" is
	always called.

2013-11-28  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/osystem.c (ext_shell_exec, system_check_prohibited_plugin)
	(system_set_ext_shell): added.
	(nsystem): add fields "ext_shell", "ext_shell_name" and
	"prohibited_plugin".
	(addsystem): initialize "ProhibitedPlugins".

	* src/oplugin.c (load_plugin): check prohibited plugins.

	* src/ngraph_api.c (ngraph_set_exec_func): added.

	* plugins/ruby/ngraph.c (ruby_ngraph_exec_loginshell): use
	"ALLOCA_N()" and "strcpy()" instead of "strdup()".
	(ruby_ngraph_init): add 3rd parameter and call
	"ngraph_set_ext_shell()" ic necessary.

2013-11-27  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* plugins/ruby/ngraph.c (ruby_ngraph_init): set "Initialized".
	(Init_ngraph): check "Initialized".

	* src/ngraph_api.c (ngraph_exec_loginshell): return returned valu
	of the function "exeobj()" or "sexeobj()".

	* plugins/ruby/ngraph.c (ruby_ngraph_exec_loginshell)
	(ruby_ngraph_init_file): added.
	(Init_ngraph): add singleton methods "get_initialize_file" and
	"execute_loginshell".

2013-11-26  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* plugins/ruby/ngraph.c (ruby_ngraph_init): added.
	(Init_ngraph): add singleton method "ngraph_initialize".

	* plugins/ruby/extconf.rb: check first argument.

	* plugins/ruby/Makefile.am (ruby_ext): use "RUBY_DLEXT."

	* debian/ruby-ngraph.install: added.

	* debian/control (Package): add ruby-ngraph package.

	* configure.ac: set "RUBY_DLEXT".

	* plugins/ruby/lib/ngraph.rb.win: added.

	* plugins/ruby/lib/ngraph.rb: added.

	* plugins/ruby/lib/Makefile.am: added.

2013-11-25  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* plugins/ruby.c: many functions are moved to
	"plugins/ruby/ngraph.c".
	(get_ext_name): added.
	(ngraph_plugin_exec_ruby): use "get_ext_name()" on Windows.

	* plugins/ruby/ngraph.c: added.

	* plugins/ruby/getobj.nsc: moved from "plugins/".

	* plugins/ruby/extconf.rb: added.

	* plugins/ruby/create_objs.rb: moved from "plugins/".

	* plugins/ruby/Makefile.am: added.

2013-11-24  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/ngraph_api.c (ngraph_save_shell_history): added.

	* src/gtk/init.c (n_save_shell_history): added.
	(n_finalize): use "n_save_shell_history()".
	(n_initialize): check already initialized or not.

	* plugins/ruby.c (ngraph_save_hist): added.
	(ngraph_plugin_open_ruby): add singleton method
	"save_shell_history".

2013-11-23  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* Makefile.am (AM_CFLAGS): added.

	* src/shell.c (cmdexec, system_bg): use "g_thread_new()" instead
	of "g_thread_create()" when the version of glib is greater or
	equal to 2.32.

2013-11-22  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/gtk/Makefile.am (libngraphui_la_LDFLAGS): removed.

	* src/math/Makefile.am (libmath_la_LDFLAGS): removed.

2013-11-21  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/oplugin.c (ngraph_plugin_set_user_data)
	(ngraph_plugin_get_user_data): removed.

	* src/gtk/x11view.c (create_axis, ViewCopyAxis): use
	"g_strdup_printf()".

	* src/gtk/x11commn.c (axis_move_each_obj): use
	"g_strdup_printf()".

	* src/gtk/x11axis.c (SectionDialogGrid, CmAxisNewSection): use
	"g_strdup_printf()".

	* src/gtk/ox11menu.c (add_str_with_int_to_array)
	(add_child_geometry_to_array, add_geometry_to_array)
	(add_color_to_array): use "g_strdup_printf()".

	* src/gtk/init.c (my_sprintf): removed.
	(get_file_list): use "g_strdup_printf()".

	* plugins/ruby.c (str2inst_ensure, obj_del_from_str)
	(inst_get_obj, inst_put_obj): use "ngraph_free()".
	(obj_get): don't use "ngraph_object_free()".

	* src/main.c: added.

	* src/ngraph_api.c: added.

	* src/ntime.c (ndate, ntime): use "g_strdup_printf()".

	* src/oaxis.c (axisinit, axisdone, set_group, axis_default_set):
	use "g_strdup_printf()".

	* src/object.c (getvaluestr): add case for "NVOID", "NPOINTER" and
	"NVFUNC".

	* src/odraw.c: include "mathfn.h".

	* src/oplugin.c: api functions are moved to "ngraph_api.c".

	* src/oroot.c (obj_save_config_numeric, obj_save_config_string):
	use "g_strdup_printf()".

	* src/math/math_basic_function.c (math_func_fmod): remove unused
	variables.

	* debian/ngraph-gtk.install: install "libngraph".

	* mingw/windows.sh: now some processes are automatically done.

	* src/gtk/init.c: added (renamed from main.c).

	* src/gtk/init.h: added (renamed from main.h).

	* configure.ac: add "LIBNGRAPH_VERSION" and "AC_CANONICAL_HOST",
	check OS type.

	* acinclude.m4: remove macro.

	* Makefile.am (libtool): added.

	* test/: now "del system" is not necessary to end interpreter.

2013-11-20  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* plugins/libruby.def: moved from "mingw/"

	* plugins/libruby_resource.rc: added

	* src/ngraph_resource.rc: moved from "mingw/windows_resource.rc".

	* src/libngraph_resource.rc: added.

2013-11-15  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* mingw/windows.sh (DEFS): define "_USE_32BIT_TIME_T".

	* src/gtk/x11gui.c (fsok): use "GStatBuf" instead of "struct
	stat".

	* src/omerge.c (mergetime, mergedate): use "GStatBuf" instead of
	"struct stat".
	(mergestore, mergestoredum): use default date and time if the date
	and time are not available.

	* src/shellux.c (testexpand): use "GStatBuf" instead of "struct
	stat".

	* src/ofile.c (f2dtime, f2ddate, get_mtime): use "GStatBuf"
	instead of "struct stat".
	(f2dstat, f2dstat2): use "g_strdup_printf()" instead of
	"snprintf()".
	(f2dstore, f2dstoredum): use default date and time if the date and
	time are not available.

	* src/nconfig.c (openconfig, writecheckconfig, copyconfig): use
	"GStatBuf" instead of "struct stat".

	* src/ioutil.c (getfilename, findfilename): type of all parameters
	are "cost char *".
	(findfilename): use "GStatBuf" instead of "struct stat".
	(nstat): type of the second parameter is "GStatBuf *".

	* acinclude.m4: save "CFLAGS".

2013-11-11  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/otext.c (text): add field "hsb".

	* src/orect.c (rect): add fields "fill_hsb" and "stroke_hsb".

	* src/opath.c (arrow): add fields "fill_hsb" and "stroke_hsb".

	* src/omark.c (mark): add fields "hsb" and "hsb2".

	* src/ofile.c (file2d): add fields "hsb" and "hsb2".

	* src/odraw.c (put_hsb_color, put_fill_hsb, put_stroke_hsb)
	(put_hsb, put_hsb2): added.

	* src/oaxis.c (put_gauge_hsb, put_num_hsb): added.
	(axis): add fields "gauge_hsb", "num_hsb" and "hsb".

	* src/oarc.c (arc): add fields "fill_hsb" and "stroke_hsb".

	* src/oagrid.c (agrid): add field "hsb".

	* src/math/math_basic_function.c (math_func_fmod): added.

2013-11-10  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11axis.c (gauge_tab_create): use
	"gtk_entry_set_width_chars()".

	* src/gtk/gtk_widget.c (create_direction_entry)
	(create_text_entry, _create_spin_entry):use
	"gtk_entry_set_width_chars()".

	* src/gtk/x11lgnd.c (style_setup): use
	"combo_box_entry_set_width()".

	* src/gtk/x11file.c (FitSaveDialogSetup, plot_tab_create)
	(FileDialogSetupCommon): use "combo_box_entry_set_width()".

	* src/gtk/x11axis.c (scale_tab_create, position_tab_create): use
	"combo_box_entry_set_width()".

	* src/gtk/gtk_combo.c (combo_box_entry_set_width): added.

2013-11-06  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/oplugin.c (ngraph_get_obj_field_type): type of the returned
	value is "enum ngraph_object_field_type".
	(ngraph_putobj): free allocated string when the returned value of
	the function "putobj()" is negative.

	* src/ngraph.h (ngraph_object_field_type): added.

2013-11-05  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/ogra2x11.c (gtkclose): always returns "TRUE".

2013-11-02  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/oplugin.c (get_plugin_name, get_plugin_from_name): added.
	(load_plugin, plugin_open): use "get_plugin_name()".
	(get_plugin, plugin_open): use "get_plugin_from_name()".

2013-11-01  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/math/math_basic_function.c (math_func_dif): returned value
	is 0 if the type of saved value is not "MATH_VALUE_NORMAL".

2013-10-30  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* plugins/ruby.c (ngraph_plugin_open_ruby): set default encodings
	and require some libraries.

	* plugins/create_objs.rb (NgraphObj#create_str_func_with_args)
	(NgraphObj#create_str_func_with_argv)
	(NgraphObj#add_str_array_func): use "tainted_utf8_str_new()".

	* plugins/ruby.c (tainted_utf8_str_new): added.
	(inst_get_str, inst_get_sarray, obj_func_obj, get_str_func_argv):
	use "tainted_utf8_str_new()".

2013-10-29  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* configure.ac: use "AC_SEARCH_LIBS" instead of "AC_CHECK_LIB" to
	find math functions in "AC_CHECK_FUNCS".

2013-10-28  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* configure.ac: check linker option.

	* acinclude.m4: added.

2013-10-27  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* plugins/create_objs.rb (NgraphObj#create_str_func_with_argv):
	use "create_val_func_with_argv()".

2013-10-26  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/oplugin.c (Plugin): remove field "_local" and add field
	"lock".

	* src/Makefile.am (ngraph_LDFLAGS): added.

	* src/ngraph_export.map: added.

2013-10-25  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/ogra2emf.c (check_fonts): use "EnumFontFamiliesEx()"
	instead of "EnumFontFamiliesExW()" befcase the program is crashed
	when call "EnumFontFamiliesExW()" on Windows8 64bit.

	* mingw/windows.sh: create ruby plugin.

	* mingw/libruby.def: added.

2013-10-23  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/Makefile.am (noinst_LTLIBRARIES): use convenience library.

	* plugins/ruby.c (ngraph_plugin_exec_ruby): check "argc".

2013-10-21  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* mingw/windows_make.sed: change "$(pkglibdir)".

	* configure.ac: add "AC_LIBTOOL_WIN32_DLL".

2013-10-19  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* plugins/ruby.c (ngraph_plugin_exec_ruby): check error string.

2013-10-19  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* plugins/ruby.c (get_array_arg): added.
	(allocate_iarray, allocate_darray, allocate_sarray): use
	"get_array_arg()".

2013-10-16  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/oplugin.c (load_plugin): check interrupt function.
	(plugin_done): call interrupt function when the plugin is locked.

	* plugins/ruby.c (obj_get_from_str, obj_del_from_str): use
	"rb_sprintf()".
	(ngraph_plugin_exec_ruby): show detail information aobut the
	error.
	(ngraph_plugin_interrupt_ruby): added.

	* src/gtk/ogra2x11.c (gra2gtk): argument of the "fullscreen" field
	is boolean.

2013-10-15  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/ngraph_plugin.h: renamed to "ngraph.h".

	* src/ngraph.h: definitions are moved to "common.h".

	* plugins/ruby.c (obj_del_from_str): added.

2013-10-11  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/oplugin.c (ngraph_plugin_copy): added.

	* plugins/ruby.c (ngraph_inst_method_copy, obj_copy): added.
	(ngraph_plugin_open_ruby): call "ruby_sysinit()" and
	"rb_enc_find_index()".

2013-10-10  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/oplugin.c (allocate_iarray, allocate_darray)
	(allocate_sarray): check if the "arg" is NULL or not.
	(ngraph_plugin_get_instances_by_str, ngraph_plugin_sleep)
	(ngraph_plugin_get_obj_root): added.
	(ngraph_plugin_get_inst): removed.

	* test/sarray_test.nsc: add test for "put" and "ins" fields.

	* addin/timer.nsc: fix name of text object and field name of color
	of rectanble object.

	* addin/text-in.nsc: fix horizontal alignment.

	* addin/fig2gra.rb (Fig2Gra): added.

	* src/shellux.c (cmsleep): use "nsleep()".

	* src/shell.c (nsleep, cmsleeptimeout, SleepThread): added.

	* src/object.c (arrayadd, arrayins, arrayput): type of the second
	parameter is "const void *".
	(arrayadd2, arrayins2, arrayput2): type of the second parameter is
	"const char *".

2013-10-06  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/oplugin.c (Plugin): type of the fields "open" and "exec" are
	NIFUNC.

2013-10-05  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/osystem.c (nsystem): add field "plugin_dir".

	* src/oplugin.c (plugin_file, plugin_name): added.
	(plugin_open): check multiple loading.

	* src/gtk/ox11menu.c (menuinit): check "OpenApplication()" first.

	* src/gtk/main.c (set_dir_defs, main): initialize "PLUGINDIR"
	settings.

	* src/gtk/dir_defs.h.in: add "PLUGINDIR" definition.

	* plugins/ruby.c (ngraph_plugin_close_ruby): 0
	(ngraph_plugin_open_ruby): added.
	(ngraph_plugin_exec_ruby): change name.

	* plugins/create_objs.rb (NgraphObj): add instants variable
	"singleton".

	* pathconv.sh (LIBDIR): add "LIBDIR" definition.

2013-10-04  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* plugins/Makefile.am (ngraphplugindir): change install directory.

	* initfile/Ngraph.nsc: check "${NGRAPHCONF}/init.d".

	* initfile/10append_addins.nsc: mobed from "Ngraph.nsc".

2013-09-25  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/gtk/ox11dlg.c: include "mathfn.h".

2013-09-24  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/gtk/ox11menu.c (mx_show_lib_version): the first argument of
	the field means indent width.

2013-09-20  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* plugins/Makefile.am: check develop environment of Ruby.

	* initfile/save_ui_file.nsc: use "get" commend to get
	informations.

	* initfile/Ngraph.nsc (NULL_DEVICE): use "get" commend to show
	version of the libraries.

	* configure.ac: call LT_INIT, check develop environment of Ruby.

	* src/plugins.c (plugin_shell_exec): check security.
	(ngraph_plugin_shell_err_puts, ngraph_plugin_shell_puts)
	(ngraph_plugin_shell_get_inst): added.

	* src/otext.c (test): type of argument of the field "save_config"
	is "void".

	* src/osystem.c (nsystem): type of argument of the field
	"temp_file" is "void".

	* src/ostring.c (ostring): type of argument of some fields are
	"void".

	* src/osarray.c (osarray): type of argument of some fields are
	"void".

	* src/oregexp.c (oregexp): type of argument of some fields are
	"void".

	* src/oprm.c (prm): type of argument of the field "load" is
	"void".

	* src/omerge.c (merge): type of argument of some fields are
	"void".

	* src/omath.c (math): type of argument of the field "clear" is
	"void".

	* src/oiarray.c (oiarray): type of argument of some fields are
	"void".

	* src/ofile.c (file2d): type of argument of some fields are
	"void".

	* src/odarray.c (odarray): type of argument of some fields are
	"void".

	* src/oaxis.c (draw_numbering, numbering): type of the last
	parameter is "struct narray *".
	(draw_numbering): use "g_strdup_printf()" when the parameter
	"array" is not NULL.
	(axis_get_numbering): type of field is "NSAFUNC".
	(axis): type of the argument of fields "scale_push", "scale_pop",
	"clear", "adjust", "tight", "group_manager" and "get_numbering"
	are "void".

	* src/oagrid.c (agrid): type of "tight" field is "void (void)".

	* src/gtk/x11menu.c (get_ui_definition): name is changed from
	"show_ui_definition()".

	* src/gtk/x11gui.c (DialogInput, DialogRadio, DialogCombo)
	(DialogComboEntry, DialogSpinEntry, DialogCheck): chang order of
	buttons.

	* src/gtk/ox11menu.c (mx_get_ui, mx_get_accel_map)
	(mx_show_lib_version, mx_get_locale): type of the fields is
	changed from "NVFUNC" to "NSFUNC".
	(mx_get_active): added.
	(gtkmenu): add "active" field, change type of some fields from
	"NVFUNC" to "NSFUNC".

2013-09-18  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/gtk/ox11dlg.c (dlgspin): fix case for "double_entry".
	(dialog): type of "double_entry" and "integer_entry" is "NDFUNC"
	and "NIFUNC" respectively.

2013-09-16  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/plugins.c (ngraph_plugin_shell_exeobj): check type of the
	field.

	* src/shellcm.c (dispfield): the macro "NLABEL" is not used.

	* src/object.c (addobject, _putobj, putobj, _getobj, getobj)
	(copyobj): the macro "NLABEL" is not used.

	* src/object.h: macro for field type and permission definitions
	are moved to the file "ngraph_plugin_shell.h".

2013-09-14  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* plugins/: added.

	* src/shellcm.c (dispfield): fix representation of "char*" and
	"void*".

2013-08-28  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/ofile.c (f2dstore, f2dstoredum): bug fix: use
	"g_strdup_printf()" instead of "g_malloc()" and "sprintf()".

	* src/omerge.c (mergestore, mergestoredum): bug fix: use
	"g_strdup_printf()" instead of "g_malloc()" and "sprintf()".

2013-07-26  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/object.c (chkobjarglist): type of the returned value "const
	char *".
	(getargument, freeargument): type of second parameter is "const
	char *".

2013-07-25  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/plugins.h: added (experimental).

	* src/plugins.c: added (experimental).

	* src/shell.c (get_security): added.
	(cmdtable): add "load_plugin" command.

2013-07-24  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11merge.c (MergeDialogSetup): call
	"gtk_widget_show_all()".

	* src/gtk/x11axis.c (GridDialogSetup, SectionDialogSetup)
	(CrossDialogSetup, ZoomDialogSetup, AxisDialogSetup): call
	"gtk_widget_show_all()".

	* src/gtk/gtk_widget.c (set_widget_visibility_with_label): added.
	(set_scroll_visibility): use "gtk_widget_set_visible()" instead of
	"gtk_widget_show()" and "gtk_widget_hide()".

	* src/gtk/x11print.c (DriverDialogSetup, OutputDataDialogSetup)
	(OutputImageDialogSetup): call "gtk_widget_show_all()".
	(OutputImageDialogSetupItem): hide unused widgets and reset window
	size.

	* src/gtk/x11lgnd.c (LegendArrowDialogSetup)
	(LegendRectDialogSetup, LegendArcDialogSetup)
	(LegendMarkDialogSetup, LegendTextDialogSetup)
	(LegendTextDefDialogSetup): call "gtk_widget_show_all()".

	* src/gtk/x11menu.c (toggle_view_cb): use
	"gtk_widget_set_visible()" instead of "gtk_widget_show()" and
	"gtk_widget_hide()".
	(InputYN): use "get_current_window()".

	* src/gtk/x11graph.c (PageDialogSetup, SwitchDialogSetup)
	(DirectoryDialogSetup, LoadDialogSetup, PrmDialogSetup)
	(SaveDialogSetup): call "gtk_widget_show_all()".

	* src/gtk/x11lgndx.c (LegendGaussDialogSetup): call
	"gtk_widget_show_all()".

	* src/gtk/x11dialg.c (SelectDialogSetup, CopyDialogSetup): call
	"gtk_widget_show_all()".

	* src/gtk/x11file.c (MathTextDialogSetup, MathDialogSetup)
	(FitLoadDialogSetup, FitSaveDialogSetup, FitDialogSetup)
	(MarkDialogSetup, FileDialogSetup, FileDefDialogSetup): call
	"gtk_widget_show_all()".

	* src/gtk/x11view.c (EvalDialogSetup): call
	"gtk_widget_show_all()".

	* src/gtk/x11opt.c (DefaultDialogSetup, SetScriptDialogSetup)
	(PrefScriptDialogSetup, SetDriverDialogSetup)
	(PrefDriverDialogSetup, FontSettingDialogSetup)
	(PrefFontDialogSetup, MiscDialogSetup, ExViewerDialogSetup)
	(ViewerDialogSetup): call "gtk_widget_show_all()".
	(DefaultDialogSetup): use "gtk_widget_set_visible()" instead of
	"gtk_widget_set_sensitive()".

	* src/gtk/x11gui.c (DialogExecute): use "gtk_widget_show()"
	instead of "gtk_widget_show_all()".

2013-07-24  Koichi Akabe <vbkaisetsu at gmail.com>

	* misc/ngraph.desktop (Keywords): added.

2013-07-18  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gra.h (GRA_FILL_MODE): added.

	* src/gra.c (GRAdrawpoly): type of the 4th parameter is "enum
	GRA_FILL_MODE".

2013-07-17  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11lgnd.c (LegendArrowDialogSetup): use
	"set_scale_mark()".
	(points_setup, LegendArrowDialogSetup, LegendRectDialogSetup)
	(LegendArcDialogSetup): use "set_widget_margin()".
	(create_color_combo_box, select_type): the field "line_join" can
	be modified from a combo-box.
	(create_mark_color_combo_box): call
	"add_line_style_item_to_cbox()".

	* src/gtk/x11lgndx.c (LegendGaussDialogSetup): use
	"set_scale_mark()".

	* src/gtk/gtk_widget.h (WIDGET_MARGIN): added.

	* src/gtk/gtk_widget.c (set_widget_margin, set_scale_mark): added.

	* src/gtk/gtk_subwin.c (spin_button_size_allocated): use variable
	"new_allocation".

	* src/gtk/x11file.c (move_tab_create, mask_tab_create)
	(load_tab_create, math_tab_create): use "set_widget_margin()".
	(create_type_color_combo_box, select_type): the field "line_join"
	can be modified from the combo-box.

	* src/gtk/x11axis.c (scale_tab_create, baseline_tab_create)
	(gauge_tab_create, numbering_tab_create, font_tab_create)
	(position_tab_create): use "set_widget_margin()".

	* src/gra.h (GRA_LINE_JOIN, GRA_LINE_CAP): added.

	* src/gra.c (GRAlinestyle): type of 5th and 6th parameters are
	"enum GRA_LINE_CAP" and "enum GRA_LINE_JOIN" respectively.

2013-07-13  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/gtk/x11lgnd.c (create_character_view): don't set the number
	of columns when the version of GTK+ is greater or equal to
	"3.8.0".
	(create_character_view): call
	"gtk_icon_view_set_activate_on_single_click()" when the version of
	GTK+ is greater or equal to "3.8.0".

2013-07-12  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11file.c (create_user_fit_frame): use
	"gtk_container_add()" instead of
	"gtk_scrolled_window_add_with_viewport()" when the version of GTK+
	is greater or equal to "3.8.0".

	* src/gtk/ogra2x11.c (gtkinit): use "gtk_container_add()" instead
	of "gtk_scrolled_window_add_with_viewport()" when the version of
	GTK+ is greater or equal to "3.8.0".

	* src/gtk/gtk_subwin.c (label_sub_window_create): use
	"gtk_container_add()" instead of
	"gtk_scrolled_window_add_with_viewport()" when the version of GTK+
	is greater or equal to "3.8.0".

	* src/gtk/gtk_ruler.c (nruler_get_color): use "TopLevel" to get
	the default color.

2013-07-05  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/gtk/x11menu.c (application): check the state of
	"ViewToggleSingleWindowModeAction".

	* src/gtk/main.c (main): the "-i" option with no filename means
	to execute a console.

	* src/gtk/gtk_subwin.c (start_editing): the function
	"spin_button_size_allocated()" is connected to the "size-allocate"
	signal.
	(spin_button_size_allocated): added.

2013-06-27  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11view.c (PasteObjectsFromClipboard): check "d->Win".
	(PasteObjectsFromClipboard, ShowCrossGauge, show_zoom_animation)
	(show_move_animation, mouse_move_scroll, ViewerEvMouseMove)
	(popup_menu_position, SetHRuler, SetVRuler, create_pix): use
	"gtk_widget_get_window()".
	(move_focus_frame, ViewerEvVScroll, ViewerEvHScroll)
	(ViewerWinUpdate, ChangeDPI, Draw): use "main_window_redraw()".

2013-06-26  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/ogra2cairo.c (gra2cairo_draw_path): check
	"local->cairo".

	* src/gtk/x11file.c (draw_type_pixbuf): use
	"gra2cairo_draw_path()".
	(CmFileSaveData): use "main_window_redraw()".

	* src/gtk/x11lgnd.c (draw_color_pixbuf): use
	"gra2cairo_draw_path()".

	* src/gtk/ogra2gtkprint.c (gra2gtkprint_done): use
	"gra2cairo_draw_path()".

	* src/gtk/ox11menu.c (main_window_redraw): added.
	(mx_redraw, mxdpi, mxclear): use "gra2cairo_draw_path()".
	(mxflush): use "gra2cairo_draw_path()".

	* src/gtk/ogra2x11.c (gtklocal): remove member "win".
	(redraw_window): added.
	(gtkclear, gtkflush, gtkredraw): use "redraw_window()".

	* src/gtk/x11menu.h (Viewer): remove member "gdk_win".

	* src/gtk/x11menu.c (NSetCursor): check "NgraphApp.Viewer.Win" and
	use "gtk_widget_get_window()".
	(script_exec): use "main_window_redraw()".

	* src/gtk/x11print.c (draw_gra): use "main_window_redraw()".

2013-06-05  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/object.h (objlist): type of the member "root" and "root2"
	should be "N_VALUE *".

2013-06-05  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/gtk/ogra2x11.c (gtkwait_action): renamed from "wait_key()".
	(action_type, button_released, scrolled): added.
	(gtklocal): use "struct action_type".
	(gtkinit): add event handler for signals "button-release-event"
	and "scroll-event".

2013-06-04  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gra.c (GRAcolor): don't change the color when an argument is
	negative.
	(GRAdrawtext, GRAtextextent): add "C" and "A" parameter.

	* src/gtk/ogra2x11.c (gtklocal): add member "blank_cursor".
	(cursor_moved): added.
	(gtkinit): initialize "gtklocal->blank_cursor".
	(gtkinit): the "motion-notify-event" signal is connected to the
	function "cursor_moved()".
	(gtkdone): unref "gtklocal->blank_cursor" if necessary.
	(gtk_wait_key): set mouse cursor invisible.

	* src/gtk/gtk_common.h (SE_ENTRY_ICON): removed.

	* configure.in (GTK2_REQUIRED_VERSION, GLIB_REQUIRED_VERSION):
	changed from "2.14.0" to "2.16.0".

2013-06-02  Hiroyuki Ito  <ZXB01226 at nifty.com>

	* src/ofile.c (f2dredraw): redraw when the variable "dmax" equal
	to zero.

	* src/gtk/ogra2x11.c (ev_key_down): save "e->keyval".
	(ev_key_down): use "gtkclose()" to close the window.
	(gtk_wait_key): added.
	(gra2gtk): add "wait_key" field.

	* src/gtk/x11menu.c (application): call "multi_to_single()" if
	necessary.

	* src/omerge.c (mergeredraw): redraw when the variable "dmax"
	equal to zero.

2013-05-31  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/ox11dlg.c (dlgbutton): set "rval->str".

2013-05-29  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/ogra.c (close_gc): added.
	(oGRAclose): use "close_gc()".
	(oGRAopen): call "close_gc()" when "GRAinit()" returns non-zero
	value.
	(oGRAopen): bug fix: initialize the variable "robj" and check
	before call the function "GRAopen()".

	* src/gtk/ogra2cairo.c (addgra2cairo): use
	"CAIRO_STATUS_LAST_STATUS" to generate error messages.

	* src/gtk/ox11dlg.c (dlgbutton): added.
	(dialog): add "button" field.

	* src/gtk/x11gui.c (DialogButton): added.

	* src/gtk/x11view.c (Draw, Clear): don't use "Menulocal.GRAinst".

	* src/gtk/ogra2x11.c (size_allocate, gtkfullscreen, gtk_set_fit)
	(gtk_set_frame): added.
	(gtkinit): initialize "fit" and "frame" fields.
	(gtkinit): the "GtkDrawingArea" is located center of the window.
	(gtkinit): the function "size_allocate()" is connected to the
	"size-allocate" signal.
	(gtkchangedpi): use function "cairo_surface_destroy()" instead of
	"g_object_unref()".
	(gtkMakeRuler): check "gtklocal->frame".
	(gtk_set_dpi): set "fit" field as FALSE.
	(gra2gtk): add fields "fit", "frame" and "fullscreen".

	* src/gtk/x11commn.c (OpenGRA): remove redundant call of the
	function "chkobjinstoid()".
	(OpenGRA, CheckPage, CloseGRA, ChangeGRA): don't use
	"Menulocal.GRAinst".
	(SetPageSettingsToGRA): bug fix: the last argument of the function
	"_putobj()" is not "&drawable" but "drawable".

2013-05-24  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* doc/html/ja/math.html: update document.

	* src/math/math_basic_function.c (math_func_for): use variables
	"start", "stop" and "step".

	* src/gtk/x11file.c (set_headline_table_header): fix title of the
	table.

2013-05-20  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/math/math_parser.c (create_variable_assign_expression):
	initialize the variable "bin".

	* src/math/math_scanner.c (math_scanner_get_token, get_ope): EOEQ
	is treated as an operator.

	* src/math/math_operator.h.in: add operators ":=", "==", ">=",
	"<=", "!=", "-=", "+=", "*=", "/=", "\=" and "^=". EOEQ is treated
	as an operator.

	* src/math/math_operator.rb: accept multiple representations for
	one operator.

	* src/osarray.c (ERROUTBOUND): added
	(sarrayerrorlist): add error message for the error "ERROUTBOUND".
	(sarrayget, sarrayput, sarraysns, sarraydel): show error message
	for the error "ERROUTBOUND".

	* src/odarray.c (ERROUTBOUND): added
	(darrayerrorlist): add error message for the error "ERROUTBOUND".
	(darrayget, darrayput, darraydns, darraydel): show error message
	for the error "ERROUTBOUND".

	* src/oiarray.c (ERROUTBOUND): added.
	(iarrayerrorlist): add error message for the error "ERROUTBOUND".
	(iarrayget, iarrayput, iarrayins, iarraydel): show error message
	for the error "ERROUTBOUND".

2013-05-16  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/math/math_expression.c (optimize_div_expression): check if
	the right hand side of the operator is zero or not.
	(calc): compare with "0.0" (not "0").

	* src/gtk/x11file.c (set_headline_table): remark character is
	located at the top of a line.

2013-05-09  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* debian/patches/series: remove "01_replace_to_free_fonts.patch".

	* initfile/Ngraph.ini.in: use "Liberation" fonts as default.

	* src/gtk/x11view.c (ViewerEvKeyDown): initialize the variable "d"
	first.

2013-04-13  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/ofile.c (get_value_from_str): accepts space character around
	the value.

2013-04-11  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11file.c (check_add_str): use "〓" if the character is
	not printable.
	(set_headline_table): use "g_ascii_isprint()" and
	"g_ascii_isspace()".

	* src/ofile.c (get_value_from_str): added.
	(getdataarray): use 'get_value_from_str()'.

2013-04-06  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11file.c (decode_ifs_text): accepts ascii character only.
	(check_add_str): added.
	(parse_data_line): use "check_add_str()".
	(set_headline_table): only ascii character can be accepted as
	mark.

2013-04-05  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11view.c (ViewerEvLButtonUp): call
	"set_focus_sensitivity()".

2013-04-04  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11file.c (set_headline_table, create_preview_table)
	(update_table_visibility): don't use "GtkTreeModelFilter".
	(set_headline_table_header): check space of the cilumn header.

2013-04-03  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11file.c (parse_data_line): remove 6th parameter.
	(create_preview_table): use "GtkTreeModelFilter".
	(update_table_visibility): added.

	* src/ofile.c (getdataarray): set terminator at the end of the
	column.

2013-03-31  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11dialg.h (FileDialog): add member "head_linese."

	* src/gtk/x11file.c (set_headline_table_header, update_table)
	(update_table_header): added.
	(FileDialogSetup): use "set_headline_table_header()".

2013-03-29  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11dialg.h (FileDialog): add members "comment_table" and
	"initialized".

	* src/gtk/x11file.c (decode_ifs_text, set_headline_table)
	(create_preview_table): added.
	(load_tab_set_value): use "decode_ifs_text()".
	(FileDialogSetupCommon): use "GtkGrid" when the version of GTK+ is
	greater or equal to "3.0.0".
	(FileDialogSetup): add table preview.
	(FileDialogClose, FileDialog): set "d->initialize" as FALSE.

2013-03-15  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11view.c (ViewerEvKeyDown): call
	"set_focus_sensitivity()" when the signal is propagated further.
	(add_focus_obj, clear_focus_obj): don't call
	"set_focus_sensitivity()".

	* src/gtk/gtk_subwin.c (start_editing): the function "UnFocus()"
	don't have to be called before "menu_lock()".
	(list_unfocused): removed.

	* src/gtk/x11menu.c (menu_lock): don't call
	"set_focus_insensitive()" and "set_focus_sensitivity()".
	(edit_menu_shown): added.
	(setupwindow): "edit_menu_shown()" is connected to the
	"show"signal of the popup menu and edit menu.

2013-03-12  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11menu.c (menu_lock): call "set_focus_insensitive()" or
	"set_focus_sensitivity()".
	(set_focus_sensitivity_sub): set sensitivity of "EditPasteAction".

	* src/gtk/gtk_subwin.c (start_editing): call "UnFocus()" before
	call "menu_lock()".
	(list_unfocused): call "set_focus_sensitivity()" only when
	"Menulock" is false.

2013-03-11  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11axis.c (type_edited): removed.
	(CmAxisWindow): the 5th argument of the function
	"set_combo_cell_renderer_cb()" is "NULL".

	* src/gtk/x11lgnd.c (select_type): call "gtk_widget_grab_focus()".
	(edited_line_type, edited_font): removed.
	(CmLegendWindow): the 5th argument of the function
	"set_combo_cell_renderer_cb()" is "NULL".

	* src/gtk/gtk_subwin.c (cancel_editing, enum_cb): call
	"gtk_widget_grab_focus()".
	(set_cell_renderer_cb): the 4th argument of the function
	"g_signal_connect()" for the "editing-canceled" signal is "d" when
	tha case is "G_TYPE_ENUM".
	(combo_edited_cb): added.
	(set_combo_cell_renderer_cb): use "combo_edited_cb()" as the
	default call-back for the signal "edited".
	(set_combo_cell_renderer_cb, set_obj_cell_renderer_cb): the 4th
	argument of the function "g_signal_connect()" for the
	"editing-canceled" signal is "d"

	* src/gtk/x11file.c (select_type, edited_axis): call
	"gtk_widget_grab_focus()".

2013-03-08  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11file.c (MARK_PIX_LINE_WIDTH, set_line_style)
	(CURVE_POINTS_MAX, draw_curve): added.
	(draw_type_pixbuf): use "MARK_PIX_LINE_WIDTH", "set_line_style()",
	"CURVE_POINTS_MAX" and "draw_curve()".
	(draw_type_pixbuf): update image.
	(select_type): check if the graph is modified or not after call
	the function "chk_sputobjfield()".

2013-03-06  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11file.c (select_type): add "break" statement for the
	case "FILE_COMBO_ITEM_LINESTYLE:".

	* src/gtk/x11commn.c (FitClear): fix indent.

2013-03-04  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11file.c (select_type): add case for
	"FILE_COMBO_ITEM_CLIP".
	(create_type_color_combo_box): add "clip" combo-item.

2013-03-02  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/gtk_widget.c (select_obj_color): change type of the
	return value.

	* src/gtk/x11lgnd.c (select_type): check returned value of the
	function "select_obj_color()"

	* src/gtk/x11axis.c (AxisCB): initialize the variable "s".
	(AxisHistoryCB): use "AxisCB()".

	* src/gtk/ox11menu.c (menuinit): fix initial value of
	"Menulocal.side_pane1_pos" and "Menulocal.side_pane2_pos".

2013-03-01  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11axis.c (select_type): use "OBJECT_COLUMN_TYPE_ENUM".

	* src/gtk/x11file.c (select_type): use "OBJECT_COLUMN_TYPE_ENUM".

	* src/gtk/x11lgnd.c (select_type, select_line_type): use
	"OBJECT_COLUMN_TYPE_ENUM".

	* src/gtk/gtk_liststore.c (add_text_combo_item_to_cbox): use
	"TOGGLE_TYPE". add parameter "enum_id".
	(add_enum_combo_item_to_cbox, add_bool_combo_item_to_cbox)
	(add_line_style_item_to_cbox, add_font_style_combo_item_to_cbox):
	use "add_text_combo_item_to_cbox()".

	* src/gtk/gtk_liststore.h (TOGGLE_TYPE): added.
	(OBJECT_COLUMN_TYPE): add "OBJECT_COLUMN_TYPE_ENUM".

2013-02-28  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11lgnd.c (points_setup): check the version of GTK+ to
	avoid the bug (Bug 691592).

	* src/gtk/gtk_liststore.c (create_column): check the version of
	GTK+ to avoid the bug (Bug 691592).

2013-02-26  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/shellcm.c (cmget): check returned value via 3rd argument of
	the function "sgetobjfield()".

	* src/gtk/gtk_liststore.c (add_line_style_item_to_cbox): don't
	duplicate returned value via 3rd argument of the function
	"sgetobjfield()".

	* src/gtk/x11axis.c (Popup_list): remove "Show" item from the
	pop-up menu.
	(popup_show_cb): remove case for "POPUP_ITEM_HIDE".
	(AxisCB, AxisHistoryCB, GridDialogSetupItem)
	(scale_tab_setup_item, position_tab_setup_item)
	(axis_list_set_val): check returned value via 3rd argument of the
	function "sgetobjfield()".

	* src/gtk/x11merge.c (Popup_list): remove "Show" item from the
	pop-up menu.
	(popup_show_cb): remove case for "POPUP_ITEM_HIDE".

	* src/gtk/x11lgnd.c (Popup_list): remove "Show" item from the
	pop-up menu.
	(legend_dialog_setup_item, path_list_set_val): check returned
	value via 3rd argument of the function "sgetobjfield()".
	(popup_show_cb): remove case for "POPUP_ITEM_HIDE".

	* src/gtk/x11file.c (Flist): remove "Show" and "Fit" items from
	the pop-up menu.
	(FitCB, load_tab_setup_item, file_setup_item)
	(FileDialogSetupItem, get_axis_obj_str): check returned value via
	3rd argument of the function "sgetobjfield()".
	(FileDialogSetupItem): remove 4th parameter.
	(show_fit_dialog): added.
	(FileDialogFit): use "show_fit_dialog()".
	(file_fit_popup_func): removed.
	(popup_show_cb): remove cases for "POPUP_ITEM_HIDE" and
	"POPUP_ITEM_FIT".
	(start_editing): don't show radio buttom on the combo-box.
	(add_fit_combo_item_to_cbox): added.
	(create_type_color_combo_box): use "add_fit_combo_item_to_cbox()".
	(select_type): show fitting dialog when the plot type fit is
	selected and the fit field of the file instance is not set.
	(select_type): add case for "FILE_COMBO_ITEM_FIT".

	* src/gtk/gtk_subwin.c (start_editing): check returned value via
	3rd argument of the function "sgetobjfield()".

2013-02-24  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/gtk_widget.c (combo_box_create_mark): removed.
	(select_obj_color): handle case for
	"OBJ_FIELD_COLOR_TYPE_AXIS_BASE",
	"OBJ_FIELD_COLOR_TYPE_AXIS_GAUGE" and
	"OBJ_FIELD_COLOR_TYPE_AXIS_NUM".

	* src/gtk/x11lgnd.c (text_list_set_val): set color of the text
	column.
	(create_mark_color_combo_box): use "add_text_combo_item_to_cbox()"
	and "add_mark_combo_item_to_cbox()".
	(create_fill_rule_combo_box): removed.
	(create_color_combo_box): use "add_bool_combo_item_to_cbox()",
	"add_line_style_item_to_cbox()", "add_text_combo_item_to_cbox()"
	and "add_enum_combo_item_to_cbox()".
	(select_type): dant handle the case "LEGEND_COMBO_ITEM_COLOR_0".
	(select_line_type): now the ComboBox use "GtkTreeStore".
	(start_editing_line_type): use "init_object_combo_box()".
	(select_font): added.
	(start_editing_font): use "init_object_combo_box()".
	(edited_font): only call "menu_lock()".
	(CmLegendWindow): set "foreground" column.

	* src/gtk/gtk_liststore.c (combo_box_separator_func)
	(init_object_combo_box, create_object_tree_model)
	(add_separator_combo_item_to_cbox, add_font_combo_item_to_cbox)
	(add_font_style_combo_item_to_cbox, add_text_combo_item_to_cbox)
	(add_mark_combo_item_to_cbox, add_enum_combo_item_to_cbox)
	(add_bool_combo_item_to_cbox, add_line_style_item_to_cbox): added.
	(create_object_cbox): use "create_object_tree_model()".
	(create_column): use "create_object_tree_model()" for the case
	"G_TYPE_PARAM".

	* src/gtk/x11dialg.c (SetFontListFromObj): type of the lase
	parameter is "const char *".

	* src/gtk/x11file.c (create_type_color_combo_box): use
	"create_type_combo_item()" and "add_text_combo_item_to_cbox()".
	(create_type_combo_item): use "add_text_combo_item_to_cbox()".
	(create_type_combo_item): added.
	(create_type_combo_box): removed.
	(select_axis): use "gtk_tree_model_get()" to get active item.
	(start_editing): use "init_object_combo_box()" and
	"add_text_combo_item_to_cbox()".

	* src/gtk/x11axis.c (AXIS_COMBO_ITEM, create_base_combo_item)
	(create_gauge_combo_item, create_num_combo_item)
	(create_type_combo_box, select_type, start_editing_type)
	(type_edited): added.
	(CmAxisWindow): call "set_combo_cell_renderer_cb()".

2013-02-21  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11view.c (ViewerWinClose): assign NULL to freed member.

	* src/gtk/gtk_liststore.c (create_object_cbox): use
	"OBJECT_COLUMN_TYPE_NUM" for the function "gtk_tree_store_new()".
	(add_line_style_item_to_cbox): add 3rd, 5th, 6rh and 7th
	parameters.

	* src/gtk/gtk_liststore.h (OBJECT_COLUMN_TYPE): add
	"OBJECT_COLUMN_TYPE_TOGGLE_IS_RADIO" and "OBJECT_COLUMN_TYPE_NUM".

	* src/gtk/x11file.c (FileDialogType): set sensitivity of the
	widgets to set "line style" and "line width".
	(create_type_color_combo_box): add 4th parameter.
	(create_type_combo_box): add 3rd parameter.

	* src/gtk/gtk_widget.c (combo_box_create_mark): add 4th parameter.

	* src/gtk/x11lgnd.c (LEGEND_COMBO_ITEM): add
	"LEGEND_COMBO_ITEM_FILL_EVEN_ODD" and
	"LEGEND_COMBO_ITEM_FILL_WINDING".
	(create_mark_color_combo_box): add 3rd parameter.
	(create_fill_rule_combo_box): added.
	(create_color_combo_box): some menus are placed as a child menu.
	(set_bool_field, set_stroke, set_fill): added.
	(select_type): use "set_stroke()" and "set_fill()". set
	"fill_rule" field.

2013-02-20  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11file.c (create_type_color_combo_box): use
	"add_line_style_item_to_cbox()".
	(select_type): add case for "FILE_COMBO_ITEM_LINESTYLE".

	* src/gtk/gtk_liststore.c (add_line_style_item_to_cbox): added.

	* src/gtk/x11lgnd.c (select_color, select_line_style): removed.
	(create_mark_color_combo_box, create_color_combo_box): use
	"add_line_style_item_to_cbox()".
	(select_type): handle all legend objects.
	(start_editing_color): use "select_type()" as a callback function.

	* addin/fitrslt.c (set_parameter): use "file::fit_prm".
	(ACCURACY): defined as 7

2013-02-19  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11lgnd.c (add_line_style_item): added.
	(create_mark_color_combo_box, create_color_combo_box): use
	"add_line_style_item()".
	(select_line_style): added.
	(select_type, select_color): use "select_line_style()".

	* mingw/windows.sh: create "$PKG_DIR/lib".

	* mingw/gtkrc (msw-combobox-thickness): set
	"GtkComboBox::appears-as-list" as 0.

2013-02-18  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* addin/ps2gra.nsc: use "get" command to obtain returned value of
	"dialog::yesno".

	* src/ofit.c (fitput, fitcalc): use
	"ofile_create_math_equation()".

	* src/ofile.c (file_fit_calc, file_fit_prm): don't use
	"math_equation_get_user_data()".
	(FitFunc, add_fit_func): added.
	(ofile_create_math_equation): add 7th parameter "use_fit_func".
	(ofile_create_math_equation): 2nd parameter represents the digit
	of prm.
	(ofile_calc_fit_equation): added.

2013-02-12  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/ofit.c (fitlocal): add member "result_code".
	(fitinit): initialize "fitlocal->result_code".
	(fitdone): free "fitlocal->result_code".
	(set_equation, fitequation): added.
	(fitput, fitfit): use "set_equation()".
	(fitfit): check case "FitError_Interrupt".
	(fitcalc): use "fitlocal->result_code".
	(fitcalc): returned value is not string but double.

	* src/ofile.c (MATH_CONST_MASK): add "MATH_CONST_FILE_OBJ",
	"MATH_CONST_PATH_OBJ", MATH_CONST_RECT_OBJ, "MATH_CONST_ARC_OBJ",
	"MATH_CONST_MARK_OBJ" and "MATH_CONST_TEXT_OBJ".
	(FIT_FIELD_PREFIX, file_obj_color_alpha, file_objcolor)
	(file_objalpha): added.
	(file_color): now first argument of the "COLOR()" function accepts
	"8" and "9".
	(file_fit_calc, file_fit_prm): added.
	(file_func): add functions "FIT_CALC", "FIT_PRM", "OBJ_COLOR" and
	"OBJ_ALPHA".
	(ofile_create_math_equation): add constants "FILE_OBJ",
	"PATH_OBJ", "RECT_OBJ", "ARC_OBJ", "MARK_OBJ" and "TEXT_OBJ".
	(set_const): initialize constants "FILE_OBJ", "PATH_OBJ",
	"RECT_OBJ", "ARC_OBJ", "MARK_OBJ" and "TEXT_OBJ".
	(newton): don't check the number of the iteration is 1 or not ("i
	= 1").
	(solve_equation): add prefix to the fields.
	(solve_equation): the error message is not set to the returned
	string.
	(calc_fit_equation): added.
	(calc_equation): use "calc_fit_equation()".
	(calc_equation): the error message is not set to the returned
	string.
	(get_fit_parameter): added.
	(file2d): add fields "fit_prm". change name of the fields
	"newton", "bisection" and "calc".

	* src/gtk/x11file.c (MathDialogSetup): initialize "d->Mode" whine
	"makewidget" is true
	(MathDialog): don't modify "data->Mode".

	* src/gtk/x11view.c (Draw): call "FitClear()" after call
	"FileAutoScale()".

	* src/object.c (addobject): object id is start from 1.

2013-01-24  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* initfile/NgraphUI.xml.win: add "Sidebar" menu.

	* initfile/NgraphUI.xml: add "Sidebar" menu.

	* src/gtk/ox11menu.h (menulocal): add member "sidebar".

	* src/gtk/x11menu.h (MenuID): add id "MenuIdToggleSidebar".

	* src/gtk/x11menu.c (ActionEntry): add "ViewSidebarAction".
	(ActionEntry): change shortcut key of "cross bar" menu from "+" to
	"^g",
	(set_window_action_visibility): set visibility of
	"ViewSidebarAction".
	(multi_to_single): check "Menulocal.sidebar".0
	(toggle_view_cb): handle "MenuIdToggleSidebar".
	(application): hide only "NgraphApp.Viewer.side_pane1".

	* src/gtk/ox11menu.c (MenuConfigToggleView): add sidebar setting.
	(menuinit): initialize "Menulocal.sidebar".

2013-01-23  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11file.c (FileWinFit): use "list_store_get_selected_int()".
	(filewin_ev_key_down): check "GDK_CONTROL_MASK" for the case "GDK_KEY_f".

2013-01-22  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/gtk_subwin.c (copy, delete, move_top, move_last)
	(move_up, move_down, hidden): call "UnFocus()".
	(list_focused, list_unfocused): added.
	(list_widget_create): use "focus-in-event" and "focus-in-event" to
	improve behavior of single window mode.

	* src/gtk/x11file.c (FitDialogSetup): add delete button to the
	dialog.
	(filewin_ev_key_down): call "UnFocus()".

	* src/gtk/x11view.c (ShowFocusFrame): don't call
	"set_focus_sensitivity()".
	(ViewerEvKeyDown): "DGK_KEY_Insert" is not handled.
	(Focus): don't call "gtk_widget_grab_focus()".
	(CmEditMenuCB): add case "MenuIdEditDuplicate".

	* src/gtk/x11axis.c (axiswin_delete_axis): call "UnFocus()".

	* src/gtk/x11menu.c (set_action_sensitivity)
	(set_focus_sensitivity_sub, set_focus_insensitive): added.
	(set_focus_sensitivity): use "set_focus_sensitivity_sub()".

	* initfile/NgraphUI.xml.win: add "EditDuplicate" item.

	* initfile/NgraphUI.xml: add "EditDuplicate" item.

2013-01-18  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/gtk_subwin.c (swin_realized): type of the "user_data" is
	"struct obj_list_data *".
	(list_widget_create): "realize" signal is connected to the
	function "swin_realized()".
	(sub_window_create): don't call "g_signal_connect()" to the
	variable "swin".
	(tree_sub_window_create): remove redundant cast to "struct SubWin *".

2013-01-14  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/gtk_liststore.c (create_column): don't use
	GtkCellRendererSpin while the GTK+ bug is not fixed.

	* src/gtk/x11lgnd.c (points_setup): don't use GtkCellRendererSpin
	while the GTK+ bug is not fixed.

2013-01-11  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11view.c (ZOOM_SPEED_LITTLE, ZOOM_SPEED_NORMAL)
	(mouse_down_zoom_little, mouse_down_zoom2): added.
	(ViewerEvScroll): use "mouse_down_zoom_little()".

	* src/gtk/ogra2emf.c (enum_font_cb): check argument "FontType" and
	return with 0 if necessary.

2013-01-09  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11view.c (PasteObjectsFromClipboard): check source
	device.

2013-01-08  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* addin/legend.c (loaddatalist): check "hidden" field of data
	instances.

2013-01-07  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* addin/legend.c (create_file_frame): not set hight of tree view
	but scrolled window.
	(create_file_frame): sensitivity of columns are depend on the
	state of the top column.
	(create_control): setting frames are expandable.

	* addin/fitrslt.c (create_spin_button): set margin of spin button
	widget.
	(create_control): setting frames are expandable.

	* addin/addin_common.c (create_font_frame): table widget is
	expandable

	* src/gtk/gtk_subwin.c (list_widget_create): sensitivity of
	columns are depend of the state of top column.

	* src/gtk/gtk_liststore.c (create_column): expand some editable
	columns.

	* src/gtk/x11lgnd.c (CmLegendWindow): don't expand some columns.

2013-01-04  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* addin/fitrslt.c (get_opt): check "argv[i]".

	* addin/legend.c (get_opt): check "argv[i]".

2013-01-01  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* addin/fitrslt.c (savescript, caption_toggled, set_parameter):
	use GtkTreeModel.
	(text_edited, caption_edited, value_edited): added.
	(create_caption_frame): use GtkTreeView widgret.
	(VERSION): 1.00.02

2012-12-28  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11menu.c (application): call "CheckIniFile()" before
	save configurations.

2012-12-27  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/ox11menu.c (mx_show_win, mx_hide_win, mx_toggle_win):
	check "Menulocal.single_window_mode".

2012-12-21  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/gtk_subwin.c (tree_sub_window_create): call
	"gtk_notebook_popup_enable()".
	(tree_sub_window_create): set text label of the popup menu.

2012-12-20  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11lgnd.c (CmLegendWindow): use icon file macros.
	(CmLegendWindow): add data for the key "ngraph_object_data" to
	widgets of inside of tabs.

	* src/gtk/x11menu.c (ActionEntry, window_to_tab, multi_to_single):
	use icon file macros.
	(window_to_tab): add parameter "tip".
	(tab_info_compare, init_tab_info, save_tab_position_sub)
	(save_tab_position): added.
	(multi_to_single): restore tab positions.
	(single_to_multi): call function "save_tab_position()".
	(single_to_multi): enable popup of tabs.
	(create_action_group): use icon file macros.
	(application): call function "save_tab_position()".

	* src/gtk/ox11menu.h (menulocal): add member related to tabs used
	in the single window mode.

	* src/gtk/ox11menu.c (MenuConfigOthers): add settings related to
	tabs used in the single window mode.
	(menuinit): initialize settings related to tabs used in the single
	window mode.

	* src/gtk/gtk_subwin.c (file_select, update): parent window is
	depend on the setting "Menulocal.single_window_mode".
	(swin_realized): added.
	(sub_window_create): connect "realize" signal to the function
	"swin_realized()".
	(sub_window_set_visibility): don't update content in this
	function.

	* src/gtk/x11file.c (FileWinFileUpdate, FileWinFit): parent window
	is depend on the setting "Menulocal.single_window_mode".

	* src/gtk/x11bitmp.h: add macros for icon files.

	* src/ioutil.h (DIRSEP_STR): added.

2012-12-18  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/gtk_ruler.c (nruler_destroy): destroy or unref
	"ruler->backing_store".

2012-12-17  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11view.c (popup_menu_position): use the function
	"gdk_window_get_origin()" to get the position.
	(ViewerWinSetup): the function "ev_popup_menu()" is connect to the
	signal "popup-menu".
	(ev_popup_menu): added.

	* src/gtk/gtk_subwin.c (popup_menu_position): use the function
	"gdk_window_get_origin()" to get the position.
	(do_popup): data for the positon function is "d->text".

2012-12-16  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11file.c (init_dnd): destination of DnD is listsore
	widget.

	* src/gtk/x11merge.c (init_dnd): destination of DnD is listsore
	widget.

	* src/gtk/x11cood.c (CoordWinSetCoord): the variable "str" should
	be initialized as "NULL".
	(CoordWinSetCoord): don't check visibility of the widget "d->Win".
	(CoordWinSetCoord): show date and time in new line.

	* src/gtk/ox11menu.c (MenuConfigOthers): add pane and single
	window mode settings.
	(menuinit): initialize pane and single window mode settings.

	* src/gtk/x11opt.c (DefaultDialogSetup): set widget sensitivity
	depend on "Menulocal.single_window_mode".

	* src/gtk/gtk_subwin.c (sub_window_save_geometry): check
	"Menulocal.single_window_mode".
	(sub_window_create, text_sub_window_create)
	(label_sub_window_create, list_sub_window_create)
	(tree_sub_window_create): type of the second parameter is "const
	char *".

	* src/gtk/x11menu.c (SIDE_PANE_TAB_ID): added.
	(ActionEntry): add "ViewToggleSingleWindowModeAction".
	(menu_lock): check "NgraphApp.Viewer.menu", lock
	"NgraphApp.Viewer.menu" and the first child of the widget
	"NgraphApp.Viewer.main_pane".
	(set_window_action_visibility, OBJ_ID_KEY, window_to_tab)
	(tab_to_window, get_pane_position, set_pane_position)
	(multi_to_single, check_move_widget, check_move_legend_widget)
	(single_to_multi): added.
	(setupwindow): add paned widget for the single window mode.
	(create_sub_windows): check "Menulocal.single_window_mode".
	(set_toggle_action): added.
	(window_action_set_active): use the function
	"set_toggle_action()".
	(application): call "gtk_window_set_has_resize_grip()".
	(application): check "Menulocal.single_window_mode".
	(CmToggleSingleWindowMode): added.

	* initfile/NgraphUI.xml: add single window mode menu item.

	* initfile/NgraphUI.xml.win: add single window mode menu item.

2012-12-11  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11menu.c (setupwindow): remove redundant call of the
	function "gtk_menu_bar_new()".

2012-12-04  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11view.c (draw_paper_frame): the origin of the
	rectangle is 0 is the version of GTK+ is less than "2.22".

	* src/gtk/gtk_common.h (CAIRO_COORDINATE_OFFSET): always defined as "1".

	* src/gtk/gtk_ruler.c (_Nruler): add member "widget" and "parent".
	(nruler_new): change name from "ruler_new".
	(nruler_new): use "GtkFrame".
	(nruler_make_pixmap): add argument "parent".
	(nruler_draw_ticks): don't draw frame.

	* src/gtk/x11menu.c (setupwindow): use "nruler_new()".

2012-12-03  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/gtk_ruler.c (nruler_get_preferred_width)
	(nruler_get_preferred_height, nruler_size_request, hruler_new)
	(vruler_new): removed.

2012-12-01  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/gtk_ruler.c (nruler_set_style, nruler_parent_set):
	removed.
	(nruler_get_color): added.
	(nruler_draw_pos, nruler_draw_ticks): use "nruler_get_color()".

	* src/gtk/main.c (main): dan't call "gdk_threads_init()" and
	"gdk_threads_enter()".

2012-11-30  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/gtk_ruler.c (nruler_set_style): added.
	(nruler_parent_set): connect the function "nruler_set_style" to
	the signal "changed".
	(nruler_draw_ticks, nruler_draw_pos): always use the color
	correspond to "GTK_STATE_NORMAL".

	* src/gtk/x11file.c (Flist): type of the "masked" column is now
	"G_TYPE_INT".
	(file_list_set_val): set style instead of color to distinguish
	masked or mobed data.
	(CmFileWindow): "masked" column is correspond to "style" property.

2012-11-29  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/gtk_ruler.c (ruler_new): connect the function
	"nruler_parent_set()" to the signal "parent-set".
	(nruler_parent_set): added.

	* src/gtk/gtk_widget.c (create_text_view_with_line_number): call "gtk_text_buffer_new()".

	* src/gtk/gtk_subwin.c (text_sub_window_create): call "gtk_text_buffer_new()".

2012-11-10  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/ofit.c (show_poly_equation, show_poly_result)
	(show_user_result, show_user_equation): added.
	(fitpoly): use "show_poly_equation()" and "show_poly_result()".
	(fituser): use "show_user_equation()" and "show_user_result()".

2012-11-06  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/ofit.c (fitpoly, fituser): use "GString" to show fitting
	results.

2012-11-04  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/ofit.c (fitpoly, fituser): use "GString" to show calclated
	equation.

2012-11-03  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11bitmp.c (ICON_WIDTH, ICON_HEIGHT): removed.

	* src/gtk/x11commn.c (MESSAGE_BUF_SIZE): removed.

	* src/gtk/x11opt.c (BUF_SIZE): removed.

	* src/gtk/x11file.c (CB_BUF_SIZE): removed.

	* src/gtk/x11axis.c (CB_BUF_SIZE): removed.

	* src/gtk/x11lgnd.c (CmLegendWindow): use ""struct legend_data
	legend_data[]".
	(CB_BUF_SIZE): removed.

2012-11-02  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11lgnd.c (CmLegendWindow): add tooltip to icons.

2012-10-31  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/ofile.c (getdataarray): 'D' can be used as a prefix for a
	decimal exponent. Accept hexadecimal number.

	* src/otext.c (USE_UTF8): removed.
	(text_set_text): remove code for shift-jis.

2012-10-28  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/gtk_subwin.c (get_cell_renderer_from_tree_view): added.
	(set_combo_cell_renderer_cb, set_obj_cell_renderer_cb)
	(set_editable_cell_renderer_cb): use
	"get_cell_renderer_from_tree_view()".

	* src/gtk/x11lgnd.c (select_line_type): remove redundant call of
	the function "g_object_get_data()".
	(select_text, start_editing_text): added.
	(CmLegendWindow): connect the function "start_editing_text()"
	to the signal "editing-started".

2012-10-20  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* doc/html/ja/math.html: add explanation of the functions "eq",
	"neq", "ge", "gt", "le" and "lt".

	* test/math_test_new.dat: add tests for the functions "eq", "neq",
	"ge", "gt", "le" and "lt".

	* doc/html/ja/math.html: update explanation of the functions "eq",
	"neq", "ge", "gt", "le" and "lt".

	* src/math/math_function.rb: fix invarid expression for case
	statement.

	* src/math/math_function.h.in: increase number of arguments for
	the functions "ge", "gt", "le" and "lt".

	* src/math/math_basic_function.c (math_func_lt, math_func_le)
	(math_func_ge, math_func_gt): use "compare_double_with_prec()".
	(compare_double_with_prec): use "long double".

	* configure.in (AC_CHECK_FUNCS): check functions "log10l", "fabsl"
	and "floorl".

2012-10-19  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/math/math_constant.c: include "config.h".

	* src/math/math_operator.rb: convert integer to string (for Ruby 1.9).

	* src/math/math_expression.c: include "config.h".

	* src/math/math_parser.c: include "config.h".

	* src/math/math_equation.c: include "config.h".

	* src/math/math_error.c: include "config.h".

	* src/math/math_scanner.c: include "config.h".

	* src/math/math_equation.c: include "config.h".

	* src/math/math_constant.rb: include "config.h".

2012-10-18  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* test/math_test_new.dat: add tests for the functions "EQ()" and
	"NEQ()".

	* src/math/math_basic_function.c (compare_double_with_prec): fix
	calculation.

2012-10-17  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* initfile/Ngraph.ini.win: change initial size of main-window.

	* initfile/Ngraph.ini.in: set initial size of sub-windows.

2012-10-16  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/gtk_subwin.c (set_geometry): don't save state.
	(set_visibility, sub_window_save_visibility)
	(get_window_visibility): added.
	(sub_window_save_geometry): check return value of the function
	"get_window_visibility()".

	* src/gtk/x11gui.c (get_window_geometry): don't call
	"gdk_window_get_state()".

	* src/gtk/ox11menu.c (add_child_geometry_to_array): call
	"sub_window_save_visibility()".

	* src/gtk/x11menu.c (destroy_sub_windows): hide window before destroy.

2012-10-09  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11graph.c (PageDialogSetup): left and top margin can be
	nagative.

2012-10-08  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gra.c (GRAinit, GRAreopen): "GRAClist[GC].width" and
	"GRAClist[GC].height" is as same as paper width.
	(GRAregion): remove unused parameters.
	(GRAregion): calculate width and height depend on
	"GRAClist[GC].topm" and "GRAClist[GC].leftm".

2012-09-21  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11lgnd.c (start_editing_common, start_editing_font):
	call "menu_lock()" if the variable "sel" is negative.
	(start_editing_mark): the function "start_editing_common()" is
	failed if the return value is nagative.

2012-09-07  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11graph.c (LoadDialogSetup): remove redundant call of
	the function "gtk_box_pack_start()".

2012-09-04  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11opt.c (MiscDialogSetup): use "LoadPathStr".

	* src/gtk/x11commn.c (LoadNgpFile): use "LOAD_PATH_FULL" and
	"LOAD_PATH_BASE".

	* src/gtk/x11graph.h (LOAD_PATH_TYPE): added.

	* src/gtk/x11graph.c (LoadPathStr): added.
	(LoadDialogSetup): use "LoadPathStr".

2012-08-24  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11view.c (graph_dropped): use "loadpath" instead of
	"ignorepath".

	* src/gtk/x11menu.c (application): use "loadpath" instead of
	"ignorepath".

	* src/gtk/x11commn.c (LoadNgpFile): use "loadpath" instead of
	"ignorepath" and "expandtofullpath".

	* src/gtk/x11opt.c (MiscDialogSetupItem, MiscDialogSetup)
	(MiscDialogClose): use "loadpath" instead of "ignorepath".

	* src/gtk/x11graph.c (LoadDialogSetup, LoadDialogClose)
	(CmGraphLoad, CmGraphHistory): use "load_path" instead of
	"ignore_path".

2012-08-23  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11opt.c (MiscDialogSetupItem, MiscDialogSetup)
	(MiscDialogClose): add UI for "Menulocal.select_data".

	* src/gtk/x11view.c (Draw): call "FileWinUpdate()".

	* src/gtk/x11dialg.h (MiscDialog): add member "select_data".

	* src/gtk/ox11menu.h (menulocal): add member "select_data".

	* src/gtk/ox11menu.c (menuinit): initialize
	"Menulocal.select_data".

	* src/gtk/x11print.c (CmOutputPrinter, CmOutputDriver)
	(CmPrintGRAFile, CmOutputImage, CmOutputEMF): call
	"FileWinUpdate()".
	(CmOutputDriver, CmPrintGRAFile, CmOutputImage, CmOutputEMF):
	check "Menulocal.select_data".

	* src/gtk/x11commn.c (SetFileHidden): call "set_graph_modified()"
	if necessary.

2012-08-21  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11gui.c (get_filename_with_ext): added.
	(FileSelectionDialog): use "get_filename_with_ext()".

2012-08-16  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11cood.c (CmCoordinateWindow): don't call functions
	"sub_window_show_all()", "sub_window_set_geometry()".

	* src/gtk/x11file.c (CmFileWindow): don't call functions
	"sub_window_show_all()", "sub_window_set_geometry()" and
	"FileWinUpdate()".

	* src/gtk/x11axis.c (CmAxisWindow): don't call functions
	"sub_window_show_all()", "sub_window_set_geometry()" and
	"AxisWinUpdate()".

	* src/gtk/x11merge.c (CmMergeWindow): don't call functions
	"sub_window_show_all()", "sub_window_set_geometry()" and
	"MergeWinUpdate()".

	* src/gtk/x11lgnd.c (CmLegendWindow): don't call functions
	"sub_window_show_all()", "sub_window_set_geometry()" and
	"LegendWinUpdate()".

	* src/gtk/gtk_subwin.c (sub_window_show_all): static function.
	(sub_window_set_visibility): realize a window when the window is
	not realized.

	* src/gtk/x11menu.c (create_sub_windows): call
	"CmInformationWindow()", "CmCoordinateWindow()", "CmMergeWindow",
	"CmLegendWindow()", "CmAxisWindow()" and "CmFileWindow()".

	* src/gtk/x11info.c (create_win): removed.
	(InfoWinDrawInfoText, CmInformationWindow): don't use
	"create_win()".

2012-08-15  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11file.c (FileWinFileEdit, FileWinFileDelete)
	(file_obj_copy, FileWinFileCopy2, FileWinFileUpdate)
	(FileWinFileDraw, FileWinFit, popup_show_cb): use
	"chkobjlastinst()".

	* src/gtk/x11axis.c (axiswin_scale_clear, popup_show_cb)
	(axis_prm_edited_common, axiswin_delete_axis, AxisWinAxisTop)
	(AxisWinAxisLast, AxisWinAxisUp, AxisWinAxisDown): use
	"chkobjlastinst()".

	* src/gtk/x11merge.c (popup_show_cb): use "chkobjlastinst()".

	* src/gtk/x11lgnd.c (rect_size_edited): use "chkobjlastinst()".

	* src/gtk/gtk_subwin.c (file_select, copy, delete, move_top)
	(move_last, move_up, move_down, update, focus, toggle_boolean)
	(modify_numeric, modify_string, hidden, set_hidden_state)
	(list_sub_window_set): use "chkobjlastinst()".

	* src/gtk/x11menu.h (obj_list_data): remove member "num".

2012-08-14  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/terminal.c (sig_handler, my_signal): not used if the os is
	Windows.

2012-08-13  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/ogra2emf.c (open_emf): call "SaveDC()".
	(close_emf): call "RestoreDC()".
	(select_font): "id_font.lfOutPrecision" is "OUT_TT_ONLY_PRECIS".

	* src/gtk/main.c (interruptconsole, reset_fifo, consolesave)
	(consolefd): not used if the os is Windows.

2012-08-12  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/shell.c (set_shell_args): added.

	* src/oshell.c (cmdshell): use "set_shell_args()".

	* src/shellcm.c (cmset): use "set_shell_args()".
	(cmset): options "--" and "-" work as same as bash.

2012-08-11  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/shellcm.c (cmset): "--" means the last argument.

2012-08-10  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/ogra2cairo.c (CompatibleFont): "Mincho" should be
	corresponded to "Seril" and "Gothic" should be corresponded to
	"Sans-serif".

2012-08-09  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/ogra2emf.c (gra2emf_local): add members
	"update_pen_attribute", "update_brush_attribute", "line",
	"null_pen", "the_pen" and "the_brush".
	(gra2emf_init): initialize "null_pen" and "line".
	(gra2emf_done): finalize "null_pen" and "line".
	(open_emf): initialize "update_pen_attribute",
	"update_brush_attribute", "null_pen", "the_pen" and "the_brush".
	(close_emf): finalize "update_pen_attribute",
	"update_brush_attribute", "null_pen", "the_pen" and "the_brush".
	(create_pen): create object only when
	"local->update_pen_attribute" is TRUE.
	(create_brush): added.
	(draw_polygon, draw_polyline, draw_lines): added.
	(gra2emf_output): use "draw_polygon()", "draw_polyline()" and
	"draw_lines()".

	* src/gtk/main.c (check_console): remove unused variable "menu".

	* src/shell.c (cmdexec): remove unused variable "r" (Windows
	only).

	* mingw/windows.sh (DEFS, CCOPT): add compile options.

	* src/gtk/x11menu.c (create_sub_windows): file window, axis
	window, legend window and merge window must be created in this
	function.
	(kill_signal_handler, term_signal_handler): not used when the OS
	is Windows.

2012-08-08  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/ogra2emf.c (draw_text_rect, draw_rectangle): added.
	(draw_str_sub): don't call "SetBkMode()".
	(draw_str_sub): call "draw_text_rect()".
	(check_font_indices): check return value of the function
	"GetGlyphIndicesW()".
	(gra2emf_output): use "SelectClipPath()" instead of
	"SelectClipRgn()".
	(gra2emf_output): use "draw_rectangle()".
	(gra2emf_output): call "SetPolyFillMode()" before drawing path.

	* initfile/Ngraph.ini.win (font): use "batangche" instead of
	"gulimche" for "Serif" font.

2012-08-07  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* driver/ngp2.in: remove EMF output.

	* src/gtk/ogra2emf.c (gra2emf_fontmap, enum_font_cb)
	(get_char_set, fontmap_append, check_fonts, free_fontmap_sub)
	(free_fontmap, add_fontmap, check_font_indices, draw_str_sub)
	(set_alternative_font): added.
	(gra2emf_init): create dumy hdc.
	(gra2emf_done): delete dumy hdc and fontmaps.

2012-08-06  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/ogra2cairo.c (gra2cairo_get_fontmap)
	(gra2cairo_remove_fontmap, gra2cairo_get_compatible_font_info):
	type of the argument is "const char *".

2012-07-29  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/ogra2cairo.c (add_font_map): added.
	(create_font_map): use "add_font_map()".

2012-07-28  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/ogra2emf.c (gra2emf_output): call "SetPolyFillMode()" to
	set fill mode.

2012-07-28  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* initfile/NgraphUI.xml.win: add "GraphExportEMFFileAction" and
	"GraphExportEMFClipboardAction", remove "GraphExportEMFAction" and
	"GraphExportClipboardAction".

	* src/gtk/ogra2emf.c: added.

	* src/gtk/Makefile.am (libngraph_la_SOURCES): add "ogra2emf.c".

	* src/gtk/x11print.c (OutputImageDialogSetupItem)
	(OutputImageDialogSetup, OutputImageDialogClose, CmOutputImage):
	don't handle "MenuIdOutputEMFFile" and "MenuIdOutputEMFClipboard".
	(CmOutputEMF): added.

	* src/gtk/x11menu.h (MenuID): add "MenuIdOutputCairoEMFFile",
	"MenuIdOutputEMFFile" and "MenuIdOutputEMFClipboard", remove
	"MenuIdOutputClipboard".

	* src/gtk/x11menu.c (NgraphActionEntry): change name from
	"GraphExportEMFAction" to "GraphExportCairoEMFAction", add
	"GraphExportEMFFileAction" and "GraphExportEMFClipboardAction".

	* src/gtk/main.c (obj_add_func_ary): add function "addgra2emf".

2012-07-27  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/ogra2cairofile.c (surface_type, open_emf, close_emf)
	(create_cairo): remove clipboard output.

	* src/gra.c (GRAreopen): width and height of the paper should be
	"GRAClist[GC].width+GRAClist[GC].leftm" and
	"GRAClist[GC].height+GRAClist[GC].topm" respectively.
	(GRAinit): width and height of the drawing region should be
	"width-leftm" and "height-topm" respectively.

2012-07-26  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/ox11menu.c (mxflush): call "cairo_surface_flush()".

	* src/gtk/ogra2cairo.c (gra2cairo_flush): call
	"cairo_surface_flush()".
	(gra2cairo_output): fix typo ("tmp2" to "tmp").

2012-07-23  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/ogra2cairo.c (gra2cairo_get_utf8_str): added.
	(gra2cairo_output): use "gra2cairo_get_utf8_str()".

	* src/gtk/ox11menu.c (menuinit): set default dpi of an EMF file as
	576.

2012-07-18  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* pathconv.sh (LC_ALL): set as "C" and export.

	* src/math/math_scanner.c (get_dec): use function "powl()" only if
	"HAVE_POWL" is defined.

	* src/gtk/ox11menu.c (graph_modified_sub): don't call
	"SetCaption()" and "set_modified_state()".
	(mxmodified): call "set_modified_state()".

	* configure.in (AC_CHECK_HEADERS): check "readline.h".

2012-07-10  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/ogra2cairofile.c (open_emf): remove parameters "fname"
	and "clipboard".
	(close_emf): change second parameter from "clipboard" to "fname".
	(gra2cairofile_output): check return value of the function
	"close_emf()".

2012-07-09  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/ox11menu.c (menuinit): set default dpi of an EMF file as
	600.

	* src/gtk/ogra2cairofile.c (create_reference_dc): removed.
	(open_emf): use display device as referencs DC. use
	"SetWorldTransform()" to scale image.

2012-07-06  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11lgnd.c (path_list_set_val): set columns
	"PATH_LIST_COL_X", "PATH_LIST_COL_Y" and "PATH_LIST_COL_POINTS" at
	once.

	* src/gtk/ogra2cairofile.c (open_emf, close_emf): added.
	(create_cairo): use "open_emf()".
	(gra2cairofile_output): use "close_emf()".

2012-07-05  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/ogra2cairofile.h (surface_type_id): add "TYPE_CLIPBOARD".

	* src/gtk/ogra2cairofile.c (surface_type, create_cairo)
	(gra2cairofile_output): support clipboard.

	* src/gtk/x11menu.h (MenuID): add "MenuIdOutputClipboard".

	* src/gtk/x11menu.c (ActionEntry): add clipboard action.

	* src/gtk/x11print.c (OutputImageDialogSetupItem)
	(OutputImageDialogSetup, OutputImageDialogClose)
	(CmOutputImage, CmOutputMenu): support clipboard.

	* initfile/NgraphUI.xml.win: add clipboard menu.

2012-07-03  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11lgnd.c (create_mark_color_combo_box)
	(create_color_combo_box): change order of items.

	* src/gtk/x11file.c (create_type_color_combo_box): change order of
	items.

012-07-02  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11file.c (create_type_combo_box): use
	"combo_box_create_mark()".
	(create_type_combo_box): set visibility of toggle and pixbudf
	column.
	(select_type): use "select_obj_color()".
	(start_editing_type, start_editing): use
	"tree_view_get_selected_row_int_from_path()".
	(CmFileWindow): set "foreground" attribute column.

	* src/gtk/gtk_liststore.h (_list_store): the member "color" is
	removed.

	* src/gtk/gtk_liststore.c (create_object_cbox): add columns to
	show toggle item and set visibility of toggle and pixbuf column.
	(create_tree_view): don't create invisible column.
	(tree_view_get_selected_row_int_from_path): added.

	* src/gtk/gtk_widget.h (OBJ_FIELD_COLOR_TYPE): added.

	* src/gtk/gtk_widget.c (combo_box_create_mark, select_obj_color):
	added.

	* src/gtk/x11lgnd.c (get_points): get number of points.
	(draw_color_pixbuf): added.
	(path_list_set_val): support type of interpolation.
	(path_list_set_val): show number of points.
	(rect_list_set_val, arc_list_set_val): line type is shown as
	image.
	(draw_mark_pixbuf): added.
	(mark_list_set_val): use "draw_mark_pixbuf()".
	(rect_size_edited): use
	"tree_view_get_selected_row_int_from_path()".
	(LEGEND_COMBO_ITEM, create_mark_color_combo_box)
	(create_color_combo_box, select_type, select_color)
	(start_editing_common, start_editing_mark, start_editing_color)
	(select_line_type, start_editing_line_type, edited_line_type)
	(start_editing_font, edited_font): added.
	(CmLegendWindow): set callback functions to columns.

2012-07-01  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11file.c (select_color): removed.

	* src/gtk/x11lgnd.c (mark_list_set_property)
	(legend_list_set_color): removed.

2012-07-01  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/ofile.c (nstrrchr, get_filename_last_index): added.
	(f2dload_sub): use "get_filename_last_index()" instead of
	"getitok2()".

2012-06-24  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11lgnd.c (get_points): only get first point.
	(path_list_set_property, text_list_set_property): removed.
	(path_list_set_val): support "PATH_LIST_COL_TYPE" and
	"PATH_LIST_COL_ARROW".
	(text_list_set_val): support "TEXT_LIST_COL_TEXT" and
	"TEXT_LIST_COL_FONT".

	* src/gtk/gtk_subwin.c (select_enum, start_editing_enum, enum_cb):
	added.
	(start_editing, set_cell_renderer_cb): support G_TYPE_ENUM.
	(set_combo_cell_renderer_cb): check and save "list[i].edited_id".

	* src/gtk/x11file.c (Flist): change type of the columns "ax" and
	"ay" from G_TYPE_ENUM to G_TYPE_PARAM.

	* src/gtk/gtk_liststore.c (create_column, create_tree_view): check
	"G_TYPE_PARAM".

	* src/gtk/x11axis.c (start_editing, select_type, edited): removed.
	(CmAxisWindow): don't call "set_combo_cell_renderer_cb()".

	* src/gtk/x11view.c (ViewerEvLButtonDown, ViewerEvLButtonUp)
	(ViewerEvMouseMove): treat "MOUSESCROLLE".

	* src/gtk/x11menu.h (MouseMode): add "MOUSESCROLLE".

2012-06-23  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/gtk_subwin.c (sub_window_get_nth_content)
	(tree_get_selected, tree_copy, tree_delete, tree_move_top)
	(tree_move_last, tree_move_up, tree_move_down, tree_update)
	(tree_focus, tree_hidden, tree_set_hidden_state)
	(ev_key_down_tree): removed.
	(start_editing): accepts legend window.
	(toggle_cb): use "g_object_get_data()" and "toggle_boolean()".
	(set_cell_renderer_cb, set_editable_cell_renderer_cb)
	(set_combo_cell_renderer_cb, set_obj_cell_renderer_cb): change
	type of the firest parameter from "struct SubWin *" to "struct
	obj_list_data *".
	(cb_destroy): free data.data member of the "SubWin" struct.
	(copy, delete, move_top, move_last, move_up, move_down, update)
	(focus, modify_numeric, modify_string, hidden, set_hidden_state):
	change type of the firest parameter from "struct SubWin *" to
	"struct obj_list_data *".
	(toggle_boolean): added.
	(do_popup): change type of the second parameter from "struct
	SubWin *" to "struct obj_list_data *".
	(do_popup): accepts legend window.
	(sub_window_create): remove last parameter.
	(sub_window_create): don't create scrolled window.
	(text_sub_window_create, label_sub_window_create): create scrolled
	window.
	(list_widget_create): added.
	(list_sub_window_create, tree_sub_window_create): use
	"list_widget_create()".
	(list_sub_window_must_rebuild, list_sub_window_build)
	(list_sub_window_set, sub_win_create_popup_menu): change type of
	the second parameter from "struct SubWin *" to "struct
	obj_list_data *".

	* src/gtk/x11axis.c (AxisDialog): change type of the firest
	parameter from "void *" to "struct obj_list_data *" and remove
	second parameter.
	(AxisWinUpdate): add parameter "struct obj_list_data *".
	(AxisDelCB): added.
	(axis_list_set_val, pos_edited_common, axis_prm_edited_common)
	(axiswin_delete_axis): change type of the firest parameter from
	"struct SubWin *" to "struct obj_list_data *".
	(CmAxisWindow): use "AxisDelCB" instead of
	"AxisDel".

	* src/gtk/x11lgnd.c (Plist, Alist, Rlist, Mlist, Tlist): added.
	(Llist): removed.
	(LegendWinPathUpdate, LegendWinRectUpdate, LegendWinArcUpdate)
	(LegendWinMarkUpdate, LegendWinTextUpdate): added.
	(LegendWinLegendUpdate): removed.
	(ObjListUpdate, PathListUpdate, ArcListUpdate, RectListUpdate)
	(MarkListUpdate, TextListUpdate): added.0
	(legend_list_set_color): change type of the firest parameter from
	"struct LegendWin *" to "struct obj_list_data *" and remove second
	parameter.
	(path_list_set_property, mark_list_set_property)
	(text_list_set_property, path_list_set_val, rect_list_set_val)
	(arc_list_set_val, mark_list_set_val, text_list_set_val): added.
	(legend_list_set_val): removed.
	(popup_show_cb): use "list_store_get_selected_int()" instead of
	"tree_store_get_selected_nth()".
	(pos_edited): get column number from the "title" member of
	"n_list_store".
	(pos_edited): use "gtk_tree_model_get_iter_from_string()" to get
	current row instead of "gtk_tree_path_new_from_string()".
	(rect_size_edited, rect_width_edited, rect_height_edited): added.
	(width_edited): removed.

	* src/gtk/x11file.c (FileDialog): change type of the firest
	parameter from "void *" to "struct obj_list_data *" and remove
	second parameter.
	(FileWinFileEdit, file_obj_copy, FileWinFileCopy)
	(FileWinFileUpdate, FileWinFileDraw, FileWinFit)
	(file_list_set_val): change type of the firest parameter from
	"struct SubWin *" to "struct obj_list_data *".
	(delete_file_obj, FileWinUpdate): add parameter "struct
	obj_list_data *".

	* src/gtk/x11menu.h (obj_list_data): added.
	(SubWin): use "struct obj_list_data *".
	(LegendWin): removed.

	* src/gtk/gtk_liststore.c (create_column): set "user-data" to
	"GtkCellRendererToggle" when the column is editable.

	* src/gtk/x11merge.c (merge_list_set_val): change type of the
	firest parameter from "struct SubWin *" to "struct obj_list_data *".
	(MergeDialog): change type of the firest parameter from "void *"
	to "struct obj_list_data *".
	(MergeWinUpdate): add parameter "struct obj_list_data *".

	* src/omark.c (marktype): moved to "oroot.c".

	* src/oroot.c (oputmarktype): moved and renamed from "omark.c".

	* src/ofile.c (file_marktype): use "MARK_TYPE_NUM".
	(file2d): check argument of the field "mark_type".

2012-06-20  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/main.c (HAVE_READLINE_READLINE_H): used instead of
	"HAVE_LIBREADLINE".

	* src/gtk/ox11menu.c (HAVE_READLINE_READLINE_H): used instead of
	"HAVE_LIBREADLINE".

	* src/shell.c (getcmdline): use global valuable "Multiline" only
	when "HAVE_READLINE_READLINE_H" is defined.
	(HAVE_READLINE_READLINE_H): used instead of "HAVE_LIBREADLINE".

	* configure.in (READLINE_LIBS): defined when readline library is
	installed.
	(AC_CHECK_HEADERS): check "readline/readline.h"

2012-06-16  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11opt.c (SetScriptDialogSetupItem): addin selection
	combobox is always available.

	* addin/fig2gra.rb: support Ruby 1.9.

2012-06-15  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11axis.c (baseline_tab_create): don't call
	"gtk_widget_set_size_request()".

	* src/gtk/x11menu.c (setupwindow): call "gtk_toolbar_set_style()"
	when the version of GTK+ is greater or equal to 3.4.0.

2012-06-14  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* addin/text-in.nsc: vertical offset of text can be changed.

2012-06-13  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* driver/ngp2.in: accepts "-emf" option if EMF output is
	supported.

	* src/gtk/ox11dlg.c (dlginput): argument of the field is used as
	initial string of the text entry.

	* src/gtk/x11gui.c (DialogInput): add parameter "init_str".

	* addin/math.nsc: retry when error will be occurred.

	* src/gtk/ogra2cairo.c (gra2cairo_output): don't call
	"cairo_save()" on the 'I' command.

2012-06-12  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* driver/ngp2.in (save_gra): copy field of "gra:viewer".

	* src/gtk/ox11menu.c (mx_clear): call "cairo_reset_clip()" before
	call "cairo_paint()".

2012-06-11  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* zsh/Makefile.am (dist_zsh_DATA): use "dist_" prefix.

	* pixmap/Makefile.am (dist_pixmap_DATA): use "dist_" prefix.

	* initfile/Makefile.am (dist_ngraphconf_DATA): use "dist_" prefix.

	* doc/html/ja/tutorial/Makefile.am (dist_htmltutorial_DATA): use "dist_" prefix.

	* doc/html/ja/dialogs/Makefile.am (dist_htmldialog_DATA): use "dist_" prefix.

	* doc/html/img/Makefile.am (dist_htmlimg_DATA): use "dist_" prefix.

	* doc/html/Makefile.am (dist_html_DATA): use "dist_" prefix.

	* demo/Makefile.am (.ngp.in.ngp): use suffix rule.

2012-06-09  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11view.c (show_move_animation, mouse_down_zoom)
	(ViewerEvMButtonDown): disable move animation.

2012-06-07  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* addin/ps2gra.nsc (gra_file): check overwrite.

2012-06-06  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* addin/ps2gra.nsc: add import pdf menu.

	* addin/fig2gra.rb: print creator comment.

	* addin/fig2gra.nsc (fig2gra): print creator comment.

2012-06-06  Koichi Akabe  <vbkaisetsu at gmail.com>

	* demo/Makefile.am (CLEANFILES): add "demo6.ngp"

2012-06-05  Koichi Akabe  <vbkaisetsu at gmail.com>

	* debian/ngraph-gtk.install: add scalable icons.

	* misc/ngraph.desktop (Icon): add scalable icons.

	* configure.in: add scalable icons.

	* icons/scalable/mimetypes/application-x-ngraph.svg: added.

	* icons/scalable/mimetypes/application-x-ngraph-script.svg: added.

	* icons/scalable/mimetypes/application-x-ngraph-graphic.svg: added.

	* icons/scalable/mimetypes/Makefile.am: added.

	* icons/scalable/apps/ngraph.svg: added.

	* icons/scalable/apps/Makefile.am: added.

	* icons/scalable/Makefile.am: added.

2012-06-03  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* addin/fig2gra.nsc (fig2gra): accepts dummy option "-dummy".

	* addin/tex_equation.nsc: addin scripts are installed not in the
	directory "$NGRAPHLIB" but "${system::data_dir}/addin".

	* addin/ps2gra.nsc: addin scripts are installed not in the
	directory "$NGRAPHLIB" but "${system::data_dir}/addin".

2012-05-30  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11print.c (CmOutputViewerB): set "width" and "height"
	fields of the "gra2dtk" object.

	* src/gtk/ox11menu.h (SAVE_CONFIG_TYPE_X11MENU): add
	"SAVE_CONFIG_TYPE_EXTERNAL_VIEWER".

	* src/gtk/ox11menu.c (exwinloadconfig): removed.
	(MenuConfigExiView): added.
	(MenuConfigArrray): add "MenuConfigExiView".
	(menu_save_config): check "SAVE_CONFIG_TYPE_EXTERNAL_VIEWER".
	(menuinit): initialize "Menulocal.exwindpi",
	"Menulocal.exwinwidth" and "Menulocal.exwinheight".

	* src/gtk/x11lgnd.c (format_value_percent, format_value_degree):
	added.
	(LegendArrowDialogSetup): connect "format_value_degree" and
	"format_value_percent" to the "format-value" signal.

	* src/gtk/ogra2x11.c (gtkloadconfig): removed.
	(gra2gtk): add fields "width" and "height".
	(gtkinit): use "gtk_window_set_default_size()" instead of
	"gtk_widget_set_size_request()".
	(gtk_set_size): added.

	* src/gtk/x11opt.c (add_str_with_int_to_array)
	(save_ext_viewer_config): removed.
	(ViewerDialogSetup): change layout.

2012-05-26  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* addin/fitrslt.c: don't use deprecated functions.

	* addin/addin_common.c: don't use deprecated functions.

	* addin/calc.c (create_control): don't use deprecated functions.

	* addin/legend.c: don't use deprecated functions.

	* src/gtk/gtk_subwin.c (label_sub_window_create): use
	"gtk_widget_set_halign()" and "gtk_widget_set_valign()" instead of
	"gtk_misc_set_alignment()".

	* src/gtk/x11lgndx.c (LegendGaussDialogSetup): don't use
	deprecated functions.

	* src/gtk/ogra2x11.c (gtkinit): don't use deprecated functions.

	* src/gtk/x11axis.c (GridDialogSetup, SectionDialogSetup)
	(CrossDialogSetup, ZoomDialogSetup, scale_tab_create)
	(baseline_tab_create, gauge_tab_create, numbering_tab_create)
	(font_tab_create, position_tab_create): don't use deprecated
	functions.

	* src/gtk/gtk_widget.c (add_widget_to_table_sub)
	(add_copy_button_to_box, item_setup)
	(create_text_view_with_line_number): don't use deprecated
	functions.

	* src/gtk/x11print.c (DriverDialogSetup, OutputDataDialogSetup):
	don't use deprecated functions.

	* src/gtk/x11lgnd.c (points_setup): call
	"gtk_tree_view_column_set_expand()".
	(points_setup, LegendArrowDialogSetup, LegendRectDialogSetup)
	(LegendArcDialogSetup, LegendMarkDialogSetup)
	(legend_dialog_setup_sub, LegendTextDialogSetup)
	(LegendTextDefDialogSetup): don't use deprecated functions.

	* src/gtk/x11dialg.c (SelectDialogSetup): don't use deprecated
	functions.

	* src/gtk/x11file.c (MathTextDialogSetup, MathDialogSetup)
	(FitSaveDialogSetup, create_user_fit_frame, FitDialogSetup)
	(move_tab_create, mask_tab_create, load_tab_create)
	(math_tab_create, button_set_mark_image, MarkDialogSetup)
	(plot_tab_create, FileDialogSetupCommon, FileDialogSetup): don't
	use deprecated functions.
	(set_fitdialog_sensitivity): set sensitivity of initial value
	input for user function.
	(FitDialogSetSensitivity): call "check_fit_func()".

	* src/gtk/x11view.c (EvalDialogSetup): don't use deprecated
	functions.

	* src/gtk/x11commn.c (ProgressDialogCreate): don't use deprecated
	functions.

	* src/gtk/x11menu.c (create_message_box, setupwindow): don't use
	deprecated functions.

	* src/gtk/x11opt.c (SetScriptDialogSetup, SetDriverDialogSetup)
	(FontSettingDialogSetup, PrefFontDialogSetup, MiscDialogSetup)
	(ExViewerDialogSetup, ViewerDialogSetup): don't use deprecated
	functions.

	* src/gtk/x11graph.c (PageDialogSetup, SwitchDialogSetup)
	(DirectoryDialogSetup, LoadDialogSetup, PrmDialogSetup)
	(SaveDialogSetup): don't use deprecated functions.

	* src/gtk/x11merge.c (MergeDialogSetup): don't use deprecated
	functions.

2012-05-23  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/shell.c (set_shellevloop, nreadline): use "g_thread_new()"
	instead of "g_thread_create()" when the version of glib is greater
	or equal to 2.32.

	* src/gtk/main.c (main): don't use duplicate function
	"g_thread_init()" if the version of glib is greater or equal to
	2.32.

	* src/gtk/x11view.c (draw_cairo_arc): check if radius is not less
	than 1.
	(ViewerEvScroll): check "e->state" when "e->direction" is
	"GDK_SCROLL_SMOOTH".

2012-05-22  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11view.c (scrollbar_scroll_cb): handle
	"GDK_SCROLL_SMOOTH".
	(ViewerEvScroll): multiply "x" and "y" by "SCROLL_INC" when the
	direction is "GDK_SCROLL_SMOOTH".

	* src/gtk/gtk_widget.c (set_adjustment): added.
	(text_view_scroll_event): handle "GDK_SCROLL_SMOOTH".
	(text_view_scroll_event): use "set_adjustment()".

2012-05-16  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11menu.c (detach_toolbar, create_toolbar_box): not used
	if the version of GTK+ is greater or equal to 3.4.
	(setupwindow): don't use GtkHandleBox.

	* src/gtk/gtk_widget.c (show_color_sel, create_color_button): set
	tool-tip.

	* src/gtk/x11file.c (select_color): use GtkColorChooserDialog when
	the version of GTK+ is greater or equal to 3.4.

	* src/gtk/x11view.c (EvalDialogSetup): change default width of the
	window.
	(show_zoom_animation, show_move_animation): call
	"cairo_set_source()" only once.

2012-05-11  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/gtk_widget.h (NUM_ENTRY_WIDTH): change width of entries.

	* src/gtk/gtk_widget.c (create_direction_entry): change width of
	the entry.
	(show_color_sel, color_button_key_event): not used if the version
	of GTK+ is greater or equal to 3.4.

	* src/gtk/ox11menu.c (get_palette, set_palette): not used if the
	version of GTK+ is greater or equal to 3.4.

	* src/gtk/x11dialg.c (_set_color, _putobj_color): use
	"GtkColorChooser" if the version of GTK+ is greater or equal to
	3.4.

	* src/gtk/x11axis.c (position_tab_create): change width of the
	"Adjust:" entry.

	* src/gtk/x11opt.c (ViewerDialogSetupItem, ViewerDialogClose): use
	"GtkColorChooser" if the version of GTK+ is greater or equal to
	3.4.

	* src/gtk/x11view.c (PasteObjectsFromClipboard): use
	"gdk_window_get_device_position()" instead of
	"gtk_widget_get_pointer()" if the version of GTK+ is greater or
	equal to 3.4.
	(ViewerWinSetup): add "GDK_SCROLL_MASK" and
	"GDK_SMOOTH_SCROLL_MASK".
	(ViewerEvScroll): add case for "GDK_SCROLL_SMOOTH".

2012-05-09  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11view.c (calc_mouse_x, calc_mouse_y): added.
	(text_dropped, mouse_up_point, mouse_up_drag, mouse_up_change)
	(mouse_up_lgend1, mouse_up_lgend2, update_frame_rect)
	(mouse_move_drag, mouse_move_change, ViewerEvMouseMove)
	(SetVRuler, SetHRuler): use "calc_mouse_x()" and/or
	"calc_mouse_y()".

2012-05-08  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/math/math_basic_function.c (math_func_rand): use
	"g_random_double()".
	(math_func_srand): use "g_random_set_seed()".
	(create_random_buf): removed.

2012-05-01  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11view.c (show_zoom_animation, show_move_animation):
	don't call "gdk_window_invalidate_rect()".
	(ViewerEvPaint): check "ZoomLock".

2012-04-27  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11view.c (mouse_down_zoom): now cursor position is
	static.
	(ViewerEvScroll): control + wheel works as zoom.
	(get_range_max): added.
	(ChangeDPI): use "get_range_max()".
	(show_zoom_animation, show_move_animation): added.
	(mouse_down_zoom): use "show_zoom_animation()" and
	"show_move_animation()".
	(ViewerEvMButtonDown): use "show_move_animation()".

	* src/gtk/x11menu.h (Viewer): remove members "hupper" and
	"vupper".

2012-04-26  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11view.c (ChangeDPI): use "nround()" to avoid floating
	point error when calculating scroll position.

2012-04-22  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/shell.c (remove_duplicate_history): added.
	(shget): combine multi-line input.
	(getcmdline, checkcmd): set "MultiLine" state.

2012-04-20  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/shell.c (checkcmd, gettok): accepts here-document "<<-".

2012-04-19  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/shellux.c (SleepThread): argument of the function "Sleep()"
	is milliseconds.

2012-04-14  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* misc/ngraph.keys: filename is changed from "ngraph.key".

	* misc/ngraph.desktop (Exec): special field code "%f" is added.

2012-04-11  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* addin/ps2gra.nsc: fix error message.

	* src/ofile.c (rectout): use "GRAdrawpoly()" instead of
	"GRArectangle()".
	(draw_rect): added.
	(barout): use "draw_rect()" instead of "GRAdrawpoly()" when draw
	outline of the bar.

2012-04-07  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/ofile.c (poly_add_elements): fix calculation to avoid
	influence of floating point error.

2012-04-06  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/math/math_scanner.c (get_dec): fix calculation to reduce
	floating point error.

2012-04-05  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/ofile.c (file_color, file_alpha, file_rgb_sub)
	(file_hsb_sub, file_marksize, file_marktype): check parameters are
	normal value or not.
	(draw_polygon): added.
	(polyout): use "draw_polygon()".
	(accept_ascii_only): added.
	(file2d): "ifs" and "remark" fields are accepts only printable
	ascii character.
	(check_ifs_init): check if the index of the array is positive.

2012-04-04  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* demo/Makefile.am: add settings for demo#6.

	* demo/demo.ngp.in: add demo#6.

	* demo/demo6.dat: added.

	* demo/demo6.ngp.in: added.

	* src/ofile.c (uniq_points): fix index pf the array.

2012-04-03  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/ofile.c (poly_add_point, poly_add_clip_point)
	(poly_pos_sort_cb, poly_set_pos, poly_add_elements): added.
	(polyout): remove parameters related to line attributes.

	* src/gtk/x11file.c (FileWinUpdate): don't use "FileWinExpose()".
	(FileWinExpose): removed.
	(CmFileWindow): don't connect "draw" or "expose-event" signal.
	(CmFileWindow): call "FileWinUpdate()".

	* src/gtk/x11axis.c (AxisWinUpdate): don't use "AxisWinExpose()".
	(AxisWinExpose): removed.
	(CmAxisWindow): don't connect "draw" or "expose-event" signal.
	(CmAxisWindow): call "AxisWinUpdate()".

	* src/gtk/x11merge.c (MergeWinUpdate): don't use "MergeWinExpose()".
	(MergeWinExpose): removed.
	(CmMergeWindow): don't connect "draw" or "expose-event" signal.
	(CmMergeWindow): call "MergeWinUpdate()".

	* src/gtk/x11lgnd.c (LegendWinUpdate): don't use "LegendWinExpose()".
	(LegendWinExpose): removed.
	(CmLegendWindow): don't connect "draw" or "expose-event" signal.
	(CmLegendWindow): call "LegendWinUpdate()".

2012-03-30  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* addin/legend.c (makescript): add condition to check plot type
	"polygon_solid_fill".

	* src/ofile.h (FILE_OBJ_PLOT_TYPE): add plot type
	"polygon_solid_fill".

	* src/ofile.c (f2dtypechar): add plot type "polygon_solid_fill".
	(add_polygon_point, remove_same_points, polyout): added.
	(f2ddraw): add case "PLOT_TYPE_POLYGON_SOLID_FILL".

	* src/gtk/x11file.c (FileDialogType): add case
	"PLOT_TYPE_POLYGON_SOLID_FILL".
	(draw_type_pixbuf): simplify conditions.
	(create_type_combo_box): suffix of the array "curvelist" is not
	"i" but "j".

2012-03-29  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/ofile.c (f2dgetcoord): call "arraydel()" when the number of
	elements is greater than zero.

2012-03-28  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* addin/fitrslt.nsc: use int object to count number of fitting
	plots.

	* addin/text-in.nsc: an id of a file instance can be selected. use
	"dialog::integer_entry" to specify column number. use color of the
	file object as text color.

	* doc/html/ja/addin.html: update document.

	* doc/html/ja/script.html.in: update document.

	* doc/html/ja/object.html.in: add link to title of each object.

	* doc/html/objlist.nsc: add link to title of each object.

	* initfile/Ngraph.nsc (append_addin_list): check size of the
	sarray object.

	* src/gtk/ox11menu.c (mx_addin_list_append): check return value of
	the function "getobj()".
	(mx_addin_list_append): don't modify sarray object.

2012-03-27  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/main.c (set_dir_defs): use function "g_locale_to_utf8()"
	instead of "g_locale_from_utf8()".

	* src/gtk/ox11menu.c (mx_addin_list_append): check if strings are
	valid UTF-8.

	* src/gtk/x11opt.c (remove_char): added.
	(SetScriptDialogSetupItem): use "remove_char()".

2012-03-25  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11opt.c (SetScriptDialogSetupItem): use basename of the
	add-ins as add-in combo-box.

2012-03-23  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11dialg.h (SetScriptDialog): add member "assins".

	* src/gtk/ox11menu.h (menulocal): add member "addin_list".

	* src/gtk/ox11menu.c (gtkmenu): add field "addin_list_append".
	(mx_addin_list_append, free_script_list): added.
	(menulocal_finalize): use "free_script_list()".

	* src/gtk/x11opt.c (active_script_changed): added.
	(SetScriptDialogSetupItem): initialize addin combo box.
	(SetScriptDialogSetup): add addin combo box.

	* initfile/Ngraph.nsc (append_addin_list): added.

2012-03-16  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/math/math_expression.c (math_expression_calculate, calc):
	"val->type" is always "MATH_VALUE_ERROR" when an error is occurred
	during calculation.
	(FACT_MAX): added.
	(calc): the operator "!" accepts a number lesser then "FACT_MAX".

	* src/math/math_basic_function.c (math_func_choose): added.
	(create_random_buf): added.
	(math_func_rand, math_func_srand): use functions included in GSL
	if available.

	* src/shellcm.c (cmdexpr): use "%.0f" instead of "%d" for "iexpr"
	command.
	(cmdexpr): use "round()" instead of "nround()" for "iexpr"
	command.

2012-03-14  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* debian/control (Build-Depends): add "libreadline6-dev".

2012-03-07  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* addin/addin_common.c (fgets_str): return NULL instead of 0.

2012-02-28  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11print.c (init_print): removed.

2012-02-22  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11lgnd.c (LegendArrowDialogSetup)
	(LegendRectDialogSetup, LegendMarkDialogSetup)
	(LegendTextDialogSetup, LegendArcDialogSetup): add delete button
	again.

	* src/ofile.c (set_data_progress): consider "fp->bufnum".
	(getdata_skip_step): call "set_data_progress()".
	(getdata_sub1): check return value of the function
	"getdata_sub2()".

	* addin/fitrslt.c (savescript): width of the frame is now a
	multiple of 100.

	* addin/legend.c (savescript): width of the frame is now a
	multiple of 100.

2012-02-21  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11file.c (FitDialogSetupItem)
	(FitDialogSetSensitivity): set "user_func" field aftr setting of
	"derivative".
	(check_fit_func): added.
	(create_user_fit_frame): connect "changed" signal to the function
	"check_fit_func()".
	(create_user_fit_frame): connect "focus-in" signal to the function
	"func_entry_focused()".
	(FitDialogResult): 4th argument of the function
	"math_equation_add_parameter()" should be 2.
	(func_entry_focused): use parameter "user_data" as a instance of
	the "GtkEntryCompletion".
	(FitDialogApply): save user fitting function to the history.

	* src/gtk/x11menu.h (NgraphApp): add member "fit_list".

	* src/gtk/x11menu.c (FIT_HISTORY): added.
	(load_hist, save_entry_history): load and save history of user
	fitting functions.

2012-02-16  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* mingw/windows_make.sed: update install path.

	* initfile/Ngraph.ini.win: the first line should be blank or
	comment.

	* src/gtk/main.c: add global variable "ADDINDIR"(only for
	Windows).

2012-02-15  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* doc/html/index.html: remove English documents from the package.

	* doc/html/Makefile.am: remove English documents from the package.

	* src/gtk/x11graph.c (check_help_file): default language of the
	help file is Japanese.

	* configure.in: remove English documents from the package.

	* src/gtk/gtk_entry_completion.c (add_completion): check if the
	string is valid UTF8.

2012-02-14  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/gtk_entry_completion.c (add_completion): use
	"g_strchomp()".

	* misc/debian/ngraph-gtk.install: update install directory of
	demonstration files.

	* misc/debian/ngraph-gtk-addins.install: update install directory.

	* misc/debian/watch (http): fix URL.

	* misc/debian/rules: remove rule "override_dh_compress".

	* misc/debian/control (Description): fix description of addin package.

	* mingw/windows_make.sed: change "pkgdatadir".

	* addin/Makefile.am (addindir): added.

	* src/osystem.c (sysinit): free string set to the field "doc_dir".
	(nsystem): add field "doc_dir".

	* src/shell.c (ngraphenvironment): add "addin" to the "PATH"
	environment instead of "data".

	* src/gtk/dir_defs.h.in (ADDINDIR): added.

	* src/gtk/main.c (set_dir_defs): initialize "ADDINDIR".
	(set_path_env): add "ADDINDIR" to the "PATH" environment instead
	of "DATADIR".
	(main): initialize "doc_dir" field of the system object.

	* demo/Makefile.am (demodir): change install directory to "pkgdatadir".

2012-02-13  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* mingw/associate.bat: change line feed code.

	* mingw/echo.nsc: show program neme and version.

2012-02-10  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/dir_defs.h.in: add global variable "NDATADIR" when
	"WINDOWS" is teue.

	* src/shell.c (ngraphenvironment): set "data_dir" of the system
	object to the "PATH" environment.

	* src/gtk/main.c (main): don't call "set_path_env()".
	(main): initialize the "data_dir" field of the system object.

	* src/osystem.c (nsystem): add field "data_dir".
	(sysdone): free string set to the field "data_dir".

	* pathconv.sh: number of the argument is fixed.

	* addin/Makefile.am (dist_pkgdata_DATA): addins are installed in
	"pkgdatadir".

	* misc/debian/ngraph-gtk-addins.install: addins are installed in
	"pkgdatadir".

	* mingw/windows_make.sed: replace "pkglibexecdir" and "pkgdatadir"
	to bin directory and lib directory respectively.

	* mingw/windows.sh: don't move addins to the bin directory. copy
	hicolor icons to share/icons if exist.

2012-02-09  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* misc/debian/ngraph-gtk.install: update path of "pkglibexedir".

	* misc/debian/ngraph-gtk-addins-base.install: update path of "pkglibexedir".

	* misc/debian/ngraph-gtk-addins.install: update path of "pkglibexedir".

	* misc/debian/control (Build-Depends): use debhelper version 9.

	* misc/debian/compat: use version 9.

	* addin/Makefile.am (calc_CFLAGS, fitrslt_CFLAGS): remove option "-D_FORTIFY_SOURCE".
	(dist_pkglibexec_SCRIPTS, pkglibexec_PROGRAMS): installed in pkglibexedir.

	* doc/html/ja/Makefile.am (intro.html): use "pkglibexecdir" instead of "libexecdir".

	* doc/html/en/Makefile.am (intro.html): use "pkglibexecdir" instead of "libexecdi5D5D5Dr".

	* initfile/Makefile.am (Ngraph.ini): use "pkglibexecdir" instead of "libexecdir".

	* src/Makefile.am (ngraph_CFLAGS): remove option "-D_FORTIFY_SOURCE".
	(pkglibexec_PROGRAMS): installed in pkglibexedir.

	* src/math/Makefile.am (libmath_la_CFLAGS): remove option "-D_FORTIFY_SOURCE".

	* src/gtk/Makefile.am (libngraph_la_CFLAGS): remove option "-D_FORTIFY_SOURCE".

2012-02-09  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* addin/legend.c (savescript): add font style setting.

2012-01-31  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11file.c (button_set_mark_image): check return value of
	"gtk_image_new_from_pixbuf()" or "gtk_image_new_from_pixmap()".

2012-01-27  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* mingw/windows.sh: add "--libexecdir" option for "configure"
	script.

	* addin/Makefile.am (dist_libexec_SCRIPTS): used instead of
	"pkglib_DATA".
	(libexec_PROGRAMS): used instead of "pkglib_PROGRAMS".
	(pkglib_SCRIPTS, EXTRA_DIST): removed.

	* doc/html/en/Makefile.am (dist_html_DATA): used instead of
	"html_DATA".
	(nodist_html_DATA, CLEANFILES): added

	* doc/html/ja/Makefile.am (dist_html_DATA): used instead of
	"html_DATA".
	(nodist_html_DATA, CLEANFILES): added

	* initfile/Makefile.am (nodist_ngraphconf_DATA): added.
	(Ngraph.ini): now install directory of the
	"terminal" command is not "lib" but "libexec".
	(CLEANFILES): added.

	* driver/Makefile.am (CLEANFILES): added.

	* src/Makefile.am (libexec_PROGRAMS): now install directory of the
	"terminal" command is not "lib" but "libexec".

	* src/math/Makefile.am (BUILT_SOURCES): added.

	* src/gtk/Makefile.am (nodist_libngraph_la_SOURCES)
	(BUILT_SOURCES, CLEANFILES): added.

	* demo/Makefile.am (nodist_demo_DATA): files "demo[1-4].ngp" are
	not included in tarball.

2012-01-23  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11lgnd.c (set_sensitive_with_label): removed.
	(legend_dialog_set_sensitive): use
	"set_widget_sensitivity_with_label()".

	* src/gtk/x11print.c (OutputImageDialogSetupItem): use functions
	"set_widget_sensitivity_with_label()" and "get_mnemonic_label()".

	* src/gtk/x11opt.c (use_external_toggled, load_file_toggled): use
	function "set_widget_sensitivity_with_label()".

	* src/gtk/x11graph.c (PageDialogPage): use function
	"set_widget_sensitivity_with_label()".

	* src/gtk/x11file.c (set_fitdialog_sensitivity)
	(set_user_fit_sensitivity, FitDialogSetSensitivity)
	(FileDialogType): use function
	"set_widget_sensitivity_with_label()".

	* src/gtk/x11axis.c (bg_button_toggled, num_direction_changed):
	use function "set_widget_sensitivity_with_label()".

	* src/gtk/gtk_widget.c (get_mnemonic_label)
	(set_widget_sensitivity_with_label): added.
	(get_widget): removed.

2012-01-22  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11file.c (FileDialogType): set sensitivity of widgets
	"d->fit" and "d->fit_label".
	(plot_tab_create): initialize "d->fit_label".

	* src/gtk/x11dialg.h (FileDialog): add member "fit_label".

2012-01-21  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11dialg.h (FitDialog): add member "usr_def_prm_tbl".

	* src/gtk/x11file.c (set_fitdialog_sensitivity)
	(FitDialogSetSensitivity): set sensitivity of the widget
	"usr_def_prm_tb".
	(create_user_fit_frame): initialize "usr_def_prm_tbl".

2012-01-20  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11lgnd.c (text_dialog_show_tab): removed.
	(LegendTextDialogSetup): don't connect "show" signal.

	* src/gtk/x11axis.c (scale_tab_create): use "map" signal instead
	of "show" signal.
	(TIME_FORMAT_STR): added.
	(numbering_tab_create): add tool tip for "Date/time format" entry.
	(axis_dialog_show_tab): removed.
	(AxisDialogSetup): don't connect "show" signal.

	* src/gtk/x11file.c (file_dialog_show_tab): removed.
	(FileDialogSetupCommon): don't connect "show" signal.

	* src/gtk/gtk_widget.c (add_copy_button_to_box): use "map" signal
	instead of "show" signal.

2012-01-19  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11dialg.h (AxisDialog): remove member "del_btn" and "CanDel".

	* src/gtk/x11view.c (ViewerAlignType): added.
	(ViewerEvKeyDown): actions related to delete and change order of
	objects are managed in "GtkAction".
	(ViewerPopupMenu): removed.
	(ViewerUpdateCB): added.
	(CmEditMenuCB): manage actions related to change order of an
	object.

	* src/gtk/x11axis.c (AxisDialogSetup): remove redundant call of
	the function "gtk_widget_set_sensitive()".
	(AxisDialog): the parameter "candel" is not used.

	* src/gtk/x11menu.c (ActionEntry): "Edit/drow Order" menu item is added.

	* addin/timer.nsc (rectangle): use "dup" command.

	* src/shell.c (cmdtable): add internal command "dup".

	* src/shellcm.c (cmdup): added.

2012-01-13  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/gtk_subwin.c (cell_focus_out, start_editing): connect
	"cell_focus_out()" to "focus-out-event" only when the version of
	GTK+ is 3.0.

	* src/gtk/gtk_ruler.c (get_thickness): added.
	(nruler_size_request, nruler_draw_ticks, nruler_draw_pos): use "get_thickness()".

2012-01-06  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/ox11menu.c (mx_get_locale): added.
	(gtkmenu): add field "locale".

	* src/gtk/main.c (n_getlocale): added.
	(main): get locale string.

	* src/gtk/x11graph.c (check_help_file): added.
	(CmHelpHelp): use "check_help_file()" to get full-path of help
	file.

2011-12-22  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* addin/legend.c (caption_edited, caption_toggled): remove unused
	variables.

	* addin/addin_common.h (gtk_hbox_new, gtk_vbox_new): don't use
	deprecated functions.

	* src/gtk/gtk_common.h (gtk_hbox_new, gtk_vbox_new)
	(gtk_hbutton_box_new, gtk_hseparator_new, gtk_hscrollbar_new)
	(gtk_vscrollbar_new, gtk_hscale_new_with_range): don't use
	deprecated functions.

	* src/gtk/x11opt.c (FontSettingDialogAddAlternative): use
	"GtkFontChooserDialog" when the version of GTK+ library is greater
	or equal to 3.2.

	* src/gtk/gtk_widget.c (set_linumber_color): use
	"gtk_widget_override_color()" to set color of text. initialize
	"alpha" member of the structure "GdkRGBA". The range of each
	member of the structure "GdkRGBA" is from 0.0 to 1.0.

2011-12-18  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* addin/fitrslt.c (makescript, savescript): use "iarray" object to
	calculate the maximum length of the text.

	* addin/legend.c (caption_toggled, caption_edited): use
	"gtk_tree_model_get()" to get file id.
	(COLUMN_CHECK, COLUMN_ID): added.
	(COLUMN_CAPTION): change name.
	(savescript): use "iarray" object to calculate the maximum length
	of the text.

2011-12-14  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* addin/legend.c (savescript): fix font setting.

2011-12-14  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* addin/tex_equation.nsc: add quotation mark around the variable "$NGRAPHLIB".

	* addin/ps2gra.nsc: add quotation mark around the variable "$NGRAPHLIB".

	* addin/legend.nsc: add quotation mark around the variable "$NGRAPHLIB".

	* addin/fitrslt.nsc: add quotation mark around the variable "$NGRAPHLIB".

	* addin/fft.nsc: add quotation mark around the variable "$NGRAPHLIB".

	* addin/calc.nsc: add quotation mark around the variable "$NGRAPHLIB".

2011-12-07  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* initfile/NgraphUI.xml: remove "View Clear" button.

	* initfile/NgraphUI.xml.win: remove "View Clear" button.

2011-12-06  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* misc/ngraph.1: escape '-'.

	* misc/ngraph.desktop (Encoding): removed.

	* debian/control (Description): add text.

	* src/gtk/x11menu.c (ActionEntry): change menu strings from "Open"
	to "Add".

	* initfile/NgraphUI.xml: chang name of action from
	"DataOpenAction" and "MergeOpenAction" to "DataAddAction" and
	"MergeAddAction" respectively.

2011-12-05  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11file.c (FitDialogSetup, FileDialogSetup): remove
	"Delete" button from dialog.

	* src/gtk/x11merge.c (MergeDialogSetup): remove "Delete" button
	from dialog.

	* src/gtk/x11axis.c (GridDialogSetup, SectionDialogSetup)
	(CrossDialogSetup, AxisDialogSetup): remove "Delete" button from
	dialog.

	* src/gtk/x11lgnd.c (LegendArrowDialogSetup)
	(LegendRectDialogSetup, LegendArcDialogSetup)
	(LegendMarkDialogSetup, LegendTextDialogSetup): remove "Delete"
	button from dialog.

2011-12-05  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* debian/ngraph-gtk.manpages: added.

	* configure.in: change name of the package from "Ngraph-gtk" to
	"ngraph-gtk".

	* src/gtk/main.c (set_path_env): change order of "PATH"
	environment.

2011-11-23  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* misc/ngp2.1: added.

	* misc/ngraph.1: added.

2011-11-21  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* configure.in (GTK2_REQUIRED_VERSION, GTK3_REQUIRED_VERSION):
	added.

	* configure.in:	use GTK+3 if available.

	* icons/application-x-ngraph.xpm: added.

	* configure.in (AC_CONFIG_FILES): add "icons/Makefile" and
	"misc/Makefile".

	* MAKEFILE.am (SUBDIRS): add "icons" and "misc".

2011-11-21  Koichi Akabe  <vbkaisetsu at gmail.com>

	* debian/rules: updated for debian repository.

	* debian/control: updated for debian repository.

	* debian/install: added.


2011-11-21  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* addin/timer.nsc: remove shebang.

	* addin/tex_equation.nsc: remove shebang.

	* addin/ps2gra.nsc: remove shebang.

	* addin/fig2gra.nsc: remove shebang.

	* addin/cal.nsc: remove shebang.

2011-11-20  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/Makefile.am (libngraph_la_CFLAGS): remove settingis
	-DGTK_DISABLE_DEPRECATED=1 -DGDK_DISABLE_DEPRECATED=1
	-DGDK_PIXBUF_DISABLE_DEPRECATED=1 -DG_DISABLE_DEPRECATED=1
	-DGTK_DISABLE_SINGLE_INCLUDES=1 -DG_DISABLE_SINGLE_INCLUDES=1
	-DGDK_PIXBUF_DISABLE_SINGLE_INCLUDES=1 -DGSEAL_ENABLE=1


	* src/Makefile.am (ngraph_CFLAGS): remove settingis
	-DG_DISABLE_DEPRECATED=1 -DG_DISABLE_SINGLE_INCLUDES=1

	* addin/Makefile.am (APP_CFLAGS): remove settingis
	-DGTK_DISABLE_DEPRECATED=1 -DGDK_DISABLE_DEPRECATED=1
	-DGDK_PIXBUF_DISABLE_DEPRECATED=1 -DG_DISABLE_DEPRECATED=1
	-DGTK_DISABLE_SINGLE_INCLUDES=1 -DG_DISABLE_SINGLE_INCLUDES=1 \
	-DGDK_PIXBUF_DISABLE_SINGLE_INCLUDES=1 -DGSEAL_ENABLE=1

	* debian/copyright: specify GPL version.

2011-11-14  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* addin/Makefile.am (pkglib_DATA): add "timer.nsc".

	* addin/timer.nsc: added.

2011-11-08  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11menu.c (recent_filter): use "g_ascii_strncasecmp()"
	and "g_ascii_strcasecmp()" instead of "g_strcmp0()".

	* src/gtk/main.h (NGRAPH_TEXT_MIME): added.

2011-11-04  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/main.h (NGRAPH_GRAPH_MIME, NGRAPH_DATA_MIME): added.

	* src/gtk/x11dialg.h (MiscDialog): remove member "history".

	* src/gtk/ox11menu.c (menu_save_config_sub, mgtkloadconfig)
	(menulocal_finalize, menuinit): remove codes related to data file history.

	* src/gtk/x11file.c (CmFileHistory): use "GtkRecentChooser".

	* src/gtk/x11opt.c (MiscDialogSetupItem, MiscDialogSetup)
	(MiscDialogClose): remove codes related to data file history.

	* src/gtk/x11commn.c (add_hist): added.
	(AddNgpFileList, AddDataFileList): use "add_hist()".

	* src/gtk/ox11menu.h (menulocal): remove member "datafilelist".

	* src/gtk/x11menu.c (SaveHistory, create_recent_data_menu)
	(add_underscore): removed.
	(recent_filter): added.
	(create_action_group): use "gtk_recent_filter_add_custom()"
	instead of "gtk_recent_filter_add_mime_type()".

2011-11-02  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* addin/calc.c (load_settings): set maximum length of a string of
	"%s" parameter for the function "sscanf()".

	* addin/fft.c (MAXP, MAXDATA): increase maximum data number.

	* src/gtk/main.h (APP_MIME): added.

	* src/gtk/x11menu.c (create_action_group): use
	"gtk_recent_filter_add_mime_type()" instead of
	"gtk_recent_filter_add_application()" and
	"gtk_recent_filter_add_pattern()".

	* src/gtk/x11commn.c (AddNgpFileList): use "APP_MIME".

2011-11-01  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* addin/fitrslt.c: move some functions to "addin_common.c".

	* addin/legend.c: added.

	* src/gtk/x11menu.c (application): call "SaveHistory()" before
	call "gtk_ui_manager_remove_ui()".

2011-10-24  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* initfile/Ngraph.ini.win (script): add fft add-in.

	* src/gtk/main.c (set_dir_defs): "LIBDIR" is now "app_path/bin".

	* mingw/windows.sh: add-in programs are now installed in
	"$PKG_DIR/bin".

	* addin/Makefile.am (pkglib_SCRIPTS): remove "calc.tcl" and "fitrslt.tcl".
	(pkglib_PROGRAMS): add "calc" and "fitrslt".

	* addin/addin_common.h: added.

	* addin/addin_common.c: added.

	* addin/calc.c: added.

	* addin/fitrslt.c: added.

2011-10-07  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* debian/control (Recommends): add pstoedit.

	* addin/calc.tcl (savedata, savescript): remove white space in the
	formula.

2011-09-26  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* debian/ngraph.bash: add "-V" and "--VERSION" option. add "MJD"
	to the parameter of the "-ex" and "-ey" option.

	* zsh/_ngraph: add "-V" and "--VERSION" option. add "MJD" to the
	parameter of the "-ex" and "-ey" option.

2011-09-16  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/gtk_subwin.c (sub_window_show): use
	"gtk_window_present()" instead of "gtk_widget_show()".

	* src/gtk/x11commn.c: fix typo.

2011-09-14  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/main.c: "License" is defined when the version of GTK+ is
	less than 3.

2011-09-13  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/ofile.c (set_data_progress): consider "d->hskip".

	* src/gtk/x11lgnd.c (width_edited, pos_edited): the argument of
	the function "LegendWinUpdate()" is "TRUE".

2011-09-12  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11commn.c (ProgressDialogCreate): call
	"gtk_progress_bar_set_show_text()" when the version of GTK+ is 3.

	* src/gtk/x11graph.c (CmHelpAbout): use "license-type" instead of
	"license" when the version of GTK+ is 3.

2011-09-09  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/ogra2cairo.h (gra2cairo_local): use "cairo_region_t"
	instead of "GdkRegion" when the version of GTK+ is 3.

	* src/gtk/ogra2cairo.c (gra2cairo_clip_region): use
	"cairo_region_t" instead of "GdkRegion" when the version of GTK+
	is 3.

	* src/gtk/ox11menu.h (menulocal): type of "pix" is not "GdkPixmap"
	but "cairo_surface_t".
	(menulocal): use "cairo_region_t" instead of "GdkRegion" when the
	version of GTK+ is 3.

	* src/gtk/x11dialg.h (DIALOG_PROTOTYPE): type of "vbox" is not
	"GtkVBox" but "GtkBox".
	(LegendDialog): type of "arrow_pixmap" is not "GdkPixmap" but
	"cairo_surface_t".

	* src/gtk/x11gui.c (DialogInput, DialogRadio, DialogCombo)
	(DialogComboEntry, DialogSpinEntry, DialogCheck): type of "vbox"
	is not "GtkVBox" but "GtkBox".

	* src/gtk/ox11menu.c (mx_clear): use "cairo_region_t" instead of
	"GdkRegion" when the version of GTK+ is 3.

	* src/gtk/x11file.c (button_set_mark_image, draw_type_pixbuf)
	(create_type_combo_box): use "cairo_surface_t" instead of
	"GdkPixmap" when the version of GTK+ is 3.

	* src/gtk/x11view.c (region): use "cairo_region_t" instead of
	"GdkRegion" when the version of GTK+ is 3.
	(paste_cb, mouse_move_scroll): use "gdk_window_get_width()" and
	"gdk_window_get_height()" instead of "gdk_window_get_geometry()"
	when the version of GTK+ is greater than 2.24.
	(ViewerWinSetup, ShowCrossGauge, SetHRuler, SetVRuler): use
	"gdk_window_get_width()" and "gdk_window_get_height()" instead of
	"gdk_drawable_get_size()" when the version of GTK+ is greater than
	2.24.
	(popup_menu_position): use "gdk_window_get_position()" instead of
	"gdk_window_get_geometry()" when the version of GTK+ is greater
	than 2.24.
	(ViewerEvPaint): use "cairo_set_source_surface()" instead of
	"gdk_cairo_set_source_pixmap()."
	(ViewerEvPaint): added codes for GTK+ 3.
	(create_pix): use "cairo_surface_t" instead of "GdkPixmap".
	(OpenGC): added codes for GTK+ 3.

	* src/gtk/ogra2x11.c (gtkevpaint): added codes for GTK+ 3.
	(gtklocal): use "cairo_surface_t" instead of "GdkPixmap" when the
	version of GTK+ is 3.

	* src/gtk/ogra2gdk.c (gra2gdk_create_pixmap): use
	"cairo_surface_t" instead of "GdkPixmap" when the version of GTK+
	is 3.

	* src/gtk/gtk_widget.c (text_view_size_allocate): fix typo.
	(set_linumber_color): use "gtk_widget_override_background_color()"
	instead of "gtk_widget_modify_base()" when the version of GTK+ is
	3.
	(get_preferred_width, get_preferred_height): added for GTK+ 3.
	(create_text_view_with_line_number): added codes for GTK+ 3.
	(text_view_with_line_number_set_font): use
	"gtk_widget_override_font()" instead of "gtk_widget_modify_font()"
	when the version of GTK+ is 3.

	* src/gtk/x11lgnd.c (LegendArrowDialogPaint)
	(LegendArrowDialogScaleL, LegendArrowDialogSetup)
	(create_character_view, LegendWinExpose, CmLegendWindow): add
	codes for GTK+ 3.

	* src/gtk/x11menu.h (NgraphApp): use "cairo_surface_t" instead of
	"GdkPixmap" when the version of GTK+ is 3.

	* src/gtk/gtk_common.h: add "GDK_KEY_*" definitions.

	* src/gtk/x11menu.c (create_markpixmap, free_markpixmap): use
	"cairo_surface_t" instead of "GdkPixmap" when the version of GTK+
	is 3.

	* src/gtk/gtk_liststore.c (start_editing_obj): add "const" to the
	5th parameter when the version of GTK+ is 3.

	* src/gtk/x11info.c (InfoWinSetFont): use
	"gtk_widget_override_font()" instead of "gtk_widget_modify_font()"
	when the version of GTK+ is 3.

	* src/gtk/gtk_subwin.c (cell_focus_out): added for GTK+ 3.
	(start_editing): add codes for GTK+ 3.

	* src/gtk/x11lgndx.c (LegendGaussDialogPaint)
	(LegendGaussDialogSetup): add codes for GTK+ 3.

	* src/gtk/gtk_ruler.c (ruler_new): add codes for GTK+ 3.
	(nruler_get_preferred_width, nruler_get_preferred_height): added
	for GTK+ 3.
	(nruler_size_request, nruler_expose, nruler_make_pixmap)
	(nruler_draw_ticks, nruler_draw_pos): add codes for GTK+ 3.

2011-08-15  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* initfile/NgraphUI.xml.win: fix typo.

	* initfile/NgraphUI.xml: fix typo.

	* src/gtk/x11menu.c (ActionEntry): fix typo.

2011-08-09  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/math/math_equation.c (check_const_sub): check
	"exp->u.assign.right" instead of "exp->u.bin.right" when type of
	the expression is "MATH_EXPRESSION_TYPE_ASSIGN".

2011-08-08  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/gtk_subwin.c (sub_window_minimize)
	(sub_window_restore_state): removed.

2011-08-07  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/gtk_subwin.c (ev_sub_win_key_down): use
	"window_action_set_active()" instead of "gtk_widget_hide()".

	* src/gtk/x11file.c (execute_fit_dialog): added.
	(FileDialogFit, FileWinFit): use "execute_fit_dialog()".

2011-07-31  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/shellcm.c (cmwhich): check built-in command.

2011-07-29  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11lgnd.c (LegendWinLegendUpdate): save "d->select" and
	"d->legend_type" when "ret" is equal to "IDOK".

2011-07-28  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/ofile.c (getdata2, getminmaxdata, f2dgetdataraw): use stack
	instead of heap for the data buffer.
	(getdata, getdata2, getminmaxdata, f2dgetdataraw): size of the
	data buffer is "FILE_OBJ_MAXCOL + 3" (for error-bar plot).

2011-07-27  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11gui.c (message_box): increase maximum length of a
	message.

	* src/ofile.c (getminmaxdata): bug fix: update "fp->maxy.val"
	instead of "fp->maxx.val".
	(getdataraw): bug fix: set value to not "fp->d3" but "d3".

2011-07-22  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* addin/ps2gra.nsc: change name of functions.

	* addin/fig2gra.nsc: change name of functions.

	* addin/fig2gra.rb (set_line_attribute): fix typo.

	* addin/tex_equation.nsc: change name of functions.

	* src/nstring.c (nstrncat): this function is not used.

2011-07-21  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* addin/tex_equation.nsc: fix typo.

2011-07-20  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* addin/fig2gra.nsc: added.

	* addin/tex_equation.nsc: use "fig2gra.nsc" when ruby is not
	available.

	* addin/ps2gra.nsc: use "fig2gra.nsc" when ruby is not available.

	* src/object.c (get_array_argument): call "g_strfreev()" when the
	function "g_shell_parse_argv()" returns false.

	* src/oregexp.c (regexp_match): call "g_match_info_free()" when
	the function "g_regex_match()" returns false.

2011-07-18  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/oiarray.c (oarray_get_index, oarray_create_math)
	(iarray_map): added.
	(iarrayget, iarrayput, iarrayins, iarraydel): use
	"oarray_get_index()".
	(oiarray): add field "map".

	* src/odarray.c (darrayget, darrayput, darrayins, darraydel): use
	"oarray_get_index()".
	(odarray): add field "map".

	* src/osarray.c (sarrayget, sarrayput, sarrayins, sarraydel): use
	"oarray_get_index()".

	* test/sarray_test.nsc: add tests for "get" and "map" fields.

	* test/iarray_test.nsc: add tests for "get" and "map" fields.

	* test/darray_test.nsc: add tests for "get" and "map" fields.

2011-07-16  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/oint.c (int_times, int_inc, int_dec): added.
	(oint): add fields "times", "inc" and "dec".

2011-07-13  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* addin/ps2gra.nsc: remove automatically created files.

	* addin/fig2gra.rb (#draw_poly_line, #uniq_pos): close path when
	start and end points are same position.

	* initfile/Ngraph.ini.in (script): add "import PS" and "import
	EPS" addin.

	* addin/ps2gra.nsc: added.

	* addin/Makefile.am: add ps2gra.nsc

	* src/gtk/x11view.c (ncopyobj): don't copy "name" field.

2011-07-12  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/osystem.c (nsystem): type of the field "pid" is "NINT".

2011-07-12  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/osystem.c (nsystem): add field "pid".
	(syspid): added.

	* src/math/math_basic_function.c (math_func_srand): added.

	* src/math/math_function.h.in: add function "srand()".

	* src/gtk/x11menu.h (SubWinType): change order.

2011-07-11  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/shellcm.c (cmwhich): added.

	* src/shell.c (cmdtable): add internal command "which".

	* doc/html_ja/addin.html: update document.

	* addin/Makefile.am (pkglib_SCRIPTS): add "fig2gra.rb".
	(pkglib_DATA): add "tex_equation.nsc".

	* addin/fig2gra.rb: added.

	* addin/tex_equation.nsc: added.

	* initfile/Ngraph.ini.in (script): add "TeX equation" addin.

	* src/math/math_expression.c (math_func_call_expression_new):
	"buf" is NULL when argc is less than 1.

	* src/math/math_basic_function.c (math_func_time): added.

	* src/math/math_function.h.in: add function "time()".

2011-07-10  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/object.c (add_arg_object, getargument): accept character ","
	as a string of an id list.

	* src/gtk/ox11menu.c (mx_focus_obj, mx_unfocus_obj): added.
	(gtkmenu): add fields "focus" and "unfocus".

2011-07-05  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/omerge.c (ZOOM_MAX): added.
	(mergezoom): do nothing if "zm * zoom" is larger than "ZOOM_MAX".
	(mergegeometry): upper limit of the field "zoom" is "ZOOM_MAX".

	* src/gtk/x11view.c (calc_zoom, set_zoom_prm): added.
	(init_zoom, mouse_move_zoom): use "calc_zoom()" and
	"set_zoom_prm()".
	(mouse_up_zoom): use "calc_zoom()".
	(ViewUpdate): set "d->ShowRect" as FALSE.

	* src/gtk/gtk_widget.h (SPIN_ENTRY_MAX): change limit to 1000000.

2011-07-02  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11gui.c (message_box): limit length of an error
	message.

	* src/gra.c (GRAlines): fix argument number.
	(GRAinputdraw): fix check of the argument number.

2011-06-23  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/ofile.c (f2dhead): don't add line number.

	* src/gtk/x11dialg.h (FileDialog):remove members "comment" and
	"comment_num_tag".

	* src/gtk/x11file.c (count_line_number_str, set_line_number_tag)
	(create_text_tag, set_file_preview): removed.
	(set_headlines): use "text_view_with_line_number_set_text()".
	(FileDialogSetup): use "create_text_view_with_line_number()".
	(CmFileWindow): call "gtk_tree_view_set_enable_search()",
	"gtk_tree_view_set_search_column()" and
	"gtk_tree_view_set_tooltip_column()".

	* src/gtk/x11merge.c (CmMergeWindow): call
	"gtk_tree_view_set_enable_search()",
	"gtk_tree_view_set_search_column()" and
	"gtk_tree_view_set_tooltip_column()".

	* src/gtk/x11axis.c (CmAxisWindow): call
	"gtk_tree_view_set_enable_search()",
	"gtk_tree_view_set_search_column()" and
	"gtk_tree_view_set_tooltip_column()".

	* src/gtk/gtk_widget.c (text_view_scroll_event)
	(set_scroll_visibility, text_view_size_alocate)
	(set_linumber_color, create_text_view_with_line_number)
	(text_view_with_line_number_set_text)
	(text_view_with_line_number_set_font): added.

	* src/gtk/gtk_common.h: remove macros for Gtk+ which version is
	lesser than 2.14.

	* configure.in: "GTK_REQUIRED_VERSION" is now 2.14.0.

2011-06-20  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11merge.c (MergeDialogSetupItem): cursor will be set
	after the last character.

	* src/gtk/x11file.c (FileDialogSetupItem): cursor will be set
	after the last character.

2011-06-15  Shijo Nagao  <shijo.nagao at ntnu.no>

	* src/gtk/ox11menu.c (mx_show_lib_version): use macro
	"GSL_VERSION" if available.

2011-06-14  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* initfile/Ngraph.nsc: open dummy "gra2cairofile" object when save
	"GRA" file to render strings corectry.

	* src/ogra2nul.c (g2nul_chardescent): remove unused variable
	"font".

	* src/oaxis.c (draw_numbering_normalize): add "default" in the
	"case" statement.

	* src/oprm.c (prmload): remove unused variables "scauto" and
	"scperiod".

	* src/math/math_expression.c (register_arg): remove unused
	variable "i".
	(call_func): remove unused variable "use_array".

	* src/math/math_scanner.c (get_dec): remove unused variable "ptr".

	* src/object.c (getvaluestr): remove unused variable "len".

	* src/otext.c (textmatch): calculate margin.

	* src/shell.c (puts_localized): return "r".

	* src/ofile.c (put_func): remove unused variables "default_func"
	and "fname".
	(getdata_sub2): remove unused variables "data2" and "data3".
	(f2doutputfile): return "r".

	* src/orect.c (rectrotate): remove unused variables "nx1", "ny1",
	"nx2" and "ny2".

	* src/gra.c (GRAdrawtext): remove unused variable "j".

	* src/gtk/ogra2cairo.c (loadconfig): remove unused variables
	"fontcashsize" and "fontcashsize, fontcashdirfontcashdir".

	* src/gtk/ox11dlg.c (dlgmessage): remove unused variable "rcode".

	* src/gtk/x11cood.c (CmCoordinateWindow): remove unused variable
	"dlg".

	* src/gtk/x11file.c (FitSaveDialogSetup): remove unused variable
	"j".
	(func_entry_focused): remove unused variable "d".
	(FileDialogSetup): remove unused variable "rcode".
	(start_editing_type): remove unused variable "list".

	* src/gtk/x11view.c (CutFocusedObjects): remove unused variable
	"text".
	(EvalDialogSetupItem): initialize variable "n".
	(scrollbar_scroll_cb, AddList, AddInvalidateRect): remove unused
	variable "d".
	(mouse_down_point): remove unused variable "zoom".
	(calc_integer_ratio): check variable "po2" (not "pow").

	* src/gtk/x11opt.c (SetScriptDialogBrowse): remove unused variable
	"d".

	* src/gtk/ogra2x11.c (gtk_output): remove unused variables
	"cstr"and "local".

	* src/gtk/x11axis.c (GridDialogAxis): remove unused variable "d".
	(AxisDialogFile): remove unused variable "room".
	(CmAxisScaleUndo): remove unused variable "d".

	* src/gtk/x11print.c (print_obj): remove unused member "g2wid".
	(draw_page): remove unused variable "g2wid".

	* src/gtk/x11lgnd.c (LegendWinLegendUpdate): remove unused
	variable "num".

	* src/gtk/x11commn.c (FileAutoScale): remove unused variable
	"room".

	* src/gtk/x11graph.c (SwitchDialogUp): remove unused variable
	"num".
	(SaveDialogSetup): remove unused variable "hbox".

	* src/gtk/ogra2cairofile.c (gra2cairofile_output): remove unused
	variable "cstr".

2011-06-11  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* demo/demo.ngp.in (dialog): don't clear graph before exit
	demonstration.

	* src/gtk/x11print.c (DriverDialogSelectCB): type of variables "l"
	and "n"is now "int".

	* initfile/Ngraph.nsc: add option "-V".

	* src/oaxis.c (axis): add field "auto_scale_margin". remove 2nd
	argument for "auto_scale" and "get_auto_scale" fields.
	(axisautoscale_margin): added.
	(axisinit): initialize "auto_scale_margin" field.
	(axisadjust, axischangescale, axiscoordinate): use "AXIS_TYPE_",
	"AXIS_TYPE_LOG" and "AXIS_TYPE_LOG" instead of 1 and 2.
	(axischangescale): now parameter "room" means margin of the scale.
	(axisautoscale, axisgetautoscale): remove 2nd argument.

	* src/oagrid.c (agrid): add fields "grid_x" and "grid_y".
	(agridinit): initialize "grid_x" and "grid_y" fields.
	(agriddraw): check "grid_x" and "grid_y" fields.

	* src/shellcm.c (dispfield): "NCHAR" and "NCFUNC" are not used now.

	* src/object.c (check_arglist): added.
	(addobject): call "check_arglist()".
	(chkobjarglist, _putobj, putobj, _getobj, getobj, copyobj)
	(getvaluestr): "NCHAR" and "NCFUNC" are not used now.
	(add_arg_object, add_arg_int, add_arg_double, add_arg_bool)
	(add_arg_num, add_arg_sarray, add_arg_iarray, add_arg_darray)
	(set_arg_enum, get_array_argument): added.
	(getargument): use "set_arg_enum()", "g_shell_parse_argv()",
	"get_array_argument()", "add_arg_num()" and "add_arg_object()".

	* src/oio.c (io): add "mode" field. remove 2nd argument for "open"
	and "popen" field.
	(io_init): initialize "mode" field.
	(io_open): use "mode" filed instead of 2nd argument.

	* src/mathfn.c (nround): use "G_MAXINT" and "G_MAXINT" instead of
	"LANG_MIN" and "LONG_MAX" .

	* src/ofile.c (barout): use "case" statement instead of "if".
	(f2dboundings): minimum or maximum value for bar plot is now 0.

	* src/gtk/x11dialg.h (AAxisDialog): add member "margin".
	(GridDialog): add members "draw_x" and "draw_y".

	* src/gtk/x11axis.c (GridDialogSetupItem): get "grid_x" and
	"grid_y" fields.
	(GridDialogSetup): add widgets to set "grid_x" and "grid_y" fields.
	(GridDialogClose): set "grid_x" and "grid_y" fields.
	(scale_tab_setup_item): remove redundant function call "getobj()"
	for "div" fields.
	(scale_tab_setup_item): get "auto_scale_margin" field.
	(AxisDialogFile): remove second argument for "get_auto_scale" field.
	(scale_tab_create): add widget to set "auto_scale_margin" field.
	(scale_tab_set_value): set "auto_scale_margin" field.
	(CmAxisZoom): now 3rd argument for "scale" field is 0.

	* src/gtk/x11commn.c (FileAutoScale): remove second argument for
	"auto_scale" field.

	* demo/demo.ngp (dialog): don't clear graph before exit
	demonstration.

	* demo/demo4.ngp.in: use "axisgrid" instead of "path" to show grid
	line.

	* src/math/math_basic_function.c (mjd): check parameters "m" and
	"d".

	* src/gtk/ox11menu.c (get_palette): initialize variable "palette"
	as NULL.

2011-06-10  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/ox11menu.c (gtkmenu): add argument for the field
	"lib_version".
	(mx_show_lib_version): add prefix for the output strings.

	* src/gtk/x11view.c (ViewerPopupMenu, CmEditMenuCB)
	(CmViewerButtonArm): use "GPOINTER_TO_INT()" to get data.

	* src/gtk/x11print.c (CmOutputMenu): use "GPOINTER_TO_INT()" to
	get data.

	* src/gtk/x11menu.c (toggle_view_cb, detach_toolbar): use
	"GPOINTER_TO_INT()" to get data.

	* src/gtk/x11graph.c (CmGraphNewMenu): use "GPOINTER_TO_INT()" to
	get data.

2011-06-08  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11commn.c (get_new_axis_id): add argument "aobj".

2011-05-20  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/ostring.c (utf8_string_slice, string_slice, string_match)
	(string_rindex, string_index, string_replace): added.
	(ostring): add field "slice", "replace", "index", "rindex" and
	"match".

	* src/oregexp.c (regexp_replace): added.
	(oregexp): add field "replace".

	* test/string_test.nsc: added.

	* src/math/math_basic_function.c (compare_double_with_prec):
	added.
	(math_func_eq, math_func_neq): add 3rd argument. use
	"compare_double_with_prec()".

2011-05-19  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/math/math_parser.c (parse_argument_list): update "*buf"
	after call the function "g_realloc()".

	* src/object.c (array_reverse): added.

	* src/odarray.c (odarray): add field "reverse", "sum", "average",
	"RMS", "sdev", min", "max" and "slice".
	(calc_sum, calc_square_sum, darray_sum, darray_average)
	(darray_rms, darray_sdev, darray_min, darray_max): added.

	* src/oiarray.c (oarray_reverse, oarray_slice): added.
	(oiarray): add field "reverse", "sum", "average", "RMS", "sdev",
	min", "max" and "slice".
	(calc_sum, calc_square_sum, iarray_sum, iarray_average)
	(iarray_rms, iarray_sdev, iarray_min, iarray_max): added.

	* src/mathfn.c (bsearch_int): add braces after "if" statements.

	* src/osarray.c (osarray): add field "reverse" and "slice".
	(sarray_slice): added.

2011-05-18  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/ofit.c (fituser): "MSERR" is not used.

	* src/ofile.c (errordisp, errordisp2): "MSERR" is not used.

	* src/oregexp.c (regexp_get): return 1 when failed.

2011-05-17  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* test/iarray_test.nsc: added.

	* test/darray_test.nsc: added.

	* test/sarray_test.nsc: added.

	* test/regexp_test.nsc: added.

	* initfile/save_ui_file.nsc: don't use external programs.

	* src/shellcm.c (cmecho): length of the output strings is now not
	limited.

	* src/object.c (cmp_func_int_r, arrayrsort_int, cmp_func_double)
	(cmp_func_double_r, arraysort_double, arrayrsort_double)
	(arrayuniq_double, cmp_func_str, cmp_func_str_r, arraysort_str)
	(arrayrsort_str, arrayuniq_str): added.
	(getvaluestr): use "g_string_append_printf()" instead of
	"sprintf()".

	* src/oio.c (io_eof): return value is depend on the return value
	of the function "feof()".

	* src/gtk/main.c (obj_add_func_ary): add "addregexp".

	* src/oiarray.c (oarray_get_array, oarray_num, oarray_seq)
	(iarraypop, iarrayunshift, iarrayshift, iarraysort, iarrayrsort)
	(iarrayuniq, iarrayjoin, oarray_reverse_seq): added
	(iarrayadd, iarrayins): use  "oarray_get_array()".
	(oiarray): add fields "push", "pop", "unshift", "shift", "sort",
	"rsort", "uniq", "join", "seq" and "rseq".

	* src/odarray.c (darrayadd, darrayins): use  "oarray_get_array()".
	(darraypop, darrayunshift, darrayshift, darraysort, darrayrsort)
	(darrayuniq, darrayjoin): added.
	(odarray): add fields "push", "pop", "unshift", "shift", "sort",
	"rsort", "uniq", "join", "seq" and "rseq".

	* src/osarray.c (sarrayadd, sarrayins): use  "oarray_get_array()".
	(sarraypop, sarrayunshift, sarrayshift, sarraysort, sarrayrsort)
	(sarrayuniq): added.
	(osarray): add fields "push", "pop", "unshift", "shift", "sort",
	"rsort" and "uniq".

	* src/oregexp.c: added.

2011-05-16  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/ostring.c (string_strip, set_length, string_upcase)
	(string_downcase, string_reverse): added.
	(ostring): add field "byte", "length", "strip", "upcase",
	"downcase" and "reverse".

	* src/odarray.c (odarray): add field "seq" and "rseq".
	(odarray): use "oarray_num()", "oarray_seq()" and
	"oarray_reverse_seq()".

	* src/oiarray.c (oarray_num): change name from "iarraunum()".
	(oarray_seq, oarray_rseq): added.
	(oiarray): add field "seq"and "rseq".
	(oiarray): use "oarray_num()", "oarray_seq()" and
	"oarray_reverse_seq()".

	* src/osarray.c (ERRREGEXP, set_delimiter, sarraysplit)
	(sarrayjoin): added.
	(sarrayinit): initialize field "_local".
	(sarraydone): finalize field "_local".
	(osarray): add fields "delimiter", "split", "seq", "rseq" and
	"join".
	(osarray): use "oarray_num()", "oarray_seq()" and
	"oarray_reverse_seq()".

	* src/object.c (arrayins2, arrayput2): use "g_strdup()" instead of
	"g_malloc()" and "strcpy()".

2011-05-13  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11menu.c (ActionEntry): fix callback function (from
	"CmOutputMenu()" to "CmViewerClear()").

	* src/gtk/x11opt.c (CmOptionSaveNgp): fix window title.

2011-05-10  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* initfile/Ngraph.ini.win (palette): added.

	* initfile/Ngraph.ini.in (palette): added.

	* src/gtk/ox11menu.h (menulocal): add member "Palette".

	* src/gtk/ox11menu.c (MenuConfigOthers): change name from
	"MenuConfigExportImage". Add setting "palette".
	(get_palette, set_palette): added.
	(menu_save_config): call "get_palette()" before call
	"menu_save_config_sub()" when "type & SAVE_CONFIG_TYPE_OTHERS" is
	true.
	(menuinit): call "set_palette()".

2011-05-09  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11dialg.c: add braces after "if" statements.

2011-05-01  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11view.c (UnFocus): use "gtk_widget_queue_draw()"
	instead of "gdk_window_invalidate_rect()".

2011-04-29  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11view.c (UnFocus): call
	"gdk_window_invalidate_rect()".

2011-04-28  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11file.c (CmFileNew, CmFileOpen, CmFileClose)
	(CmFileUpdate, CmFileEdit, CmFileMath): add parameters "GtkAction
	*w" and "gpointer client_data".
	(FileWinFileDraw): call "CmViewerDraw()" instead of
	"CmViewerDrawB()".
	(CmFileMenu): removed.
	(GetDrawFiles, CmFileSaveData): moved from "x11print.c".

	* src/gtk/x11view.c (ViewerEvKeyUp): call "reset_drag_info()" only
	when "CLEAR_DRAG_INFO" is true.
	(graph_dropped, ViewerEvKeyDown): call "CmViewerDraw()" instead of
	"CmViewerDrawB()".
	(CmViewerDraw, CmViewerClear): add parameters "GtkAction *w" and
	"gpointer client_data".
	(CmViewerDraw): second parameter represents if select files before
	drawing or not.

	* src/gtk/x11opt.c (CmOptionSaveNgp, CmOptionViewer)
	(CmOptionExtViewer, CmOptionPrefFont, CmOptionScript)
	(CmOptionMisc, CmOptionSaveDefault): add parameters "GtkAction *w"
	and "gpointer client_data".
	(CmOptionMenu): removed.

	* src/gtk/x11merge.c (CmMergeOpen, CmMergeClose, CmMergeUpdate):
	add parameters "GtkAction *w" and "gpointer client_data".
	(CmMergeMenu, MergeWinMergeOpen): removed.

	* src/gtk/x11axis.c (CmAxisNewFrame, CmAxisNewSection)
	(CmAxisNewCross, CmAxisNewSingle, CmAxisDel, CmAxisUpdate)
	(CmAxisZoom, CmAxisClear, CmAxisGridNew, CmAxisGridDel)
	(CmAxisGridUpdate, CmAxisScaleUndo): add parameters "GtkAction *w"
	and "gpointer client_data".
	(CmAxisMenu, CmGridMenu): removed.

	* src/gtk/x11print.c (CmOutputViewer): removed.
	(CmOutputViewerB): merged with the function "CmOutputViewer()".
	(CmOutputViewerB): never call "SetFileHidden()".
	(CmPrintGRAFile, CmOutputImage): static function.
	(CmOutputMenu): remove unused case.

	* src/gtk/x11lgnd.c (CmLineDel, CmLineUpdate, CmRectDel)
	(CmRectUpdate, CmArcDel, CmArcUpdate, CmMarkDel, CmMarkUpdate)
	(CmTextDel, CmOptionTextDef): add parameters
	"GtkAction *w" and "gpointer client_data".
	(CmLineMenu, CmRectangleMenu, CmArcMenu, CmMarkMenu, CmTextMenu):
	removed.

	* src/gtk/x11menu.h (MenuID): remove unused items.

2011-04-23  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/main.c (main): call "g_mem_set_vtable()" when
	"USE_MEM_PROFILE" is true.

	* src/osystem.c (system_mem_profile): added.
	(nsystem): add field "mem_profile" when "USE_MEM_PROFILE" is true.

	* src/common.h (USE_MEM_PROFILE): added.

2011-04-21  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/main.c (obj_member_completion_function)
	(my_completion_function): use "strdup()" to create return value.

	* src/gtk/gtk_ruler.c (nruler_destroy): remove unused parameter
	"event".
	(ruler_new): function "nruler_destroy()" is now connected to the
	"unrealize" signal.

2011-04-20  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/object.c (arrayadd): check if the parameter "val" is NULL or
	not.

	* src/oroot.c (oputstyle): when size of the array is 1, it is as
	same as the array has the same two elements.

	* src/gtk/x11dialg.c (SetObjPointsFromText)
	(SetObjFieldFromStyle): call "gtk_widget_grab_focus()" when an
	error is occurred.

2011-04-15  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11menu.c (setupwindow, create_message_box): exchange
	position of messages.

	* src/gtk/x11view.c (move_focus_frame, viewer_key_scroll): added.
	(ViewerEvKeyDown): use "move_focus_frame()" and
	"viewer_key_scroll()".
	(set_drag_info, reset_drag_info): added.
	(SetPoint, move_focus_frame): use "set_drag_info()".
	(ViewerEvKeyUp): call "reset_drag_info()"

	* pixmap/Makefile.am (EXTRA_DIST): add pixmaps ngraph_align_b.png,
	ngraph_align_hc.png, ngraph_align_l.png, ngraph_align_r.png,
	ngraph_align_t.png and ngraph_align_vc.png

2011-04-11  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11menu.c (ActionEntry): fix typo (from "_Right" to
	"_Bottom").

2011-04-06  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11gui.c (check_overwrite): moved from x11commn.c.

	* src/gtk/x11view.c (SetPoint): moved from x11menu.c.
	(CmViewerClearB): removed.

	* src/gtk/x11axis.c (check_axis_history): static function.

	* src/gtk/x11print.c (GetDrawFiles): moved from x11commn.c.
	(CmOutputDriverB): removed.

	* src/gtk/x11menu.c (SaveHistory): moved from x11commn.c.

	* src/gtk/x11lgndx.c (get_radio_index): moved from x11dialg.c.

2011-04-03  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/ofile.c (f2dsettings): fix infinite loop.

	* src/gtk/gtk_common.h (CAIRO_COORDINATE_OFFSET): always 0.

	* src/gtk/main.c (main): don't call "gtk_set_locale()" when
	version of the GTK+ is greater than 2.24.

	* src/gtk/x11gui.c (DialogExecute): use "gtk_widget_hide()"
	instead of "gtk_widget_hide_all()".

	* src/gtk/x11dialg.c (SetObjFieldFromWidget)
	(SetWidgetFromObjField): use "gtk_combo_box_get_has_entry()" when
	version of the GTK+ is greater than 2.24.

	* src/gtk/x11view.c (ViewerWinSetup, ShowCrossGauge, SetHRuler)
	(SetVRuler): use "gdk_window_get_width()" and
	"gdk_window_get_height()" when version of the GTK+ is greater than
	2.24.
	(ChangeDPI, draw_paper_frame): use "gdk_pixmap_get_size()" when
	version of the GTK+ is greater than 2.24.

	* src/gtk/ogra2x11.c (gtkchangedpi): use "gdk_pixmap_get_size()"
	when version of the GTK+ is greater than 2.24.

	* src/gtk/x11graph.c (CmHelpAbout): don't call
	"gtk_about_dialog_set_url_hook()" when version of the GTK+ is
	greater than 2.24.

	* src/gtk/gtk_subwin.c (sub_window_minimize): use
	"gtk_widget_hide()" instead of "gtk_widget_hide_all()".

	* src/gtk/gtk_combo.c (combo_box_entry_create): use
	"gtk_combo_box_new_with_entry()" and
	"gtk_combo_box_set_entry_text_column()" when version of the GTK+
	is greater than 2.24.

	* src/gtk/gtk_ruler.c (nruler_make_pixmap): use
	"gdk_pixmap_get_size()" when version of the GTK+ is greater than
	2.24.

2011-04-01  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11menu.h (Viewer): change type of members "VRuler" and
	"HRuler".

	* src/gtk/gtk_ruler.c (_Nruler): remove member "widget".
	(ruler_new): call "g_object_set_data()" to save data.
	(nruler_set_range, nruler_set_position): use "g_object_get_data()"
	to get data.
	(nruler_make_pixmap, nruler_draw_ticks): add parameter "widget".
	(nruler_draw_ticks): remove redundant call of the function
	"pango_layout_get_extents()".

	* src/gtk/gtk_common.h (CAIRO_COORDINATE_OFFSET): always 1.

	* src/gtk/x11view.c (coord_conv_x, coord_conv_y): add
	CAIRO_COORDINATE_OFFSET.

	* src/gtk/ogra2x11.c (clear_pixmap): use "cairo_paint()" instead
	of "cairo_rectangle()" and "cairo_fill()".

	* src/gtk/x11lgnd.c (draw_arrow_pixmap, LegendArrowDialogPaint):
	use "cairo_paint()" instead of "cairo_rectangle()" and
	"cairo_fill()".

	* src/gtk/ogra2cairofile.c (create_cairo): use "cairo_paint()"
	instead of "cairo_rectangle()" and "cairo_fill()".

	* src/gtk/x11lgndx.c (LegendGaussDialogPaint): use "cairo_paint()"
	instead of "cairo_rectangle()" and "cairo_fill()".

2011-03-31  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11view.c (mouse_down_zoom): improve calculation of dpi.
	(ChangeDPI): remove parameter.
	(create_legend1, create_path, create_legend3, create_legendx)
	(create_single_axis, create_axis): call "UpdateAll()".
	(ViewerEvLButtonDblClk): don't call "UpdateAll()".

	* src/gtk/x11opt.c (CmOptionViewer): simplify condition.

2011-03-30  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/Makefile.am (libngraph_la_SOURCES): add "gtk_ruler.c"
	and "gtk_ruler.h".

	* src/gtk/gtk_ruler.h: added.

	* src/gtk/gtk_ruler.c: added.

	* src/gtk/ox11menu.h (menulocal): remove unused members "scrollx",
	"scrolly", "pixel_dot", "offsetx" and "offsety".

	* src/gtk/ox11menu.c (mx_redraw): call "draw_paper_frame()" after
	call "mxflush()".
	(mx_clear): use "Menulocal.local->cairo".
	(mx_clear): use "cairo_paint()" when clear whole drawing area.

	* src/gtk/x11view.c (ViewerEvSize): remove unused codes.
	(ViewerEvPaint): use "nround()" to get coordinate.
	(SetHRuler, SetVRuler): use "nruler_set_range()" instead of
	"gtk_ruler_set_range()".
	(create_pix): size of the pixmap is now "(w + 1) x (h + 1)".
	(create_pix): use "cairo_paint()" instead of "cairo_rectangle()"
	and "cairo_fill()".
	(create_pix): don't call "draw_paper_frame()".
	(ChangeDPI): size of drawing area is now "(w - 1) x (h - 1)".
	(draw_paper_frame): use "gdk_drawable_get_size()" to get size of
	the pixmap.
	(draw_paper_frame): call "cairo_reset_clip()" before drawing.

	* src/gtk/x11menu.h (Viewer): change type of members "VRuler" and
	"HRuler". remove unused members "width" and "height".

	* src/gtk/x11menu.c (setupwindow): use "hruler_new()" and
	"vruler_new()".
	(SetPoint): use "nruler_set_position()" instead of
	"g_object_set()".

	* src/gtk/ogra2gdk.c (gra2gdk_create_pixmap): use "cairo_paint()"
	instead of "cairo_rectangle()" and "cairo_fill()".

2011-03-28  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11view.c (SetHRuler, SetVRuler): keep position of the
	ruler.

2011-03-25  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11view.c (ViewerWinSetup): initialize "d->KeyMask".
	(Evaluate, Trimming, Match, DelList, GetLargeFrame)
	(coord_conv_x, coord_conv_y, GetFocusFrame, ShowFocusFrame)
	(show_focus_line_arc, draw_frame_rect, draw_focus_line)
	(ShowFocusLine, ShowPoints, ShowFrameRect, ShowCrossGauge): add
	parameter "struct Viewer *" or "const struct Viewer *".
	(mouse_down_move_data): remove unused parameter "TPoint *dpoint".
	(ViewerWinUpdate): remove unused parameter "int clear".
	(ShowFocusLine, show_focus_line_arc): remove unused parameter "int
	clear" and "unsigned int state".
	(show_focus_line_arc): remove unused variable "clear".
	(ViewerEvMouseMove, ViewerEvButtonDown, ViewerEvButtonUp): save
	"d->KeyMask".

	* src/gtk/x11menu.h (struct Viewer): add member "KeyMask".

	* src/gtk/x11menu.c (set_focus_sensitivity): change type of the
	parameter to "const struct Viewer *".

2011-03-24  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/ox11menu.c (mx_show_lib_version): show version of the
	readline library and GSL.

	* src/gtk/x11print.c (CmPrintDataFile): update progress dialog.

2011-03-23  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11print.c (CmOutputViewer): execute "present" field of
	the "gra2gtk" object.

	* src/gtk/ox11menu.c (menuinit): use "gra2cairo_set_antialias()"
	to set antialias.
	(mx_show_lib_version): added.
	(gtkmenu): add field "lib_version", remove fields
	"GTK_compile_version" and "GTK_runtime_version".

	* src/gtk/x11view.c (draw_paper_frame): use
	"CAIRO_COORDINATE_OFFSET".
	(ViewerEvLButtonDown, ViewerEvRButtonDown, CmViewerButtonArm): call
	"gtk_widget_queue_draw()".
	(ViewerEvMouseMove): call "gtk_widget_queue_draw()" when "d->Mode
	& POINT_TYPE_DRAW_ALL"is true.
	(create_pix): use "gra2cairo_set_antialias()" to set antialias.

	* src/gtk/x11lgndx.c (LegendGaussDialogPaint): use
	"CAIRO_COORDINATE_OFFSET".

	* src/gtk/x11lgnd.c (draw_arrow_pixmap, LegendArrowDialogPaint):
	use "CAIRO_COORDINATE_OFFSET".

	* src/gtk/gtk_common.h (CAIRO_COORDINATE_OFFSET): added.

	* src/gtk/ogra2x11.c (gtkpresent): added.
	(gra2gtk): add field "present".
	(gtkMakeRuler): use "CAIRO_COORDINATE_OFFSET".

2011-03-22  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11print.c (CmOutputViewer): range of color is 0.0 to
	1.0.

	* src/gtk/ox11menu.h (menulocal): remove members "win", "gc" and
	"do_not_use_arc_for_draft".
	(menulocal): change type of members "bg_r", "bg_g" and "bg_b" from
	int to double.

	* src/gtk/x11lgnd.c (draw_arrow_pixmap, LegendArrowDialogPaint):
	use cairo to draw graphics.

	* src/gtk/ox11menu.c (MenuConfigViewer): remove setting
	"do_not_use_arc_for_draft".
	(add_color_to_array, menu_config_set_bgcolor): range of color is
	0.0 to 1.0.
	(mx_redraw): call "draw_paper_frame()" before call "GRAredraw()".
	(mx_redraw, mxdpi, mxclear): use "NgraphApp.Viewer.gdk_win"
	instead of "Menulocal.win".
	(mx_clear): use cairo to draw graphics.

	* src/gtk/x11view.c (GRAY, DOT_LENGTH, create_cairo)
	(draw_cairo_arc): added.
	(paste_cb, text_dropped, mouse_down_point, init_zoom)
	(mouse_down_move, mouse_up_point, mouse_up_drag, mouse_up_zoom)
	(mouse_up_change, mouse_up_lgend1, mouse_up_lgend2)
	(update_frame_rect, mouse_move_drag, mouse_move_zoom)
	(mouse_move_change, mouse_move_draw, ViewerEvMouseMove)
	(ViewerEvKeyDown, ViewerEvKeyUp, UnFocus, Draw, ViewUpdate)
	(ViewCopy, ViewCross): don't call "ShowFocusFrame()",
	"ShowPoints()", "ShowFocusLine()", "ShowFrameRect()" or
	"ShowCrossGauge()".
	(ShowFocusFrame, show_focus_line_arc, draw_frame_rect)
	(draw_focus_line, ShowFocusLine, ShowPoints, ShowFrameRect)
	(ShowCrossGauge, ViewerEvPaint, create_pix, draw_paper_frame): use
	cairo to draw graphics.
	(ViewerEvPaint): always redraw pixmap.
	(ViewerEvMouseMove): call "gtk_widget_queue_draw()" if necessary.
	(show_focus_line_arc, draw_focus_line): call "cairo_close_path()"
	if necessary.
	(draw_focus_line): add parameter "close_path".
	(ViewDelete): fix memory leak.

	* src/gtk/gtk_common.h: include "cairo/cairo.h".

	* src/gtk/x11opt.c (ViewerDialogSetupItem, ViewerDialogClose):
	range of color is 0.0 to 1.0.

	* src/gtk/x11lgndx.c (LegendGaussDialogPaint): use cairo to draw
	graphics.
	(LegendGaussDialogPaint): change background color depend on the
	setting.

	* src/gtk/ogra2x11.c (gtklocal): change type of members "bg_r",
	"bg_g" and "bg_b" from int to double.
	(gtklocal): remove member "gc".
	(gtkevpaint, gtkMakeRuler): use cairo.
	(clear_pixmap): added.
	(gtkclear, gtkchangedpi): use "clear_pixmap()".
	(get_color): return 0.0 to 1.0 instead of 0 to 255.

	* src/gtk/ogra2gdk.c (gra2gdk_create_pixmap): change type of
	parameters "r", "g" and "b" from int to double.

2011-03-15  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/ofit.c (fitpoly, fituser): use enumerate for return code.

2011-03-14  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/ofile.c (get_axis_prm): added.
	(opendata, f2dgetcoord): use "get_axis_prm()".
	(ofile_create_math_equation, set_const): add constants "AXISX",
	"AXISY" and "FLINE".

	* src/gtk/x11commn.c (AxisDel2): use "g_strdup_printf()" instead
	of "snprintf()".

2011-03-11  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11view.c (search_axis_group): added.
	(ViewUpdate, ViewCopyAxis): use "search_axis_group()".

	* src/gtk/x11commn.c (get_new_axis_id): added.
	(AxisDel2): use "get_new_axis_id()".

2011-03-10  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11commn.c (AxisDel2): use "get_axis_id()".

	* src/gtk/x11view.c (ViewUpdate, ViewCopyAxis): use
	"get_axis_id()".
	(ViewUpdate): bug fix: id of the axis object to delete is not
	"aid" but "id" when "type == 'c'".

	* src/ofile.c (get_axis_id): added.
	(opendata, f2dgetcoord, f2dsettings, f2dbounding): use
	"get_axis_id()".

2011-03-09  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11view.c (mouse_up_drag): invert logic and fix indent.
	(ViewerWinUpdate): set and restore "PaintLock".
	(ViewerWinUpdate): don't check "region" when "d->allclear" is
	true.

2011-03-08  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/ofile.c (ofile_create_math_equation, set_const): add
	constants "COLX", "COLY", "HSKIP" and "RSTEP".

2011-03-04  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11menu.c (ActionEntry): add callback to actions
	"GraphDrawOrderAction" and "GraphPageSetupAction".

	* src/gtk/gtk_subwin.h (NgraphActionEntry): moved from "x11menu.c".

	* src/gtk/x11graph.c (CmGraphLoadB, CmGraphSaveB, CmGraphMenu)
	(CmHelpMenu): removed.

2011-03-02  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11menu.c (application): call
	"gtk_ui_manager_ensure_update()" after add ui.

2011-03-01  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11cood.c (CoordWinUpdate): don't set type to the
	variable "d->type."

	* src/gtk/x11lgnd.c (CmLegendWindow): don't set type to the
	variable "d->type."

	* src/gtk/x11merge.c (CmMergeWindow): don't set type to the
	variable "d->type."

	* src/gtk/x11info.c (create_win, InfoWinUpdate): don't set type to the
	variable "d->type."

	* src/gtk/x11axis.c (CmAxisWindow): don't set type to the variable
	"d->type."

	* src/math/math_parser.c (parse_argument_list): reallocate memory
	for arguments if necessary.

	* src/gtk/x11file.c (CmFileHistory, CmFileNew): call
	"AddDataFileList()" only when the file is really opened.
	(update_file_obj_multi): call "AddDataFileList()" when "new_file"
	is TRUE and the file is really opened.
	(CmFileOpen): don't call "AddDataFileList()".
	(CmFileWindow): don't set type to the variable "d->type."

	* src/gtk/x11view.c (new_file_obj): call "AddDataFileList()" only
	when the file is really opened.

	* src/gtk/x11opt.c (PrefScriptDialogClose): call
	"create_addin_menu()".

	* src/gtk/x11commn.c (AddDataFileList): check if the file name is
	valid UTF-8 string or not.
	(AddDataFileList): call "create_recent_data_menu()".

	* src/gtk/x11menu.c (show_graph_menu, show_data_menu): removed.
	(application): call "create_addin_menu()" and
	"create_recent_data_menu()" after create UI.
	(create_addin_menu, create_recent_data_menu): remove parameter.
	(init_ngraph_app_struct): initialize "type" member of each struct.

2011-02-25  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* addin/cal.nsc: fix argument for "menu::show_window".

	* src/gtk/x11menu.c (ActionEntry): fix callback functions.

2011-02-24  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11menu.c (show_ui_definition): use "printfstdout()".

	* src/gtk/ox11menu.c (mx_get_accel_map): use "putstderr()" and
	"printfstdout()".

	* initfile/save_ui_file.nsc: NgraphUI.xml.win is automatically
	generated.

2011-02-23  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/ox11menu.c (mx_get_ui, mx_get_accel_map): added.
	(gtkmenu): add fields "get_ui" and "get_accel_map".

	* src/gtk/x11menu.c (read_keymap_file): read keymap file in the
	"CONFDIR".
	(show_ui_definition): added.

	* initfile/Makefile.am (update_ui_file): add rule.

	* initfile/save_ui_file.nsc: added.

	* initfile/NgraphUI.xml.win: added.

2011-02-22  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* initfile/NgraphUI.xml: added.
	* src/object.c (set_newobj_cb, set_delobj_cb): added.
	(newobj_alias): call "NewObjCB()" when "NewObjCB" is not NULL.
	(delobj): call "DelObjCB()" when "DelObjCB" is not NULL.

	* src/gtk/main.c (set_dir_defs): add setting for "PIXMAPDIR".

	* src/gtk/x11lgnd.c (CmLegendWindow): type of the first argument
	is "GtkToggleAction *".
	(CmLegendWindow): visibility is depend on the state of the action.

	* src/gtk/x11cood.c (CmCoordinateWindow): type of the first argument
	is "GtkToggleAction *".
	(CmCoordinateWindow): visibility is depend on the state of the action.

	* src/gtk/ox11menu.c (subwindow_show, subwindow_hide): removed.
	(mx_show_win, mx_hide_win): use "window_action_set_active()".
	(mx_toggle_win): use "window_action_toggle()".

	* src/gtk/x11file.c (CmFileHistory): get identifier of the history
	entry from second argument.
	(CmFileOpen): check number of instances.
	(update_file_obj_multi): don't call "set_graph_modified()" when
	"new_file" is TRUE and "ret" is "IDDELETE".
	(CmFileWindow): type of the first argument is "GtkToggleAction *".
	(CmFileWindow): visibility is depend on the state of the action.

	* src/gtk/x11view.c (ViewerEvPopupMenu, ViewerPopupMenu)
	(create_menu, create_popup_menu): removed.
	(ShowFocusFrame): call "set_focus_sensitivity()".
	(clear_focus_obj): type of the argument is "struct Viewer *".
	(clear_focus_obj): call "set_focus_sensitivity()".
	(ViewerPopupMenu): remove unused case.
	(CmViewerButtonArm): data point button can be default.

	* src/gtk/x11menu.h (Viewer): remove members "PToolbar",
	"CToolbar" and "popup_item".

	* src/gtk/x11menu.c (ActionEntry, create_action_group)
	(reate_ui_from_file): added.
	(application): use "GtkUIManager" to make the menu and toolbars.
	(set_focus_sensitivity, set_btn_press_cb, get_toolbar)
	(set_toolbar_caption, show_graph_menu, show_data_menu)
	(check_instance, check_exist_instances)
	(window_action_set_active, window_action_toggle)
	(create_action_group): added.
	(CmReloadWindowConfig): use "window_action_set_active".

	* src/gtk/x11opt.c (PrefScriptDialogClose): don't update "add-in"
	menu.

	* src/gtk/x11graph.c (CmGraphHistory): check "uri" is NULL or not.

	* src/gtk/x11merge.c (CmMergeWindow): type of the first argument
	is "GtkToggleAction *".
	(CmMergeWindow): visibility is depend on the state of the action.

	* src/gtk/x11info.c (InfoWinUpdate): type of the first argument is
	"GtkToggleAction *".
	(InfoWinUpdate): visibility is depend on the state of the action.

	* src/gtk/dir_defs.h.in (PIXMAPDIR): added.

	* src/gtk/gtk_subwin.c (sub_window_hide, sub_window_show): static
	function.
	(sub_window_set_visibility): added.
	(sub_window_toggle_visibility): removed.
	(cb_del): use "window_action_set_active()".

	* src/gtk/Makefile.am (pixmapdir): added.
	(dir_defs.h): add pixmapdir setting.

	* src/gtk/x11axis.c (CmAxisWindow): type of the first argument is
	"GtkToggleAction *".
	(CmAxisWindow): visibility is depend on the state of the action.

	* pixmap/Makefile.am: added.

	* mingw/windows_make.sed: add command for pixmap directory.

	* configure.in (AC_CONFIG_FILES): add "pixmap/Makefile".

	* Makefile.am (SUBDIRS): add directory "pixmap".

2011-02-08  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/math/math_basic_function.c (math_func_for): don't set first
	argument to the memory when the argument is negative value.

	* src/gtk/ox11menu.c (menuinit): initialize fields
	"GTK_compile_version" and "GTK_runtime_version".
	(gtkmenu): add fields "GTK_compile_version" and
	"GTK_runtime_version".

	* src/gtk/x11print.c (CmOutputPrinter): use "GTK_CHECK_VERSION()".

	* src/gtk/x11menu.c (create_graphmenu, create_toolbar): use
	"GTK_CHECK_VERSION()".

	* src/gtk/x11lgnd.c (create_character_view): use
	"GTK_CHECK_VERSION()".

	* src/gtk/x11dialg.c: use "GTK_CHECK_VERSION()".

	* src/gtk/gtk_common.h: use "GTK_CHECK_VERSION()".

2011-02-04  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/math/math_function.rb: add comment after case labels.

	* src/math/math_function.h.in: fix indent.

2011-02-03  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/gtk_subwin.c (hide_minimize_menu_item): use
	"GTK_WIDGET_GET_WINDOW()".

	* src/gtk/Makefile.am (libngraph_la_CFLAGS): add option
	"-DGSEAL_ENABLE=1".

	* src/gtk/ogra2gdk.c (gra2gdk_create_pixmap): check if the
	variable "drawable" is NULL or not.

	* src/gtk/x11axis.c (AxisPosDialogRef): removed.
	(position_tab_create): use "AxisDialogRef()" for "changed" signal.
	(AxisDialogRef): set empty text when the index of the active item
	is 0.
	(position_tab_setup_item, scale_tab_setup_item): add item "none"
	to the GtkComboBoxEntry widget.

	* src/gtk/gtk_widget.c (show_color_sel): use
	"GTK_COLOR_SELECTION_DIALOG_GET_COLOR_SELECTION()".

	* src/gtk/x11gui.c (DialogExecute, DialogInput, DialogRadio)
	(DialogCombo, DialogComboEntry, DialogSpinEntry, DialogCheck)
	(FileSelectionDialog): use "GTK_DIALOG_GET_CONTENT_AREA()".

	* src/gtk/x11view.c (paste_cb, ViewerWinSetup, create_pix)
	(OpenGC): use "GTK_WIDGET_GET_WINDOW()".

	* src/gtk/x11menu.c (create_markpixmap): use
	"GTK_WIDGET_GET_WINDOW()".

	* src/gtk/x11lgndx.c (clear_view, LegendGaussDialogPaint): use
	"GTK_WIDGET_GET_WINDOW()".

	* src/gtk/x11lgnd.c (draw_arrow_pixmap, LegendArrowDialogPaint):
	use "GTK_WIDGET_GET_WINDOW()".

	* src/gtk/x11gui.c (get_window_geometry): use
	"GTK_WIDGET_GET_WINDOW()".

	* src/gtk/x11file.c (select_color): use
	"GTK_COLOR_SELECTION_DIALOG_GET_COLOR_SELECTION()".
	(draw_type_pixbuf): use "GTK_WIDGET_GET_WINDOW()".

	* src/gtk/ogra2x11.c (gtkinit): use "GTK_WIDGET_GET_WINDOW()".

	* src/gtk/gtk_subwin.c (sub_window_save_geometry)
	(sub_window_minimize): use "GTK_WIDGET_GET_WINDOW()".

	* src/gtk/x11view.c (ViewerWinSetup): use
	"GTK_WIDGET_SET_CAN_FOCUS()".

	* src/gtk/gtk_common.h (GTK_WIDGET_GET_WINDOW)
	(GTK_DIALOG_GET_CONTENT_AREA, GTK_WIDGET_SET_CAN_FOCUS)
	(GTK_COLOR_SELECTION_DIALOG_GET_COLOR_SELECTION): added.

2011-02-02  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11dialg.c (SetObjFieldFromWidget)
	(SetWidgetFromObjField, SetObjFieldFromStyle)
	(SetStyleFromObjField): use "gtk_bin_get_child()".

	* src/gtk/gtk_combo.c (combo_box_entry_create)
	(combo_box_entry_set_text, combo_box_entry_get_text): use
	"gtk_bin_get_child()".

2011-02-01  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* zsh/Makefile.am (zsh_DATA): remove settings for gra2ps and
	gra2wmf.

	* driver/Makefile.am (ngraphconf_DATA): remove settings for gra2ps
	and gra2wmf.

	* debian/ngraph.bash: remove settings for gra2ps and gra2wmf.

2011-01-31  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* test/math_test.nsc: don't create io object every time.

	* mingw/install.txt: update document.

2011-01-28  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/ofile.c (set_data_progress): variable "msgbuf" is not static
	now.
	(solve_equation): variable "eq" is not static now.

	* src/gtk/ox11menu.c (mx_cat): variable "buf" is not static now.

	* src/gtk/x11view.c (check_focused_obj_type): check variables
	"axis", "merge", "legend" and "text" are NULL or not.

	* src/gtk/x11menu.c (find_gra2gdk_inst): remove first parameter.
	(find_gra2gdk_inst): variable "inxt" is not static now.
	(find_gra2gdk_inst): remove variable "local" and "onamek".

2011-01-27  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11cood.c (CoordWinSetCoord): this function is now reentrant.

2011-01-26  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/oaxis.c (get_axis_gauge_num_str): use "GString" to create
	format string.
	(get_axis_gauge_num_str): numbering string is now well formated
	such as "5.0×10^-7@".

	* src/gtk/x11cood.c (CoordWinSetCoord): use static variable to
	create information strings.
	(CoordWinSetCoord, CoordWinUpdate): type of the coordinate window
	is "SubWin".

	* src/gtk/x11commn.c (FileAutoScale): use "GString" to create
	argument string for "auto_scale" field.

	* src/gtk/x11menu.h (NgraphApp): the type of members "InfoWin" and
	"CoordWin" is "struct SubWin *".

	* src/gtk/x11menu.c (application): now "NgraphApp.InfoWin" and
	"NgraphApp.CoordWin" don't have the member "str".

	* src/gtk/x11info.c (create_win, InfoWinUpdate): type of the
	information window is "SubWin".

	* src/gtk/x11axis.c (AxisDialogFile): use "GString" to create
	argument string for "get_auto_scale" field.
	(set_num_format): added.
	(numbering_tab_set_value): use "set_num_format()".
	(axis_list_set_val): variable "len" is not used.

2011-01-24  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gra.c (GRAC, _GRAopencallback): use "directfunc".

	* src/gra.h (directfunc): typedefed.

	* src/ogra2nul.c (g2nuldone): call "_exeparent()".

	* src/ogra2.c (gra2done): check number of element of "sarray" when
	"GC" is not equal to -1.

	* src/ogra.c (oGRAopen): fix indent.
	(oGRAdrawparent): add parameter "oGRAargv".
	(oGRAdraw): "oGRAargv" is local variable now.

2011-01-21  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11graph.c (SwitchDialogSetupItem)
	(switch_dialog_top_cb, switch_dialog_last_cb, SwitchDialogUp)
	(SwitchDialogDown, SwitchDialogClose): use "arraynget_int()".
	(SwitchDialogSetup): use "arraynget_str()".

	* src/gtk/x11axis.c (AxisDialogFile): use "arraynget_double()".

	* src/gtk/x11view.c (mouse_down_move_data, ViewUpdate)
	(ViewCopyAxis): use "arraylast_int()".
	(focus_new_insts, mask_selected_data, mouse_down_move_data): use
	"arraynget_int()".
	(Evaluate): use "arraynget_double()".

	* src/gtk/x11file.c (FileDialogFit, FileWinFit): use
	"arraylast_int()".
	(move_tab_setup_item): use "arraynget_int()" and
	"arraynget_double()".
	(move_tab_set_value, mask_tab_setup_item): use "arraynget_int()".

	* src/gtk/x11commn.c (AxisDel2, axis_move_each_obj, FitDel)
	(FitCopy, FitClear, FileAutoScale): use "arraylast_int()".

	* src/gtk/ox11dlg.c (dlgradio, dlgcombo): use "arraylast_int()".
	(get_sarray_argument): use "arraynget_int()".

	* src/ofile.c (opendata, get_fit_obj_id, f2dgetcoord)
	(f2dsettings, f2dbounding, f2dsave): use "arraylast_int()".

	* src/oagrid.c (get_grid_prm): use "arraylast_int()".

	* src/otext.c (textmatch): use "arraynget_int()".

	* src/oroot.c (obj_save_config_line_style): use "arraynget_int()".

	* src/orect.c (rectmatch): use "arraynget_int()".

	* src/opath.c (curvematch): use "arraynget_int()".

	* src/omerge.c (mergematch): use "arraynget_int()".

	* src/omark.c (markmatch): use "arraynget_int()".

	* src/olegend.c (legendmatch): use "arraynget_int()".

	* src/ogra2.c (gra2done, gra2disconnect): use "arraynget_str()".

	* src/ogra.c (oGRAdisconnect, oGRAopen): use "arraynget_str()".
	(oGRAopen): bug fix: use "arraylast_int()" instead of "*(char *)".

	* src/oaxis.c (get_axis_box, axismatch2, axisautoscalefile): use
	"arraynget_int()" and "arraynget_double()".
	(get_reference_parameter, axisadjust): use "arraylast_int()".

	* src/oarc.c (arcmatch): use "arraynget_int()".

	* src/nconfig.c (replaceconfig_match, replaceconfig): use
	"arraynget_int()".

	* src/object.c (arraynget_int, arraynget_double, arraynget_str)
	(arraylast_int): added.
	(getvaluestr): use "arraynget_int()", "arraynget_double()" and
	"arraynget_str()".
	(obj_do_tighten): use "arraylast_int()".

2011-01-20  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/gtk_widget.c (show_color_sel): set tooltip text.

	* src/gtk/x11lgnd.c (LegendMarkCB): added.
	(CmMarkDel, CmMarkUpdate): use "LegendMarkCB".
	(legend_dialog_setup_item, LegendMarkDialogMark): use
	"button_set_mark_image()".
	(CmLineUpdate, CmRectUpdate, CmArcUpdate, CmMarkUpdate)
	(CmTextUpdate): don't use the variable "ret".

	* src/gtk/x11dialg.c (_set_color): set tooltip text.

	* src/gtk/x11file.c (button_set_mark_image): added.
	(MarkDialogSetup, plot_tab_setup_item, FileDialogMark): use
	"button_set_mark_image()".
	(MarkDialog): check "type".

	* src/gtk/x11commn.c (SetFileHidden): add braces after "for"
	statement.

	* src/gtk/x11merge.c (CmMergeUpdate): don't use the variable
	"ret".

2011-01-19  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/object.h (n_value, N_VALUE): added.

	* src/object.h: use "N_VALUE *" instead of "char *" for an
	instance of an Ngraph object and return value of an object field.

	* src/gtk/ogra2gdk.c: ditto.

	* src/gtk/ogra2x11.c: ditto.

	* src/gtk/ogra2gdk.h: ditto.

	* src/gtk/x11lgndx.c: ditto.

	* src/gtk/ogra2cairofile.c: ditto.

	* src/gtk/x11graph.c: ditto.

	* src/gtk/ogra2gtkprint.c: ditto.

	* src/gtk/x11menu.c: ditto.

	* src/gtk/x11menu.h: ditto.

	* src/gtk/x11commn.c: ditto.

	* src/gtk/x11view.c: ditto.

	* src/gtk/x11file.c: ditto.

	* src/gtk/ox11menu.c: ditto.

	* src/gtk/ox11dlg.c: ditto.

	* src/gtk/ox11menu.h: ditto.

	* src/gtk/main.c: ditto.

	* src/gtk/x11print.c: ditto.

	* src/gtk/ogra2cairo.c: ditto.

	* src/gtk/ogra2cairo.h: ditto.

	* src/gra.c: ditto.

	* src/orect.c: ditto.

	* src/olegend.c: ditto.

	* src/gra.h: ditto.

	* src/osarray.c: ditto.

	* src/olegend.h: ditto.

	* src/ngraph.h: ditto.

	* src/ofile.c: ditto.

	* src/oroot.c: ditto.

	* src/oroot.h: ditto.

	* src/oint.c: ditto.

	* src/ogra2.c: ditto.

	* src/opath.c: ditto.

	* src/omerge.c: ditto.

	* src/ostring.c: ditto.

	* src/oio.c: ditto.

	* src/oshell.c: ditto.

	* src/ofit.c: ditto.

	* src/otext.c: ditto.

	* src/osystem.c: ditto.

	* src/object.c: ditto.

	* src/oiarray.c: ditto.

	* src/omath.c: ditto.

	* src/omark.c: ditto.

	* src/odraw.c: ditto.

	* src/odraw.h: ditto.

	* src/oarc.c: ditto.

	* src/ogra.c: ditto.

	* src/odouble.c: ditto.

	* src/ogra2prn.c: ditto.

	* src/odarray.c: ditto.

	* src/ogra2fil.c: ditto.

	* src/oagrid.c: ditto.

	* src/oprm.c: ditto.

	* src/oaxis.c: ditto.

	* src/ogra2nul.c: ditto

2011-01-17  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* test/math_test_new.dat: add test for the the functions "push",
	"pop", "unshift" and "shift".

	* doc/html_ja/math.html: add documents about the functions "push",
	"pop", "unshift" and "shift".

	* src/math/math_basic_function.c (math_func_unshift)
	(math_func_shift, math_func_pop)
	(math_func_push): added.

	* src/math/math_function.h.in: add "push", "pop", "unshift" and
	"shift".

	* src/math/math_operator.rb: check coments.

2011-01-14  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/opath.c (arrowdraw): check if the path should be closed or
	not.
	(draw_stroke): last parameter represents that the path should be
	closed or not.

	* src/ofile.c (draw_fit, curveoutfile): initialize variable "a".
	(curveout, curveoutfile): use "FREE_INTP_BUF()".
	(UPDATE_PROGRESS_LINE_NUM): added.
	(hskipdata, getdata_sub1, getdataraw): use
	"UPDATE_PROGRESS_LINE_NUM".

2010-12-24  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/gtk_widget.c (color_button_key_event): added.
	(create_color_button): the function "color_button_key_event()" is
	connected to "key-press-event" and "key-release-event".

2010-12-23  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/osystem.c (WEB): change url (sourceforge).

	* src/gtk/x11file.c (FitDialogSetSensitivity): show simple
	equation when the "type" is FIT_TYPE_POLY and "dim == 1".

2010-10-20  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/ntime.c (append_date_str): format string for "%y" is "%02d".

	* src/gtk/x11lgnd.c (insert_selcted_char): focus entry widget
	after insert character.

2010-10-19  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/object.c (error): add braces after "if" statements.

2010-10-15  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/ofile.c (f2dredraw): check the "type" is "PLOT_TYPE_FIT" or
	not.

2010-10-14  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11gui.c (DialogExecute): don't use "data->show_buttons".

	* src/gtk/x11file.c (MarkDialogSetup): show number of the mark as a
	tooltip.

2010-10-13  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* addin/legend.tcl (savescript): don't set "fill_A" field.

	* src/gtk/x11file.c (draw_type_pixbuf): add braces after "if"
	statement.
	(create_type_color_combo_box): renamed from
	"create_type_combo_box()" .
	(create_type_combo_box): create only "type", "mark" and
	"interpolation" item.
	(start_editing_type): use "create_type_color_combo_box()".

	* src/gtk/gtk_liststore.c (create_object_cbox): added.
	(start_editing_obj): use "create_object_cbox()".

2010-10-07  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11file.c (create_type_combo_box): change order of
	columns.
	(create_type_combo_box): use "OBJECT_COLUMN_TYPE_STRING",
	"OBJECT_COLUMN_TYPE_PIXBUF" and "OBJECT_COLUMN_TYPE_INT".
	(select_color): use "OBJECT_COLUMN_TYPE_INT".

	* src/gtk/gtk_liststore.h (OBJECT_COLUMN_TYPE_STRING)
	(OBJECT_COLUMN_TYPE_PIXBUF, OBJECT_COLUMN_TYPE_INT): added.

	* src/gtk/gtk_liststore.c (start_editing_obj): change order of
	columns.
	(start_editing_obj): use "OBJECT_COLUMN_TYPE_STRING",
	"OBJECT_COLUMN_TYPE_PIXBUF" and "OBJECT_COLUMN_TYPE_INT".

2010-10-06  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11file.c (create_type_combo_box): show number of a merk
	type.

2010-09-22  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11file.c (file_list_set_val): unref pixbuf.

	* src/gtk/x11commn.c (ProgressDialogFinalize): set NULL to
	"ProgressBar2".

	* src/gtk/x11menu.h (NgraphApp):remove members "swin" and
	"iconpix".

	* src/gtk/x11menu.c (create_icon): renamed from "createicon()".
	(create_icon): unref pixbufs. free "list".

	* src/gtk/gtk_subwin.c (sub_window_create): unref pixbufs. free
	"list".

	* src/ofit.c (fitput): use "math_equation_free()" instead of
	"g_free()".

2010-09-15  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/gtk_widget.c (direction_icon_released): change direction
	from 360 to 0 or 0 to 360 when an icon is released.

	* src/gtk/x11lgnd.c (LegendArcDialogSetup): use
	"create_direction_entry()" instead of "create_spin_entry_type()".

2010-09-13  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/ofile.c (put_func, rectout): fix indent.

2010-09-09  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/math/math_function.h.in: add functions "cm".

	* src/math/math_basic_function.c (math_func_rm): added.

2010-09-08  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/ntime.c (get_iso_8601_week): added.

	* src/gtk/main.c (main): don't set "LC_TIME".

	* src/math/math_basic_function.c (math_func_mjd2year)
	(math_func_mjd2month, math_func_mjd2day): use "mjd2gd()" in
	"ntime.c".
	(math_func_mjd2wday, math_func_mjd2yday): added.

2010-09-07  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/oaxis.c (mjd_to_date_str): use "nstrftime()" instead of
	"strftime()".
	(get_axis_gauge_num_str): added.
	(numformat): use "get_axis_gauge_num_str()".

	* src/oprm.c (gettimeval2): meved from "ntime.c".

	* src/ntime.c (mjd2gd, append_date_str, nstrftime): added.

	* src/gtk/x11cood.c (CoordWinSetCoord): use "nstrftime()" instead
	of "strftime()".

2010-09-03  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/ofile.c (lineout, curveout, stairout, draw_fit): set line
	style attribute when "EXPAND_DOTTED_LINE" is false.

	* src/gra.c (GRAreopen, _GRAclose, GRAclose, GRAcurvefirst):
	allocate , free and initialize "gdashlist" and so on only when
	"EXPAND_DOTTED_LINE" is treu.
	(GRAdashlinetod): expand dotted line only when
	"EXPAND_DOTTED_LINE" is treu.

	* src/gra.h (EXPAND_DOTTED_LINE): added.

2010-09-02  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/nstring.c (get_printf_format_str): call "g_strdup()" after
	check the strings.

	* src/ofile.c (rectout): initialize "emig" and "emng".

	* src/gtk/gtk_widget.c (show_color_sel, create_color_button):
	check "Menulocal.use_opacity".

	* src/gtk/ogra2cairo.c (gra2cairo_init): initialize "local->use_opacity".
	(gra2cairo_output): check "local->use_opacity".
	(use_opacity): added.
	(gra2cairo): add field "use_opacity".

	* src/gtk/x11print.c (OutputImageDialogSetupItem): setup "d->use_opacity".
	(OutputImageDialogSetup): add widget to set "Use opacity".
	(OutputImageDialogClose): save setting of "d->use_opacity".
	(CmOutputImage): set opacity setting to "g2wobj".
	(CmOutputPrinter, CmOutputViewer): save setting of "Menulocal.use_opacity".

	* src/gtk/ox11menu.h (menulocal): add member "use_opacity".

	* src/gtk/x11dialg.h (MiscDialog, OutputImageDialog): add member
	"use_opacity".

	* src/gtk/ox11menu.c (menuinit): initialize opacity setting.
	(mxuse_opacity): added.
	(gtkmenu): add field "use_opacity".

	* src/gtk/x11dialg.c (_set_color, _putobj_color): check
	"Menulocal.use_opacity".

	* src/gtk/x11file.c (select_color): use opacity settings when
	"Menulocal.use_opacity" is treu.

	* src/gtk/x11opt.c (MiscDialogSetupItem): setup "d->use_opacity".
	(MiscDialogSetup): add widget to set "Use opacity".
	(MiscDialogClose): save setting of "d->use_opacity".

	* debian/control (Depends): use "${shlibs:Depends}".

2010-09-01  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/nstring.c (add_printf_formated_str): free "format2".

2010-08-31  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11file.c (select_color): set opacity.

2010-08-30  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/ofile.c (f2ddata_buf, f2ddata): use "struct rgba" instead of
	"int".
	(file_alpha): added.
	(file_func): add function "ALPHA".
	(opendata): use fields "A" and "A2".
	(dataadd): add parameters "fa" and "a".

	* src/oaxis.c (axis): rename fields from "gauge_alpha" to
	"gauge_A" end "num_alpha" to "num_A".

	* src/oagrid.c (agridinit): initialize field "BA".
	(draw_background, agriddraw): remove parameter "alpha".
	(draw_background): use field "BA".
	(agriddraw): use field "A".
	(agrid): add field "BA".

	* src/oarc.c (arcinit): initialize field "stroke_A" and "fill_A".
	(arcdraw): use field "stroke_A" and "fill_A".
	(arc): add field "stroke_A" and "fill_A".

	* src/omark.c (markinit): initialize field "A2".
	(markdraw): use field "A" and "A2".
	(mark): add field "A2".

	* src/opath.c (arrowinit): initialize field "stroke_A" and "fill_A".
	(draw_stroke, draw_fill): remove parameter "alpha".
	(draw_stroke): use field "stroke_A".
	(draw_fill): use field "fill_A".
	(arrow): add field "stroke_A" and "fill_A".

	* src/olegend.c (put_color_for_backward_compatibility): set opacity.

	* src/orect.c (rectinit): initialize field "stroke_A" and "fill_A".
	(rectdraw): use field "stroke_A" and "fill_A".
	(rect): add field "stroke_A" and "fill_A".

	* src/gra.c (GRAmark): remove parameter "alpha". add parameter
	"fa" and "ba".

	* src/gtk/gtk_widget.c (show_color_sel, create_color_button): use
	opacity control.

	* src/gtk/x11dialg.c (_set_color, _putobj_color): setup opacity.

	* src/gtk/x11axis.c (opacity_setup): removed.

2010-08-27  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/oaxis.c (axisinit): initialize field "gauge_alpha" and
	"num_alpha".
	(AxisConfig): add data "alpha", "gauge_alpha" and "num_alpha".
	(numbering): use field "num_alpha".
	(draw_gauge): use field "gauge_alpha".
	(axisdraw): use field "alpha".
	(axis): add fields "num_alpha" and "gauge_alpha".

	* src/oarc.c (arcdraw): use field "alpha".

	* src/omark.c (markdraw): use field "alpha".

	* src/otext.c (textdraw): use field "alpha".
	(TextConfig): add data "alpha".

	* src/opath.c (draw_stroke, draw_fill): add parameter "alpha".
	(arrowdraw): use field "alpha".

	* src/ofile.c (f2ddata): add member "alpha".
	(opendata): use field "alpha".
	(markout, lineout, curveout, rectout, errorbarout, stairout)
	(barout, draw_fit): use "fp->alpha".
	(FileConfig): add data "alpha".

	* src/oagrid.c (draw_background): add parameter "alpha".
	(agriddraw): use field "alpha".

	* src/odraw.c (drawinit): initialize field "alpha".
	(draw): add field "alpha".

	* src/orect.c (rectdraw): use field "alpha".

	* src/gra.c (GRAmark): add parameter "alpha".

	* src/gtk/x11lgnd.c (init_legend_dialog_widget_member): initialize
	"d->opacity".
	(legend_dialog_setup_item): setup "d->opacity".
	(legend_dialog_close): save opacity.
	(opacity_setup): added.
	(LegendArrowDialogSetup, LegendRectDialogSetup)
	(LegendArcDialogSetup, LegendMarkDialogSetup)
	(legend_dialog_setup_sub): add widget to set opacity.

	* src/gtk/x11file.c (plot_tab_setup_item): setup "d->opacity".
	(plot_tab_create): add widget to set opacity.
	(plot_tab_set_value): save opacity.

	* src/gtk/x11lgndx.c (LegendGaussDialogSetupItem): setup "d->opacity".
	(LegendGaussDialogSetup): add widget to set opacity.
	(LegendGaussDialogClose): save opacity.

	* src/gtk/x11axis.c (opacity_setup): added.
	(GridDialogSetupItem, baseline_tab_setup_item)
	(gauge_tab_setup_item, font_tab_setup_item): setup "d->opacity".
	(GridDialogSetup, baseline_tab_create, gauge_tab_create)
	(font_tab_create): add widget to set opacity.
	(GridDialogClose, baseline_tab_set_value, gauge_tab_set_value)
	(font_tab_set_value): save opacity.

2010-08-26  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/oprm.c (prmload): don't use the field "num_jfont".
	(prmload): id of path object is not "pid" but "cid" when the type
	of the instance is "PATH_TYPE_CURVE".

	* src/gra.c (GRAcolor): add argument "alpha".
	(GRAC): add member "alpha".
	(GRAdraw): check "GRAClist[GC].alpha".

	* src/gtk/ogra2cairo.c (gra2cairo_output): use
	"cairo_set_source_rgba()" when the value "alpha" is less than 255.

2010-08-25  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/ogra2cairo.c (gra2cairo_output): now 7th argument of "C"
	command means not only fill method but stroke.

	* src/oarc.c (get_pos): removed
	(arcdraw): use 7th argument of "C" command to draw stroke.

2010-08-19  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gra.c (GRAdrawtext, GRAtextextent): consider subscript
	 strings for the calculation of new line position.

2010-08-18  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gra.c (GRAdrawtext, GRAtextextent): use "case" instead of
	"if".
	(GRAtextextent): bug fix: fix calculation of bounding box when
	"c[j] == '\n" and "scriptf != 0".
	(GRAtextextent, GRAtextextentraw): fix calculation of space.
	(get_str_bbox): fix treatment of '\' character.

	* src/gtk/ogra2cairo.c (gra2cairo_output): fix treatment of '\'
	character.

2010-08-17  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11commn.c (LoadNgpFile, LoadPrmFile): call
	"set_axis_undo_button_sensitivity()".

	* src/gtk/x11graph.c (CmGraphNewMenu): call
	"set_axis_undo_button_sensitivity()".

	* src/gtk/gtk_liststore.c (list_store_set_align): added.

	* src/gtk/x11axis.c (axis_list_set_val): use "%g" instead of
	"%.2e" for format string of the function "snprintf()".
	(CmAxisWindow): call "list_store_set_align()" for columns
	AXIS_WIN_COL_MIN, AXIS_WIN_COL_MAX and. AXIS_WIN_COL_INC.

2010-07-16  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* initfile/Ngraph.nsc: -n option works after all other options are managed.

2010-07-13  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11lgnd.c (legend_dialog_close): save color of
	"d->color".

2010-07-09  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/omath.c (math): remove fields "m00" to "m19".
	(mlocal): remove member "idpm".
	(msettbl, minit, mparam): now memories are not used.

	* src/math/math_basic_function.c (MATH_FUNCTION_MEMORY_NUM):
	added.
	(init_memory): added.
	(math_func_rm, math_func_m, math_func_for): use static variable
	"Memory".

	* src/math/math_equation.c (math_equation_clear): don't initialize
	"eq->memory".

	* src/math/math_equation.h (_math_equation): remove member
	"memory".

	* src/gtk/x11lgnd.c (create_character_panel): use
	"Menulocal.char_map".

	* src/gtk/ox11menu.c (MenuConfig): use "character_map" instead of
	"greece_character", "mathematics_character", "physics_character"
	and "misc_character".
	(save_char_map_config, menu_config_set_char_map): added.
	(menu_save_config_sub, mgtkloadconfig): add case for
	"MENU_CONFIG_TYPE_CHARMAP".
	(menulocal_finalize): free "Menulocal.char_map".

2010-07-08  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/ox11menu.h (menulocal): add members "greece_char",
	"mathematics_char", "physics_char" and "misc_char".

	* src/gtk/ox11menu.c (MenuConfigMisc): "browser" and
	"help_browser" ins member of miscellaneous settings menu.
	(MenuConfig): append character selection data.

	* src/gtk/x11opt.c (FontSettingDialogClose): free returned string
	from the function "list_store_get_string()".

	* src/gtk/x11lgnd.c (insert_selcted_char, create_character_view)
	(create_character_panel): added.
	(LegendTextDialogSetup): append character selection panel.

2010-07-07  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* initfile/Ngraph.ini.win: add alternative fonts settings.

	* src/gtk/ogra2cairo.c (free_font_map): free "d->alternative".
	(create_font_map): add 3rd argument "alternative".
	(gra2cairo_save_config): save alternative fonts.
	(loadconfig): load alternative fonts.
	(gra2cairo_add_fontmap): don't duplicate font names.
	(gra2cairo_set_alternative_font): added.
	(loadfont): use alternative fonts.

	* src/gtk/x11dialg.h (FontSettingDialog): added.

	* src/gtk/x11opt.c (FontSettingDialogSetupItem)
	(AlternativeFontListSelCb, get_font_family)
	(FontSettingDialogAddAlternative)
	(FontSettingDialogRemoveAlternative)
	(FontSettingDialogDownAlternative)
	(FontSettingDialogUpAlternative, FontSettingDialogSetup)
	(FontSettingDialogClose, FontSettingDialog): added
	(get_font_alias): type of the parameter is "struct
	FontSettingDialog *".
	(PrefFontDialogUpdate, PrefFontDialogAdd): use
	"FontSettingDialog".
	(PrefFontDialogSetupItem, PrefFontDialogSetup): show alternative
	fonts.

2010-07-02  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/nstring.c (getitok, getitok2): type of the 3rd parameter is
	"const char *".
	(add_printf_formated_str): type of the 1st parameter is "GString *".

	* src/otext.c (textprintf): use "GString *" instead of "char *".

	* src/gra.c (GRAexpandobj, GRAexpandpf): use "GString *" instead
	of "char *".

2010-07-01  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/ioutil.c (getrelativepath): use "GString *" instead of "char *".

	* src/gra.c (GRAexpandmath): use "GString *" instead of "char *".

	* src/ofile.c (f2dhead, f2dsave): use "GString *" instead of
	"char *".

	* src/oroot.c (osave): use "GString *" instead of "char *".

	* src/odraw.c (pathsave): use "GString *" instead of "char *".

	* src/oaxis.c (axis_save_group): use "GString *" instead of
	"char *".

	* src/ogra2prn.c (gra2p_output): use "GString *" instead of
	"char *".

	* src/shellcm.c (cmeval, cmread, cmdexpr): use "GString *" instead
	of "char *".

	* src/gtk/ogra2cairo.c (gra2cairo_output): use
	"g_unichar_to_utf8()"instead of "iso8859_to_utf8()".

	* src/gra.c (GRAtextextent, get_str_bbox): use
	"g_string_append_unichar()"
	(GRAdrawtext): convert string such as "\x31" to unicode character.

	* src/strconv.c (iso8859_to_utf8): removed.

2010-06-30  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11dialg.c (set_entry_from_obj_point): use "GString *"
	instead of "char *".

	* src/gtk/x11file.c (load_tab_set_value): use "GString *" instead
	of "char *".

	* src/gtk/x11view.c (eval_dialog_copy_selected)
	(CopyFocusedObjects): use "GString *" instead of "char *".

	* src/gra.c (GRAtextextent, GRAexpandtext): use "GString *"
	instead of "char *".

	* src/ogra2nul.c (g2nul_strwidth): added.
	(g2nul_charwidth): removed.
	(gra2null): remove "_charwidth" field, add "_strwidth" field.

	* src/ogra.c (oGRAopen): use "_strwidth" field instead of
	"_charwidth" field.

	* src/gra.c (GRAC): remove "charwidth" member, add "strwidth"
	member.
	(_GRAopen, GRAopen): initialize "strwidth" member.
	(GRAstrwidth): added.
	(GRAcharwidth): removed.
	(GRAtextextent, GRAtextextentraw, get_str_bbox): use
	"GRAstrwidth()" instead of "GRAcharwidth()".

	* src/gtk/x11opt_proto.h (CREATE_NAME): call
	"gtk_scrolled_window_set_policy()".

	* src/gtk/ogra2cairo.c (gra2cairo): remove "_charwidth" field, add
	"_strwidth" field.
	(gra2cairo_strwidth): added.
	(gra2cairo_charwidth): removed.

	* src/gtk/ogra2cairofile.c (gra2cairofile): remove "_charwidth"
	field, add "_strwidth" field.

	* src/gtk/ogra2x11.c (gra2gtk): remove "_charwidth" field, add
	"_strwidth" field.

2010-06-28  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/oprm.c (prminit, prmload): the field "symbol_greek" in not
	used now.
	(remarkconv): use UTF-8 string.
	(prm): the field "symbol_greek" is removed.

	* src/omerge.c (mergeinit, mergedraw, mergebbox): the field
	"symbol_greek" in not used now.

	* src/gra.c (GRAexpandtext, GRAdrawtext, GRAtextextent)
	(get_str_bbox): use "g_ascii_isxdigit()" instead of "isxdigit()".
	(GRAtextextent): use "g_ascii_xdigit_value()".
	(get_str_bbox): added.
	(GRAboundingbox): use "get_str_bbox()".
	(GRAinputold): just convert string from Shift-jis to UTF-8 when
	the variable "code" is 'K'.

	* src/gtk/x11dialg.h (MergeDialog, PrmDialog): the member
	"greek_symbol" is removed.

	* src/gtk/x11graph.c (PrmDialogSetup, PrmDialogClose): the field
	"symbol_greek" in not used now.

	* src/jnstring.c: removed.

2010-06-25  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* initfile/Ngraph.ngp: change font settings.

	* initfile/Ngraph.ini.win: change font settings.

	* initfile/Ngraph.ini.in: change font settings.

	* driver/ngp2.in: remove "-wmf" option.

	* driver/Makefile.am (ngraphconfdir): gra2ps and gra2wmf are not
	used now.

	* src/ogra2nul.c (g2nul_charwidth, g2nul_charheight): check
	backward compatibility.
	(addgra2null): initialize "FontDataHash".

	* src/oaxis.c (AxisConfig): remove configuration "num_jfont", add
	configuration "num_font_style".
	(axisinit): "jfont" field does not exist now.
	(axis): add field "num_font_style".

	* src/jnstring.c (njis2jms, njms2euc, neuc2jms): removed.

	* src/shellcm.c (cmdexpr): remove old math related codes.

	* src/mathcode.c: remove old math related codes.

	* src/omath.c: remove old math related codes.

	* src/object.c (getargument): remove old math related codes.

	* src/otext.c (TextConfig): remove configuration "jfont". add
	configuration "style".
	(textinit): "jfont" field does not exist now.
	(textgeometry): check value of "style" field.
	(text): add field "style".

	* src/ofit.c: remove old math related codes.

	* src/mathfn.c: remove old math related functions.

	* src/opath.c (draw_stroke): arr parameter "intp".

	* src/shell.c (str_calc): remove old math related codes.

	* src/ofile.c: remove old math related codes.

	* src/gra.c (FONT_STYLE_NORMAL, FONT_STYLE_BOLD)
	(FONT_STYLE_ITALIC): added.
	(GRAC): add member "style".
	(GRAdraw, GRAcharwidth, GRAcharascent, GRAchardescent)
	(GRAtextstyle): 4th argument of the "H" command represents style
	of the font.
	(GRAoutkanji): removed.
	(GRAexpandmath): remove old math related codes.
	(GRAexpandtext): use "case" statement.
	(GRAdrawtext, GRAtextextent): add format command "\B", "\I" and
	"\N".
	(GRAtextextent, GRAtextextentraw): don't check "kanji" code.
	(GRAinputold): convert argument of the "S" command Shift-JI to
	UTF-8.

	* src/ioutil.c (getrelativepath): "cwd2" may not be Shift-JIS
	code.

	* src/gtk/ogra2cairo.h (compatible_font_info): added.

	* src/gtk/ogra2cairo.c (check_type, gra2cairo_get_font_type_str):
	removed.
	(create_font_map): don't save type, symbol and twobyte.
	(gra2cairo_save_config): save "font" configurations. remove
	"font-map" configurations.
	(loadconfig): load "font" configurations.
	(loadconfig): load "font-map" configurations only when the "font"
	configuration related to the font is not loaded yet.
	(init_conf): don't initialize "FontFace".
	(gra2cairo_update_fontmap, gra2cairo_add_fontmap): remove
	parameter "type" and "two_byte".
	(gra2cairo_done): save configurations when old configurations are
	used.
	(gra2cairo_get_compatible_font_info): add.
	(loadfont): add parameter "font_style" and "symbol".
	(loadfont): set weight and style every time.
	(gra2cairo_output): use UTF-8 in the 'S' command.
	(gra2cairo_charwidth): use "gunichar" instead of "char *".
	(addgra2cairo): initialize "CompatibleFontHash".

	* src/gtk/main.c (get_obj_font_list): remove japanese specified
	codes.

	* src/gtk/x11dialg.h (AxisFont, LegendDialog): add member
	"font_bold" and "font_italic".

	* src/gtk/x11lgnd.c (LegendTextCB): remove japanese specified
	settings.
	(init_legend_dialog_widget_member): remove "d->jfont", add
	"d->font_bold" and "d->font_italic".
	(get_font, set_font): get and set font style settings.
	(set_fonts): remove.
	(legend_dialog_setup_item, legend_dialog_close)
	(legend_dialog_setup_sub, legend_list_set_property): remove
	japanese specified settings.
	(legend_dialog_setup_item, legend_dialog_close)
	(legend_dialog_setup_sub): get and set font style settings.

	* src/gtk/x11dialg.c (SetFontListFromObj)
	(SetObjFieldFromFontList): remove japanese specified settings.

	* src/gtk/x11file.c (FitDialogResult): remove old math related
	codes.
	(draw_type_pixbuf): add 3rd argument for "GRAtextstyle()".

	* src/gtk/x11view.c (CopyFocusedObjects, focus_new_insts)
	(text_dropped): remove japanese specified settings.

	* src/gtk/x11menu.c (USE_EXT_DRIVER): add.
	(show_graph_menu_cb, create_graphmenu, create_preferencemenu):
	external driver menu is not shown.

	* src/gtk/x11opt.c (PrefFontDialogSetupItem)
	(create_font_selection_dialog): don't save font type.
	(create_font_selection_dialog)
	(set_font_from_font_selection_dialog): remove japanese specified
	settings.
	(set_font_from_font_selection_dialog): remove settings related to
	font type.
	(PrefFontDialogSetup): don't show the style of the font.

	* src/gtk/x11merge.c (MergeDialogSetupItem, MergeDialogSetup)
	(MergeDialogClose): remove japanese specified settings.

	* src/gtk/x11axis.c (font_tab_set_value, font_tab_setup_item)
	(font_tab_create): remove japanese specified settings.
	(font_tab_set_value, font_tab_setup_item, font_tab_create): add
	font style settings.

	* demo/encodeing.ngp: remove.

	* demo/demo5a.ngp: change font settings.

	* demo/demo5b.ngp: change font settings.

	* demo/demo5c.ngp: show muliti languages.

	* demo/demo5d.ngp: change font settings.

	* demo/demo5e.ngp: change font settings.

	* demo/demo4.ngp.in: change font settings.

	* demo/demo3.ngp.in: change font settings.

	* demo/demo2.ngp.in: change font settings.

	* demo/demo1.ngp.in: change font settings.

	* debian/rules: remove configure option "--enable-janese".

2010-06-17  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/opath.c (distance, check_point_match, point_match): add.
	(curvematch): use "point_match()".
	(get_arrow_pos): use "distance()".

2010-06-16  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/opath.c (path_fill_mode): "fill" field accept "true" or
	"false" .
	(PATH_FUILL_MODE, path_fill_rule, PATH_FILL_RULE): add.
	(draw_stroke, draw_fill): add.
	(arrowdraw): use "draw_stroke()" and "draw_fill()".
	(put_fill_mode): add.
	(arrow): use "put_fill_mode()" for "fill" field.
	(arrow): add "fill_rule" field.

	* src/gtk/x11lgnd.c (legend_dialog_set_sensitive): sensitivity of
	the widget "d->fill_rule" is depend on the widget "d->fill".
	(legend_dialog_setup_item, legend_dialog_close): field name for
	the widget "d->fill_rule" is "fill_rule".
	(LegendArrowDialogSetup): add widget "d->fill".

2010-06-11  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/opath.c (get_arrow_pos): remove parameter "strict".
	(arrowdraw, arrowbbox): remove 3rd argument of the function
	"get_arrow_pos()".

2010-06-10  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/opath.c (get_arrow_pos): add strict mode.
	(arrowdraw, arrowbbox): use strict mode for "get_arrow_pos()" when
	the type is "PATH_TYPE_LINE".

	* demo/demo5a.ngp: change position of "path" instances.

	* src/gtk/x11lgndx.c (LegendGaussDialogSetupItem): use
	"set_stroke_color()" instead of "set_color()".
	(LegendGaussDialogClose): use "putobj_stroke_color()" instead of
	"putobj_color()".

2010-06-09  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/ox11menu.c (graph_modified_sub): call "set_modified_state()".

	* src/gtk/x11menu.c (set_modified_state): add.

2010-06-04  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/oarc.c (arcinit): initialize fields "miter_limit", "join"
	and "stroke".
	(get_pos): add.
	(arcdraw): use "stroke_[RGB]" instead of "[RGB]".
	(arcdraw): use "stroke", "miter_limit", "join", "fill_[RGB]" and
	"close_path".
	(arcbbox): use "stroke" and "close_path".
	(arc): add fields "fill_[RGB]", "stroke_[RGB]", "close_path" and
	"stroke".

	* src/odraw.h (JOIN_TYPE): add.

	* src/olegend.c (put_color_for_backward_compatibility): add.

	* src/orect.c (rectdraw): use "fill_[RGB]" and "stroke_[RGB]"
	instead of "[RGB]2" and "[RGB]".
	(rectdraw, rectbbox, rectmatch): don't use "frame". use "stroke".
	(rect_frame, put_color2): add.
	(rect): add fields "fill_[RGB]", "stroke_[RGB]" and "stroke".

	* src/gtk/x11dialg.h (LegendDialog): add member "stroke_color".

	* src/gtk/x11lgnd.c (init_legend_dialog_widget_member): initialize
	"d->fill_color" and "d->stroke_color".
	(set_sensitive_with_label): fix typo.
	(legend_dialog_set_sensitive): set sensitivity of "d->fill_color"
	and "d->stroke_color".
	(legend_dialog_setup_item): setup "d->fill_color" and
	"d->stroke_color".
	(legend_dialog_close): get value from "d->fill_color" and
	"d->stroke_color".
	(fill_color_setup, stroke_color_setup): add.
	(LegendArrowDialogSetup, LegendRectDialogSetup): use
	"fill_color_setup()" and "stroke_color_setup()" instead of
	"color_setup()" and "color2_setup()" respectively.
	(LegendRectDialogSetup): remove "d->frame" setting. add
	"d->stroke" setting.
	(LegendArcDialogSetup): use "fill_color_setup()" and
	"stroke_color_setup()" instead of "color_setup()" and
	"color2_setup()" respectively.
	(LegendArcDialogSetup): add settings for "d->stroke" and
	"d->close_path".
	(COLOR_TYPE): add.
	(legend_list_set_color): support "COLOR_TYPE_FILL" and
	"COLOR_TYPE_STROKE".
	(legend_list_set_property): use "COLOR_TYPE_FILL" and
	"COLOR_TYPE_STROKE".

	* src/gtk/x11dialg.c (set_fill_color, set_stroke_color)
	(putobj_fill_color, putobj_stroke_color): add.

2010-06-03  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11view.c (create_path): use "goto" statement to handle
	errors.

	* src/object.c (newobj_alias): check arguments.

2010-06-02  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* demo/encoding.ngp: use "path" object instead of "line" object.

	* demo/demo5d.ngp: use "path" object instead of "line" object.

	* demo/demo5a.ngp: use "path" object instead of "line" object.

	* demo/demo4.ngp.in: use "path" object instead of "line" object.

	* demo/demo3.ngp.in: use "path" object instead of "line" object.

	* demo/demo2.ngp.in: use "path" object instead of "curve" object.

	* addin/legend.tcl (makescript): use "path" object instead of
	"line" object.

	* initfile/Ngraph.ngp (gra::draw_obj): remove "line", "polygon"
	and "curve" objects. add "path" object.

	* src/Makefile.am (ngraph_SOURCES): remove "oline.c", "opolygon.c"
	and "ocurve.c". add "opath.c" and "opath.h".

	* src/oprm.c (prmload): use "path" object instead of "line",
	"polygon" and "curve" objects.

	* src/shellcm.c (cmnew): use object name from the
	functions"getobjiname()" for "newobj_alias()".

	* src/object.c (newobj_alias): add.
	(newobj): use "newobj_alias()".
	(getobjiname): add.
	(chkobjilist, getobjilist): use "getobjiname()".

	* src/gtk/gtk_widget.c (get_widget): add.
	(spin_entry_set_val, spin_entry_get_val): use "get_widget()".

	* src/gtk/main.c (obj_add_func_ary): remove "addline", "addcurve"
	and "addpolygon". add "addpath".

	* src/gtk/x11dialg.h: remove prototype of unused functions.
	(LegendDialog):add member "stroke", "path_type" and
	"close_path". remove member "color2_label".

	* src/gtk/x11lgnd.c (legendlist): remove "line", "polygon" and
	"curve" items. add "path" item.
	(Ldlg): remove "DlgLegendCurve" and "DlgLegendPoly".
	(LegendType): remove "LegendTypeLine", "LegendTypeCurve",
	"LegendTypePoly". add "LegendTypePath".
	(LegendLineCB): show the type of the "path" object.
	(init_legend_dialog_widget_member): initialize "d->path_type",
	"d->stroke" and "d->close_path".
	(set_sensitive_with_labdl): add.
	(legend_dialog_set_sensitive): use "set_sensitive_with_labdl()".
	(legend_dialog_set_sensitive): set sensitivity for stroke and fill
	related widgets.
	(legend_dialog_setup_item): set up "d->stroke", "d->path_type" and
	"d->close_path".
	(legend_dialog_setup_item): call "get_widget()" before call
	"gtk_range_set_value" and "gtk_entry_set_text()".
	(width_setup, style_setup, miter_setup, join_setup, color_setup)
	(color2_setup): save label instead of control widgets.
	(LegendCurveDialogSetup, LegendCurveDialog, LegendPolyDialogSetup)
	(LegendPolyDialog, CmCurveDel, CmCurveUpdate, CmCurveMenu)
	(CmPolyDel, CmPolyUpdate, CmPolygonMenu): removed.
	(LegendArrowDialogSetup): add control widgets for "d->stroke",
	"d->fill_rule", "d->path_type" and "d->close_path".
	(CmLineDel, CmLineUpdate): use "path" object instead of "line"
	object.
	(LegendWinLegendUpdate, legend_list_set_property): remove case for
	"LegendTypeLine", "LegendTypeCurve" and "LegendTypePoly". add case
	for "LegendTypePath".
	(legend_list_set_property): show some attributes for "path"
	object.

	* src/gtk/x11dialg.c (initdialog): don't initialize
	"DlgLegendCurve" and "DlgLegendPoly".
	(SetWidgetFromObjField, SetObjFieldFromWidget)
	(SetObjFieldFromStyle, SetStyleFromObjField, _putobj_color)
	(_set_color): call "get_widget()" for the parameter "widget".
	(SetComboList, SetComboList2): removed.
	(SetObjFieldFromText, SetTextFromObjField, SetObjFieldFromSpin)
	(SetSpinFromObjField, SetObjFieldFromToggle)
	(SetToggleFromObjField, SetObjFieldFromStyle): now these functions
	are static.

	* src/gtk/x11view.c (create_legend2): create only "path" object.
	(create_legendx): create "path" object instead of "curve" object.
	(ViewerEvLButtonDblClk, ViewerEvRButtonDown): remove case for
	"LineB", "CurveB" and "PolyB". add case for "PathB".
	(ViewerEvRButtonDown): "g_object_unref()" should be called outside
	of the "switch" block.
	(ViewUpdate): don't check "line", "polygon" and "curve"
	objects. check "path" object.

	* src/gtk/x11menu.h (PointerType): remove "LineB", "CurveB" and
	"PolyB" add "PathB".

	* src/gtk/x11menu.c (Command2_data): remove "line", "polygon" and
	"curve" buttons. add "path" button.
	(create_legendmenu): remove "line", "polygon" and "curve" menu
	items. add "path" menu item.

	* src/gtk/x11graph.c (SwitchDialogSetupItem, SwitchDialogSetup):
	localize.
	(SwitchDialogSetup): check duplicate item.

2010-06-01  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/math/math_basic_function.c (mjd2gd): "mjd" must be an integer.

	* src/oline.c: removed.

	* src/ocurve.c: removed.

	* src/opolygon.c: removed.

2010-05-21  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/oaxis.c (anumdirchar): add new settings "oblique1" and
	"oblique2".
	(get_num_pos): renamed from "get_num_pos_parallel".
	(get_num_pos_normal): removed.
	(get_num_pos_oblique, get_num_ofst_oblique1)
	(get_num_ofst_oblique2): add.
	(draw_numbering_normalize): add case for "AXIS_NUM_POS_OBLIQUE1"
	and "AXIS_NUM_POS_OBLIQUE2".
	(draw_numbering): add argument "ndir".
	(draw_numbering): add case for "AXIS_NUM_POS_OBLIQUE1" and
	"AXIS_NUM_POS_OBLIQUE2".
	(draw_numbering): use "get_num_pos()" instead of
	"get_num_pos_normal()" and "get_num_pos_parallel()".
	(numbering): get field "num_direction".
	(numbering): "align" is not used when "ndir" is
	"AXIS_NUM_POS_OBLIQUE1" or "AXIS_NUM_POS_OBLIQUE2".
	(anumdirput): add case for "AXIS_NUM_POS_OBLIQUE1" and
	"AXIS_NUM_POS_OBLIQUE2".

	* src/axis.h (AXIS_NUM_DIR): moved from "oaxis.c".

	* src/gra.c (GRAexpandmath): show "0" when calculated value is
	equal to 0.

	* src/gtk/x11dialg.h (AxisNumbering): add member "align_label".

	* src/gtk/x11axis.c (num_direction_changed): add.
	(numbering_tab_create): "change" signal is connected to the
	function "num_direction_changed()".
	(numbering_tab_create): initialize "d->align_label".

2010-05-20  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11menu.c (SetPoint): don't show the position in the
	status bar when the widget is not visible.

	* src/gtk/x11cood.c (CoordWinSetCoord): show date when tyoe of the
	axis is "AXIS_TYPE_MJD".
	(CoordWinSetCoord): do nothing when the widget is not visible.

2010-05-19  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/ofile.c (opendata, getposition, f2dgetcoord): use
	"AXIS_TYPE_LINEAR", "AXIS_TYPE_LOG" and "AXIS_TYPE_INVERSE".
	(get_pos_sub): add.
	(getposition2): use "get_pos_sub()".

2010-05-18  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11menu.c (create_image_outputmenu): change accel path
	of "Export image" menu items.

2010-05-17  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/ofit.c (ERR_SMALL_ARGS, ERR_INVALID_PARAM): remove.
	(fittypechar): remove some error messages.
	(bisection, newton, fitsolve): remove.
	(fit): remove fields "newton" and "bisection".

	* src/ofile.c (ERR_SMALL_ARGS, ERR_INVALID_TYPE)
	(ERR_INVALID_PARAM, ERRCONVERGE): add.
	(f2derrorlist): add error messages.
	(get_fit_obj_id): add.
	(fitout): use "get_fit_obj_id()".
	(bisection, newton): moved from "ofit.c".
	(solve_equation): add.
	(calc_equation): add.
	(file2d): add fields "newton", "bisection" and "calc".

2010-05-15  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* test/math_test_new.dat: add test for functions "mjd2year()",
	"mjd2month()", "mjd2day()" and "unix2mjd()".

2010-05-14  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/otext.c (textprintf): use "add_printf_formated_str()".

	* src/ofit.c (ERR_SMALL_ARGS, ERR_INVALID_PARAM): add.
	(fittypechar): add error messages.
	(fitcalc): variable "eq" is not static.
	(bisection, newton, fitsolve): add.
	(fit): add fields "newton" and "bisection".

	* src/nstring.c (get_printf_format_str, add_printf_formated_str):
	add.

	* src/gra.c (GRAexpandmath): use "g_strdup_printf()" instead of
	"sprintf()".
	(GRAexpandmath): change format string depend on the value "vd".
	(GRAexpandpf): use "add_printf_formated_str()".

2010-05-13  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/math/math_basic_function.c (mjd2gd, math_func_mjd2year)
	(math_func_mjd2month, math_func_mjd2day): add.

	* src/math/math_function.h.in: add functions "mjd2year",
	"mjd2month" and "mjd2day".

	* src/gtk/x11graph.c (CmGraphSaveB): call "CmGraphOverWrite()"
	instead of "CmGraphSave()".

	* src/gtk/x11menu.c (show_outputmenu_cb, create_outputmenu):
	remove.
	(command_data): add member "stock".
	(Command1_data): use stock items.
	(show_graph_menu_cb): set sensitivity of the widget
	"ExtDrvOutMenu".
	(create_graphmenu): move "Export image", "external _Driver" and
	"Print preview" menu items from "Output" menu.
	(create_filemenu): move "Save data" menu item from "Output" menu.
	(create_windowmenu): move "Draw" and "Clear" menu items from
	"Output" menu.
	(createmenu): don't call "create_outputmenu()".
	(createpixmap): check "data[i].xpm".
	(createcommand1): call "gtk_tool_button_new_from_stock()" when
	"cdata->xpm" is NULL.
	(createcommand1): call "gtk_tool_item_set_homogeneous()".
	(createcommand2): call "gtk_tool_button_set_stock_id()" when
	"cdata->img" is NULL.

2010-05-10  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/oaxis.c (get_num_ofst_horizontal, get_num_ofst_parallel)
	(get_num_ofst_normal1, get_num_ofst_normal2): the type of the
	parameter "aconf" is "const struct axis_config *".
	(mjd_to_date_str): add parameter "date_format".
	(draw_numbering_normalize): the type of parameters "aconf" and
	"font" are "const struct axis_config *" and "const struct
	font_config *" respectively.
	(axis): add field "num_date_format".

	* src/math/math_basic_function.c (math_func_unix2mjd): first
	argument of the function "mjd()" is "tm->tm_year + 1900".

	* src/gtk/ogra2cairo.c (draw_str): check if the parameter "str" is
	NULL or not.

	* src/gtk/main.c (main): set "LC_TIME" as "C".

	* src/gtk/x11dialg.h (AxisNumbering):add member "date_format".

	* src/gtk/x11file.c (FitCB): localize message.

	* src/gtk/x11axis.c (AxisCB, AxisHistoryCB): localize message.
	(numbering_tab_set_value, numbering_tab_setup_item)
	(numbering_tab_create): add settings for date format.

2010-05-08  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/oaxis.c (axistypechar): add scale type "MJD".
	(anumdirchar): use "horizontal" and "parallel1" instead of
	"normal" and "parallel" respectively.
	(AxisConfig): remove duplicated member "type".
	(mjd_to_date_str): add.
	(numformat): construct whole numbering string.
	(draw_numbering_normalize, draw_numbering, anumdirput): use
	"AXIS_NUM_POS_HORIZONTAL" and "AXIS_NUM_POS_PARALLEL1" instead of
	"AXIS_NUM_POS_NORMAL" and "AXIS_NUM_POS_PARALLEL" respectively.
	(draw_numbering): remove unused argument "taillen".
	(draw_numbering): remove unused variable "num".
	(draw_numbering): move some codes to the function "numformat()".
	(get_step): add.
	(numbering): remove unused variables "taillen", "num", "n" and
	"count".
	(numbering): use "get_step()".
	(numbering): move some codes to the function "numformat()".
	(anumdirput): add.
	(axis): use "anumdirput" to set value to the field "num_direction".

	* src/axis.h (AXIS_SCALE_TYPE): meved from "oaxis.c".

2010-05-07  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/math/math_basic_function.c (mjd): add.
	(math_func_mjd): use "mjd()".
	(math_func_unix2mjd): add.

	* src/math/math_function.h.in: add function "unix2mjd".
	add 4th, 5th and 6th arguments to the function "mjd".

	* src/shellcm.c (dispfield): check first character of a string
	"enumlist[j]".

	* src/axis.h (AXIS_SCALE_TYPE): moved from "oaxis.c".

	* src/object.c (getargument): check first character of a string
	"enumlist[i]".

	* src/gtk/main.c (get_obj_enum_list): check first character of a
	string "enumlist[i]".

	* src/gtk/x11dialg.c (SetListFromObjField): check first character
	of a string "enumlist[i]".

	* src/gtk/x11file.c (FitDialogSetup, create_type_combo_box)
	(create_type_combo_box): check first character of strings
	"curvelist[j]" and "enumlist[i]".

2010-04-28  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/Makefile.am (ngraph_CFLAGS): add option
	"-DG_DISABLE_DEPRECATED=1" and "-DG_DISABLE_SINGLE_INCLUDES=1".

	* src/nconfig.c (replaceconfig, removeconfig): use "n_tmpfile()"
	and "n_tmpfile_close()".

	* src/ioutil.c (n_tmpfile, n_tmpfile_close): add.

	* src/gtk/x11commn.c (AddNgpFileList): use "g_filename_to_uri()".

	* src/gtk/x11graph.c (CmGraphHistory): use
	"g_filename_from_uri()".

2010-04-27  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11graph.c (PageDialogPage): change sensitivity of
	labels.
	(PageDialogSetup): initialize "d->paperheight_label" and
	"d->paperwidth_label".

	* src/gtk/x11opt.c (MiscDialogSetupItem): initialize
	"d->help_browser" and "d->browser".
	(set_file_in_entry): change title of the dialog.
	(MiscDialogSetup): add entries to set programs for help browser
	and web browser.
	(MiscDialogSetup): change order of frames.
	(use_external_toggled): toggle sensitivity of labels.
	(load_file_toggled): add.
	(ViewerDialogSetup): "load_file_toggled()" is connected to the
	"toggled" signal.
	(set_program_name): add.
	(MiscDialogClose): use "set_program_name()".

	* src/gtk/x11dialg.h (PageDialog): add member "paperwidth_label"
	and "paperheight_label".
	(ExViewerDialog):add member "d_label", "w_label" and "h_label".
	(ViewerDialog): add member *data_num_label".

	* src/gtk/gtk_entry_completion.c (entry_completion_set_entry):
	add.

	* src/gtk/x11lgnd.c (LegendTextDialogSetup): don't call
	"gtk_entry_set_completion()".
	(LegendTextDialogSetup): use "entry_completion_set_entry()"
	instead of "gtk_entry_set_completion()".

	* src/gtk/x11file.c (clear_math_completion): remove.
	(MathTextDialogSetup, math_tab_setup_item, func_entry_focused):
	use "entry_completion_set_entry()" instead of
	"gtk_entry_set_completion()".
	(FileDialogClose, FileDefDialogClose): don't call
	"clear_math_completion()".

2010-04-26  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/jnstring.c (niskanji): conditions are simplified.
	(niskanji2): use variable "l" to compare length of string.

	* mingw/install.txt: add document.

	* src/gtk/x11file.c (MathTextDialogClose): call
	"gtk_entry_set_completion()" before exit the function except the
	case of "d->ret == IDLOOP".
	(math_tab_setup_item): call "gtk_entry_set_completion()".
	(clear_math_completion): add.
	(FileDialogClose, FileDefDialogClose): call
	"clear_math_completion()" before exit the function except the case
	of "d->ret == IDLOOP".

2010-04-25  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11print.c (SvgVersion): change order of SVG version.
	(OutputImageDialogSetupItem): initialize image export settings.
	(OutputImageDialogClose): save image export settings.
	(OutputImageDialogClose): "d->Version" is "TYPE_SVG1_1" when
	selected version is "SVG version 1.1".

	* src/gtk/ox11menu.h (menulocal): add image export settings.
	(SAVE_CONFIG_TYPE): add "SAVE_CONFIG_TYPE_EXPORT_IMAGE".

	* src/gtk/ox11menu.c (MenuConfigExportImage): add.
	(MenuConfigArrray): add "MenuConfigExportImage".
	(menu_save_config): save image export settings.
	(menuinit): initialize image export settings.

	* src/gtk/x11menu.c (application): call "menu_save_config()" for
	"SAVE_CONFIG_TYPE_EXPORT_IMAGE".

2010-04-23  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* mingw/windows_make.sed: add "-lwinspool" option to the variable
	"LIBS".

	* src/gtk/x11print.c (OutputImageDialogSetupItem): "d->dpi" and
	"d->dlabel" are sensitive.

	* src/gtk/ogra2cairofile.c (create_reference_dc): add.
	(create_cairo): use "create_reference_dc()" to get reference DC.
	(create_cairo): call "StartPage()".
	(gra2cairofile_output): call "cairo_surface_flush()",
	"cairo_surface_copy_page()" and "EndPage()".

2010-04-21  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11menu.c (create_image_outputmenu): add "EMF file" menu
	item.

	* src/gtk/x11print.c (OutputImageDialogSetupItem)
	(OutputImageDialogSetup, OutputImageDialogClose)
	(CmOutputImage, CmOutputMenu): add case for "MenuIdOutputEMFFile".

	* src/gtk/x11menu.h (MenuID): add "MenuIdOutputEMFFile".

	* src/gtk/ogra2cairofile.h (surface_type_id): add "TYPE_EMF".

	* src/gtk/ogra2cairofile.c (CAIRO_EMF_SCALE): add.
	(surface_type): add type "emf".
	(create_cairo, gra2cairofile_output): add case for "TYPE_EMF".

2010-04-20  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11lgnd.c (legend_list_build): use
	"tree_store_prepend()" instead of "tree_store_append()".

	* src/gtk/x11file.c (delete_file_obj): add.
	(CmFileHistory, CmFileNew, CmFileClose, update_file_obj_multi)
	(FileWinFileDelete, FileWinFileUpdate): use "delete_file_obj()".
	(CmFileWindow): "d->delete" is set as "delete_file_obj".

	* src/gtk/x11view.c (EvalDialogSetupItem): use
	"tree_store_prepend()" instead of "tree_store_append()".

	* src/gtk/x11menu.c (init_ngraph_app_struct): use "memset()".

	* src/gtk/gtk_subwin.c (update, delete): use "d->delete" instead
	of "delobj()" if "d->delete" is not NULL.

	* src/gtk/x11axis.c (CmAxisWindow): "d->delete" is set as
	"AxisDel".

	* src/gtk/x11menu.h (SUBWIN_PROTOTYPE): add member "delete".

	* src/math/math_scanner.h (struct math_token): add member "next".

	* src/math/math_scanner.c (create_token): use "g_malloc0()"
	instead of "g_malloc()".

	* src/math/math_parser.c (parse_expression_list): fix memory leak
	when the type of the token is "MATH_TOKEN_TYPE_EOEQ".
	(my_get_token, unget_token, math_parser_parse): use list instead
	of array.

	* src/gtk/gtk_liststore.c (tree_store_prepend): add.

2010-04-15  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/omath.c (create_func_def_str): use "g_strdup_printf()".

	* src/ofile.c (EQUATION_NUM): add.
	(struct f2ddata, set_user_fnc, set_equation): use "EQUATION_NUM".
	(create_func_def_str): use "g_strdup_printf()".
	(set_const_all): last argument of "set_const()" for "fp->codex[1]"
	and "fp->codey[1]" is depend on "fp->type".
	(f2ddraw): use "set_const_all()" instead of "set_const()".

	* src/gtk/gtk_common.h (GTK_WIDGET_VISIBLE): use
	"gtk_widget_get_visible()" if "GTK_WIDGET_VISIBLE" is not defined.

2010-04-13  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11file.c (FileDialogCopyAll): remove.
	(FileDialogClose): remove case "IDCOPYALL"
	(FileDialogSetup): remove "Copy all" button.
	(FileDialogSetup): set width of the file preview as 240.

2010-04-06  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11menu.c (SUB_WINDOW_STATE, change_window_state_cb):
	add.
	(application): "change_window_state_cb()" is connected to the
	"window-state-event" signal.

	* src/gtk/gtk_subwin.c (hide_minimize_menu_item): add.
	(sub_window_create): "hide_minimize_menu_item()" is connected to
	the "realize" signal.

2010-04-05  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11menu.c (create_sub_windows, destroy_sub_windows):
	add.
	(application): use "create_sub_windows()" and
	"destroy_sub_windows()" .

	* src/gtk/gtk_subwin.c (ev_sub_win_key_down): call
	"gtk_widget_hide()" instead of "gtk_widget_hide_all()".

2010-04-04  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* mingw/windows.sh: remove "--enable-new_math" option for
	configure script.

2010-04-01  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* initfile/Ngraph.ini.win: change Japanese fonts.

	* src/otext.c (text_set_text): treat shift-jis strings.

	* src/shell.c (getcmdline): treat shit-jis strings.

	* driver/gra2wmf.c (main): use g_mkstemp() when the version of
	GLIB is lesser than 2.22.

	* src/gtk/x11view.c (graph_dropped): add "-f" option for
	"LoadNgpFile()".
	(ViewerEvMouseMove, ViewerEvPaint, create_pix): check
	"Menulocal.gc".

	* src/gtk/x11opt.c (set_file_in_entry): add.
	(MiscDialogSetup): use "create_file_entry_with_cb()" instead of
	"create_text_entry()".
	(CmOptionSaveNgp): use "naccess()" instead of "access()".

	* src/gtk/x11merge.c (merge_list_set_val): the filename is always
	UTF-8.

	* src/gtk/x11menu.h (NgraphApp): remove member "Message1", and
	members "Message_pos" and "Message_extra".

	* src/gtk/x11menu.c (show_file_menu_cb): the filename is always
	UTF-8.
	(createpixmap, create_toolbar_pixmap, createicon): remove unused
	argument "win".
	(create_message_box): add.
	(setupwindow): call "gtk_widget_show_all()" and "reset_event()"
	just after call "gtk_table_attach" for "NgraphApp.Viewer.Win".
	(SetPoint): use GtkLabel to show the cursor position in the status
	bar.

	* src/gtk/x11gui.c (fsok): use "naccess()" instead of "access()".
	(fsok): use "nstat()" instead of "stat()".
	(fsok): convert filename string to UTF-8.
	(fsok): use "g_path_get_dirname()".
	(file_dialog_set_current_neme): use "getbasename()".
	(FileSelectionDialog): second argument of
	"file_dialog_set_current_neme()" has to be converted from UTF-8.

	* src/gtk/x11graph.c (DirectoryDialogClose, CmGraphHistory): use
	"nchdir()" instead of "chdir()".
	(CmGraphHistory): use "g_path_get_dirname()".
	(about_link_activated_cb, CmHelpHelp): use "system_bg()".

	* src/gtk/x11file.c (edit_file): add.
	(FileDialogEdit, CmFileEdit, FileWinFileEdit): use "edit_file()".
	(file_list_set_val): the filename is always UTF-8.

	* src/gtk/x11dialg.c (SetObjFieldFromText, SetTextFromObjField):
	strings are always UTF-8.

	* src/gtk/x11commn.c (SaveDrawrable): don't write platform
	information.
	(check_overwrite, GraphSave): use "naccess()" instead of
	"access()".
	(GraphSave): use "nchdir()" instead of "chdir()".
	(LoadNgpFile): check if the file is readable or not.
	(LoadNgpFile): the filename is always UTF-8.
	(CheckIniFile): get home directory from "system" object.
	(ErrorMessage): use "g_strerror()" instead of "strerror()".

	* src/gtk/ox11menu.c (menumenu): convert filename string from
	UTF-8.
	(menumenu): call "hide_console()" and "resotre_console()" before
	and after call "application()" respectively.
	(SetCaption): the filename is always UTF-8.

	* src/gtk/ogra2cairofile.c (create_cairo, gra2cairofile_output):
	convert filename string from UTF-8.

	* src/gtk/main.c (check_console, hide_console, resotre_console):
	added.
	(nallocconsole, exec_console): use "g_unlink()" instead of
	"unlink()".
	(set_dir_defs, set_path_env): added.
	(main): don't use third argument.
	(main): call "g_thread_init()", "gdk_threads_init()" and
	"gdk_threads_enter()".
	(main): call "set_dir_defs()" when "WINDOWS" is defined.
	(main): use "g_getenv()" instead of "getenv()".
	(main): use "g_get_user_config_dir()".
	(main): check return value of "exeobj()" for "shell::shell".
	(get_file_list): use "nstat()" instead of "stat()".

	* src/gtk/gtk_widget.c (filename_from_utf8, filename_to_utf8):
	remove.
	(entry_set_filename, entry_get_filename): don't convert file name.

	* src/gtk/gtk_subwin.c (start_editing, modify_string): strings are
	always UTF-8.
	(sub_window_create): type hint for subwindows are
	"GDK_WINDOW_TYPE_HINT_UTILITY".
	(sub_window_create): call "gtk_window_set_transient_for()".

	* src/shellux.c (testexpand): use "nstat()" instead of "stat()".

	* src/shellcm.c (cmcd): use "nchdir()" instead of "chdir()".
	(cmbasename): use "getbasename()" instead of "basename()".
	(cmdirname): use "getdirname()" instead of "dirname()".

	* src/shell.c (set_environ): use "g_getenv()" to get environment
	variable.
	(unlinkfile): use "g_unlink()" instead of "unlink()".
	(set_shellevloop): use "g_thread_create()" instead of
	"pthread_create()".
	(reset_shellevloop): use "g_thread_join()" instead of
	"pthread_join()".
	(readline_thread, nreadline): added.
	(shget): use "nreadline()" when readline library is available.
	(puts_localized): added.
	(shputstdout, shprintfstdout): use "puts_localized()".
	(getcmdline): convert strings to UTF-8 if the strings are not
	valid UTF-8.
	(expand): use "g_unlink()" instead of "unlink()".
	(expand): use function "strlen()" only once for a loop.
	(set_env_val, cmdexec, newshell): use "g_getenv()" instead of
	"getenv()".
	(proc_in_thread, quote_args): added.
	(cmdexec): use "g_strerror()" instead of "strerror()".
	(cmdexec): use "g_thread_create()" and "proc_in_thread()" to
	execute command.
	(show_system_error, system_in_thread, system_bg): added.

	* src/osystem.c (nsystem): add field "compiler".
	(sysinit): set compiler name.
	(sysdone, sysunlink): use "g_unlink()" instead of "unlink()".
	(syscwd): use "nchdir()" instead of "chdir()".

	* src/oprm.c (prmload): use "naccess()" instead of "access()".

	* src/omerge.c (mergefile): call "get_utf8_filename()" for
	filename argument.
	(mergetime, mergedate): use "nstat()" instead of "stat()".
	(mergeload): use "naccess()" instead of "access()".

	* src/oio.c (io_error): use "g_strerror()" instead of
	"strerror()".

	* src/ogra2prn.c (gra2p_output): use "g_unlink()" instead of
	"unlink()".

	* src/ofile.c (f2dfile): call "get_utf8_filename()" for filename
	argument.
	(f2dtime, f2ddate, get_mtime): use "nstat()" instead of "stat()".
	(f2dload): use "naccess()" instead of "access()".
	(f2doutputfile): use "g_strerror()" instead of "strerror()".

	* src/object.c (error2, error22): call "g_locale_from_utf8()" for
	message string.

	* src/nconfig.c (unlockconfig, make_backup, copyconfig): use
	"g_unlink()" instead of "unlink()".
	(openconfig, writecheckconfig, copyconfig): use "nstat()" instead
	of "stat()".
	(writecheckconfig): use "naccess()" instead of "access()".

	* src/ioutil.c (changefilename): don't check Shit-JIS kanji
	code. Encodeing of the filename should be UTF-8.
	(path_to_win): added.
	(getfullpath): use "get_utf8_filename()".
	(getdisk): added.
	(getrelativepath): use "get_utf8_filename()".
	(get_utf8_filename, get_localized_filename): added.
	(getbasename): use "g_path_get_basename()".
	(getdirname): use "g_path_get_dirname()".
	(nsearchpath): call "g_find_program_in_path()".
	(nselectdir): use "nstat()" instead of "stat()".
	(nfopen): use "g_fopen()".
	(nstat, naccess, nchdir): added.
	(n_mkstemp): use "g_get_tmp_dir()".

	* src/common.h (COMPILER_NAME): added.
	(WINDOWS): define if "__MINGW32__" is defined

	* initfile/Ngraph.ini.in (help_browser): change format (file name
	is not included).

	* driver/wmfapi.c (chk_write): added.
	(Polygon, Ellipse, Arc, Pie, Chord, SetPixel, SetPolyFillMode)
	(SetBkMode, SetTextAlign, SetTextCharacterExtra, TextOut)
	(SetTextColor, Rectangle, MoveTo, LineTo, SelectObject)
	(DeleteObject, SetWindowOrg, SetWindowExt, CloseMetaFile)
	(SetMapMode): use "chk_write()" instead of "write()".
	(CloseMetaFile): don't close the file but call "fseek()".
	(CreateMetaFile): add argument "dc".
	(CreateMetaFile): don't open a file.

	* driver/gra2wmf.c (getboundingbox, draw): use function "strlen()"
	only once for each loops.
	(main): use environment variable "NGRAPHCONF" instead of
	"NGRAPHLIB".
	(main): use "g_mkstemp_full()" to create temporally file.
	(main): use "chk_write()" instead of "write()".

2010-03-31  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* driver/gra2ps.c (getboundingbox, draw): use function "strlen()"
	only once for each loops.
	(main): use environment variable "NGRAPHCONF" instead of
	"NGRAPHLIB".

	* mingw/windows_resource.rc: added.

	* mingw/windows_make.sed: added.

	* mingw/windows_demo.sed: added.

	* mingw/windows.sh: added.

	* mingw/pango.aliases: added.

	* mingw/gtkrc: added.

	* mingw/associate.bat: added.

	* mingw/Makefile.am: added.

2010-03-19  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/main.c (main): use "g_listenv()" instead of 3rd argument
	of "main()" function.

2010-03-04  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11menu.c (reset_event): change name from "ResetEvent"

	* Src/Gtk/x11gui.c (message_beep): change name from "MessageBeep"
	(message_box): change name from "MessageBox".

	* src/gtk/x11commn.c (allocate_console): change name from
	"AllocConsole".
	(free_console): change name from "FreeConsol".

	* src/gtk/main.c (reset_fifo, nallocconsole, reset_fifo)
	(nfreeconsole): use "nopen()" and "nclose()".
	(get_file_list): use "g_dir_open()", "g_dir_read_name()" and
	"g_dir_close()".

	* src/gtk/ox11menu.h (DEFAULT_GEOMETRY): change name from
	"CW_USEDEFAULT".

	* src/gtk/gtk_entry_completion.c (entry_completion_save)
	(entry_completion_load): use "nfopen()".

	* src/strconv.c (str2utf8): use "g_iconv".

	* src/object.c: change variable name form "GlovalLock" to
	"Glovallock".

	* src/nconfig.c (lockconfig, openconfig, make_backup)
	(replaceconfig, removeconfig, copyconfig): use "nfopen()".

	* src/ioutil.c (nscandir): use "g_dir_open()", "g_dir_read_name()"
	and "g_dir_close()".
	(nscandir): remove 3rd argument.
	(nopen): use "g_open()".
	(nfopen): use "g_fopen()".
	(n_mkstemp): use "g_mkstemp()".

	* configure.in: check library "pthreadGC2".

2010-02-24  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/ofile.c (draw_interpolation): added.
	(draw_fit): use "draw_interpolation()".

2010-02-23  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/math/math_expression.c (math_parameter_expression_new): set
	errorcode to "err" when the variable "prm" is NULL.

	* src/ofit.c (ERR_INCONSISTENT_DATA_NUM): added.
	(fiterrorlist): add error message.
	(fit_put_weight_func): fix arguments of the function
	"ofile_create_math_equation()".

	* src/ofile.c (calc_fit, draw_fit): added.
	(fitout): use "calc_fit()" and "draw_fit()".
	(ofile_create_math_equation): add argument "use_const".
	(set_equation): fix second argument of "set_user_fnc()" from "g"
	to "h".
	(set_const): add arguments "const_id" and "need2pass".
	(f2ddraw): constant "FIRST" for equatiosn "fp->codex[0]" and
	"fp->codey[0]" is TRUE.

2010-02-22  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/ofile.c (fitout): use "calc_weight()" to calculate weight.
	(calc_weight): added.

	* src/object.c (moveobj): move object only when id of instances of
	"sid" and "did" are exist.
	(_newobj, _delobj, _copyobj): remove.

	* src/math/math_function.h.in: add functions "prog1" and "prog2".

	* src/math/math_basic_function.c (math_func_prog1)
	(math_func_prog2): added.

2010-02-19  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/math/math_expression.c (calc): divided by zero is not
	error. returned value is 'NaN'.

2010-02-18  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/math/math_function.h.in: add function "progn".

	* src/math/math_basic_function.c (math_func_progn): add

	* src/oaxis.c (numformat, draw_numbering, numbering): use
	"snprintf()".
	(draw_numbering): delete argument "num" and add argument "draw".
	(draw_numbering): print position, direction and numbering value
	when "draw" is false.
	(numbering): add argument "draw".
	(axis_get_numbering): added.
	(axis): add field "get_numbering".
	(draw_numbering_normalize): added.
	(draw_numbering): use "draw_numbering_normalize()".

	* driver/ngp2.in: add "-d dpi" option.

2010-02-16  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11file.c (load_tab_create): type of the spin button
	"d->load.finalline" is "SPIN_BUTTON_TYPE_INT".

2010-02-15  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/ofile.c (ofile_create_math_equation): change name from
	"create_math_equation()" and this function is now global.
	(fitout): call "math_equation_parse()", "set_const()" and
	"math_equation_optimize()" for weight function.

	* src/ofit.c (fit_put_weight_func): added.
	(show_eqn_error): added.
	(fit): check "weight_func".
	(fitput): use "show_eqn_error()".

2010-02-10  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11axis.c (ZoomDialogSetupItem): use
	"spin_entry_set_val()" .
	(ZoomDialog): don't initialize "data->zoom".

	* src/gtk/x11dialg.c (initdialog): initialize "DlgZoom.zoom"

2010-02-05  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11commn.c (get_save_opt): return "IDOK" (not
	"IDCANCEL") when both "fnum" and "mnum" is negative.

2010-02-03  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/gtk_liststore.c (list_store_remove_selected_cb): set
	cursor on the first selected path.

2010-02-02  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11view.c (show_focus_line_arc, ShowPoints): call
	"gdk_draw_arc()" only when "Menulocal.do_not_use_arc_for_draft" is
	false.

	* src/gtk/ox11menu.h (menulocal): add member
	"do_not_use_arc_for_draft".

	* src/gtk/ox11menu.c (MenuConfigViewer): add setting related to
	"do_not_use_arc_for_draft".

	* src/gtk/x11lgnd.c (renderer_func, column_edited)
	(column_0_edited, column_1_edited, insert_column)
	(set_delete_button_sensitivity): added.
	(points_setup): use "GtkTreeView".
	(LegendCurveDialogSetup, LegendPolyDialogSetup)
	(LegendArrowDialogSetup): change layout.

	* src/gtk/x11dialg.c (SetObjPointsFromText)
	(SetTextFromObjPoints): use "GtkTreeView".
	(set_obj_points_from_text, set_entry_from_obj_point): added.
	(SetObjFieldFromStyle): use "set_obj_points_from_text()" instead
	of "SetObjPointsFromText()".
	(SetStyleFromObjField): use "set_entry_from_obj_point()" instead
	of "SetTextFromObjPoints()".

2010-01-26  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11graph.c (DirectoryDialogSetup): use "GtkTable"
	instead of "GtkHBox".
	(DirectoryDialogSetup): add current directory label.

	* src/gtk/x11dialg.h (DirectoryDialog): add member "dir_label".

2010-01-22  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11view.c (EvalDialogSetup): set "d->ok_button" as
	"GTK_STOCK_CLOSE".

	* src/gtk/x11opt_proto.h (CREATE_NAME): set "d->ok_button" as
	"GTK_STOCK_CLOSE".

	* src/gtk/x11gui.c (DialogExecute): initialize "data->ok_button".
	(DialogExecute): use "data->ok_button" for "ok" button.

	* src/gtk/x11file.c (MathDialogSetup): set "d->ok_button" as
	"GTK_STOCK_CLOSE".

	* src/gtk/x11dialg.h (DIALOG_PROTOTYPE): add member "ok_button".

2010-01-21  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11print.c (init_print): added.
	(CmOutputPrinter): "begin_print" signal is connected to the
	function "init_print()".
	(CmOutputPrinter): don't call
	"gtk_print_operation_set_current_page()".

2010-01-04  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gra.h (CURVE_OBJ_USE_EXPAND_BUFFER): added.

	* src/ocurve.c (curveinit): initialize "_points" field when
	"CURVE_OBJ_USE_EXPAND_BUFFER" is TRUE.
	(curve_expand, curve_expand_points, curve_clear)
	(curve_set_points, curve_flip, curve_move, curve_rotate)
	(curve_zoom, curve_change): added.
	(curve): add field "_points".
	(curvedraw, curvebbox, curvematch): use "_points" field when
	"CURVE_OBJ_USE_EXPAND_BUFFER" is TRUE.

	* src/object.c (arrayclear, arrayclear2): added.

2009-12-25  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/ofile.c (file_color): allow negative or greater than 255 for
	"val".

	* src/gtk/x11view.c (EvalDialogSetup): call
	"gtk_scrolled_window_set_policy()".

	* src/gtk/x11file.c (MathDialogSetup, create_user_fit_frame)
	(move_tab_create, mask_tab_create, FileDialogSetup): call
	"gtk_scrolled_window_set_policy()".

	* src/gtk/ogra2x11.c (gtkinit): call
	"gtk_scrolled_window_set_policy()".

	* src/gtk/x11dialg.c (SelectDialogSetup, CopyDialogSetup): call
	"gtk_scrolled_window_set_policy()".

	* src/gtk/ogra2x11.c (gtkinit): call
	"gtk_scrolled_window_set_policy()".

	* src/gtk/gtk_subwin.c (sub_window_create): call
	"gtk_scrolled_window_set_policy()".
	(sub_window_create): call "gtk_window_set_skip_taskbar_hint()"

	* src/gtk/x11file.c (create_user_fit_frame): initial values and
	derivative equations are shown in scrolled window.

2009-12-24  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11lgnd.c (legend_list_set_val): use
	"legend_list_set_property()".
	(legend_list_set_color, legend_list_set_property): added.

	* src/gtk/x11menu.c (create_toolbar): use
	"gtk_orientable_set_orientation()" instead of
	"gtk_toolbar_set_orientation()" is the version of the GTK+ is
	greater or equal to 2.16.

	* src/gtk/gtk_subwin.c (set_cell_renderer_cb)
	(set_editable_cell_renderer_cb, set_combo_cell_renderer_cb)
	(set_obj_cell_renderer_cb): use "gtk_cell_layout_get_cells()"
	instead of "gtk_tree_view_column_get_cell_renderers()".

	* src/gtk/x11file.c (FitDialogSetSensitivity): don't change
	sensitivity of widgets related to division settings.
	(FitDialogSetup): don't use "toggled" signal of
	"d->interpolation".

	* src/gtk/x11dialg.h (struct FitDialog): remove member "div_box"

2009-12-22  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11print.c: initialize "DriverDialogBrowseCB" as NULL
	when "USE_ENTRY_ICON" is FALSE.
	(DriverDialogSelectCB): now "ext" of "struct extprinter" is not
	include ".".

	* src/gtk/x11opt.c: initialize "SetScriptDialogBrowse" and
	"SetDriverDialogBrowse" as NULL when "USE_ENTRY_ICON" is FALSE.

	* src/gtk/gtk_widget.c: initialize "entry_icon_file_select" as
	NULL when "USE_ENTRY_ICON" is FALSE.

2009-12-18  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11file.c (set_user_fit_sensitivity)
	(create_user_fit_frame): added.
	(FitDialogSetSensitivity): use "set_user_fit_sensitivity()".
	(FitDialogSetup): use "GtkTable" instead of "GtkHBox" or
	"GtkVBox".
	(FitDialogResult): call "math_equation_add_parameter()".
	(FitDialogSave, FitDialogLoad, FitDialogCopy): connected to
	"clicked" signal.

2009-12-17  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/gtk_widget.c (create_file_entry_with_cb): added.

	* src/gtk/x11dialg.h (struct FileMath, struct FileLoad)
	(struct FileMask, struct FileMove): added.
	(struct FileDialog): add member "math", "load", "mask" and "move"

	* src/gtk/x11file.c (move_tab_setup_item, move_tab_copy)
	(move_tab_create, move_tab_set_value, mask_tab_setup_item)
	(mask_tab_copy, mask_tab_create, mask_tab_set_value)
	(load_tab_setup_item, load_tab_copy, load_tab_create)
	(load_tab_set_value, math_tab_setup_item, math_tab_copy)
	(math_tab_create, math_tab_set_value, file_setup_item)
	(set_fit_button_label, plot_tab_setup_item, file_settings_copy)
	(plot_tab_create, file_dialog_show_tab, set_headlines)
	(plot_tab_set_value): added.
	(FileDialogSetup): use "set_headlines()".

	* src/gtk/x11graph.c (PageDialogSetup): use "GtkTable" instead of
	"GtkHBox" or "GtkVBox".

	* src/gtk/x11lgnd.c (LegendLineCB, LegendRectCB, LegendArcCB): use
	"g_strdup_printf()" instead of "g_malloc()" and "snprintf()".
	(legend_dialog_set_sensitive): added.
	(legend_dialog_setup_item): call "legend_dialog_set_sensitive()".
	(legend_copy_clicked): added.
	(width_setup, points_setup, style_setup, miter_setup)
	(join_setup, color_setup, color2_setup, LegendCurveDialogSetup)
	(LegendPolyDialogSetup, LegendArrowDialogSetup)
	(LegendRectDialogSetup, LegendArcDialogSetup)
	(legend_dialog_setup_sub, LegendTextDialogSetup)
	(LegendTextDefDialogSetup): use "GtkTable" instead of "GtkHBox" or
	"GtkVBox".

	* src/gtk/x11lgndx.c (LegendGaussDialogSetup): use "GtkTable"
	instead of "GtkHBox" or "GtkVBox".

	* src/gtk/x11merge.c (MergeDialogCopy): connected to "clicked"
	signal.
	(MergeDialogSetup): use "GtkTable" instead of "GtkHBox" or
	"GtkVBox".
	(MergeDialogClose): remove case for "IDCOPY".

	* src/gtk/x11opt.c (ViewerDialogSetup, ExViewerDialogSetup)
	(MiscDialogSetup, SetDriverDialogSetup, SetScriptDialogSetup): use
	"GtkTable" instead of "GtkHBox" or "GtkVBox".
	(SetDriverDialogSetup, SetScriptDialogSetup): use
	"create_file_entry_with_cb()" instead of "create_text_entry()".
	(SetScriptDialogBrowse, SetDriverDialogBrowse): connected to
	"icon-release" signal.

	* src/gtk/x11print.c (DriverDialogSetup): use "GtkTable" instead
	of "GtkHBox" or "GtkVBox".
	(DriverDialogSetup): use "create_file_entry_with_cb()" instead of
	"create_text_entry()".
	(DriverDialogBrowseCB): connected to "icon-release" signal.

2009-12-11  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11opt.c (MiscDialogSetup): use "GtkTable" instead of
	"GtkHBox" and "GtkVBox".

2009-12-10  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11file.c (select_color): use "ndialog_run()" instead of
	"gtk_dialog_run()".

	* src/gtk/gtk_widget.c (show_color_sel): use "ndialog_run()"
	instead of "gtk_dialog_run()".

	* src/gtk/x11opt.c (PrefFontDialogUpdate, PrefFontDialogAdd): use
	"ndialog_run()" instead of "gtk_dialog_run()".

	* src/gtk/x11gui.c (DialogExecute): use "DnDLock" instead of
	"GlobalLock".
	(ndialog_run): added.
	(DialogExecute, MessageBox, DialogInput, DialogRadio)
	(DialogCombo, DialogComboEntry, DialogSpinEntry, DialogCheck)
	(FileSelectionDialog): use "ndialog_run()" instead of
	"gtk_dialog_run()".

	* src/gtk/x11menu.c: add gloval variable "DnDLock".

	* src/gtk/x11view.c (drag_drop_cb): check "DnDLock".

	* src/gtk/x11lgndx.c (enum LEGEND_DIRECTION)
	(LEGEND_DIRECTION_NUM): add
	(LegendGaussDialogPaint, LegendGaussDialogClose): use "switch"
	instead of "if".
	(LegendGaussDialogSetup): use "GtkTable" instead of "GtkHBox" and
	"GtkVBox".

	* src/gtk/x11dialg.h: add definition of structs "AxisBase",
	"AxisPos", "AxisFont", "AxisNumbering" and "AxisGauge".
	(struct AxisDialog): add member "tab", "del_btn", "tab_active",
	"base", "font", "position", "gauge" and "numbering".

	* src/gtk/x11dialg.c: remove gloval variables "DlgAxisBase",
	"DlgAxisPos", "DlgNum", "DlgAxisFont" and "DlgGauge".
	(SetObjFieldFromWidget): focus the widget when an error is
	occurred.

	* src/gtk/x11axis.c (bg_button_toggled): added.
	(GridDialogSetupItem): call "bg_button_toggled()".
	(GridDialogSetup): "toggled" signal is connected to
	"bg_button_toggled()" .
	(grid_copy_clicked): change name from "GridDialogCopy()".
	(gauge_syle_setup, GridDialogSetup, SectionDialogSetup)
	(CrossDialogSetup): use "GtkTable" instead of "GtkHBox" and
	"GtkVBox".
	(scale_tab_setup_item, scale_tab_copy_clicked, scale_tab_create)
	(baseline_tab_set_value, baseline_tab_setup_item)
	(baseline_tab_copy_clicked, baseline_tab_create)
	(gauge_tab_set_value, gauge_tab_setup_item)
	(gauge_tab_copy_clicked, gauge_tab_create)
	(numbering_tab_set_value, numbering_tab_setup_item)
	(numbering_tab_copy_clicked, numbering_tab_create)
	(font_tab_set_value, font_tab_setup_item, font_tab_copy_clicked)
	(font_tab_create, position_tab_set_value)
	(position_tab_setup_item, position_tab_copy_clicked)
	(position_tab_create, axis_dialog_show_tab): added.
	(AxisDialogSetup): use "GtkNotebook".
	(scale_tab_set_value): added.
	(AxisDialogClose): call "gtk_notebook_set_current_page()" when
	errors are occurred.
	(AxisDialogSetup): sensitivity of the delete button is depemd on
	"d->CanDel".

	* src/gtk/gtk_widget.c (add_widget_to_table_sub)
	(add_widget_to_table, add_copy_button_to_box): added.

2009-12-05  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* configure.in: set "AM_SILENT_RULES".

2009-11-30  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/osystem.c (sysinit): call "gsl_set_error_handler_off()" when
	"HAVE_LIBGSL" is defined.

	* src/math/math_basic_function.c (math_func_icgam)
	(math_func_gamma, math_func_erfc, math_func_beta, math_func_lgn)
	(math_func_pn, math_func_yn, math_func_jn, math_func_ei): use GSL
	function when available.
	(math_func_icbeta, math_func_erf, math_func_zeta)
	(math_func_zetam1, math_func_zeta_int, math_func_zetam1_int)
	(math_func_ynu, math_func_jnu, math_func_inu, math_func_knu)
	(math_func_in, math_func_kn, math_func_yl, math_func_jl): added.

2009-11-26  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/omath.c (parse_original_formula): this function is not used
	if "NEW_MATH_CODE" is not defined.

	* src/shellcm.c (cmdexpr): variable "err_msg" is always used.

	* src/gtk/main.c (obj_add_func_ary[]): add "addio".

	* src/oio.c: added.

2009-11-24  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/math/math_equation.c (clear_pos_func_buf): added.
	(math_equation_clear): use "clear_pos_func_buf()".
	(math_equation_parse): call "clear_pos_func_buf()" if
	"eq->pos_func_num" is greater than zero.

	* src/math/math_basic_function.c (math_func_asin)
	(math_func_acos): minimum value of "v" is -1 (not 0).
	(math_func_not): don't have to check "exp->buf[1]".
	(math_func_gt): comparing condition is ">" (not ">=").
	(math_func_pn): "x" is "double" (not "int").
	(math_func_pn): check maximum value of "x".
	(math_func_rsort): 3rd argument of the function "qsort" is
	"sizeof(MathValue)" (not "sizeof(double)").

	* src/shell.c (str_calc): set rcode as "MNAN" or "MUNDEF" when
	"value.type" is "MATH_VALUE_NAN" or "MATH_VALUE_UNDEF"
	respectively.
	(str_calc): initialize "value" and "val".

2009-11-23  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/math/math_basic_function.c (math_func_acos)
	(math_func_asin): initialize variable "v".

2009-11-21  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/math/math_parser.c (parse_const_def_expression): return NULL
	when "eq->func_def" is TRUE.
	(parse_const_def_expression): set and restore "eq->func_def"
	before and after call the function "parse_expression()".
	(parse_expression_list): don't call "math_expression_free()"
	before call "math_equation_set_parse_error()".
	(parse_expression_list): return NULL when "token->type" is
	"MATH_TOKEN_TYPE_CONST" and "inside_block" is TRUE.

	* src/math/math_error.h (MATH_ERROR_INVALID_CDEF)
	(MATH_ERROR_PRM_IN_DEF): added.

	* src/math/math_error.c (ERR_MSG_INVALID_C, ERR_MSG_PRM_IN_DEF):
	added.
	(ERR_MSG_POS_FUNC): change message.
	(math_err_get_error_message): add case for
	"MATH_ERROR_INVALID_CDEF" and "MATH_ERROR_PRM_IN_DEF#.

	* src/math/math_equation.c (math_equation_get_parameter): add
	argument "int *err" and set error id when "err" is not NULL.

	* src/ofile.c (put_func): don't substitute return value of the
	function "set_equation()" when rcode is TRUE.

	* src/object.c (ERR_MSG_BUF_SIZE): change buffer size.
	(error, error2, error22): change maximumlength of an error
	message.

2009-11-20  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/ofile.c (MATH_CONST_NUM): add constant "MASK" and "MOVE".
	(set_const): set constant "MASK" and "MOVE".

2009-11-17  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/math/math_parser.c (parse_primary_expression): return NULL
	when the type of the token is "MATH_TOKEN_TYPE_EOEQ".

	* src/gtk/x11commn.c (AddNgpFileList): check if the filename is
	valid UTF-8 string.

	* src/gtk/x11menu.c (show_file_menu_cb): change filename to UTF-8.

	* src/gtk/x11opt.c (SetScriptDialogBrowse)
	(SetDriverDialogBrowse): use "entry_set_filename()".

	* src/gtk/gtk_widget.c (entry_icon_file_select): use
	"entry_set_filename()".

	* src/gtk/x11opt.c (set_scrpt_file, SetDriverDialogClose): use
	"entry_get_filename()".

	* src/gtk/x11dialg.c (SetObjFieldFromText): change filename from
	UTF-8.

	* src/gtk/gtk_widget.c (entry_get_filename, entry_set_filename):
	added.

	* src/gtk/gtk_subwin.c (modify_string): change filename from
	UTF-8.

	* src/gtk/x11merge.c (merge_list_set_val): change filename to
	UTF-8.

	* src/gtk/x11gui.c (file_dialog_set_current_neme): change filename
	to UTF-8.

	* src/gtk/x11file.c (file_list_set_val): change filename to UTF-8.

	* src/gtk/x11dialg.c (SetTextFromObjField): change filename to UTF-8.

	* src/gtk/x11commn.c (check_overwrite, LoadNgpFile): change
	filename to UTF-8.

	* src/gtk/ox11menu.c (SetCaption): change filename to UTF-8.

	* src/gtk/gtk_widget.c (entry_set_filename): change filename to UTF-8.

	* src/gtk/gtk_subwin.c (file_select, start_editing): change
	filename to UTF-8.

	* src/ofile.c (set_data_progress): don't show the filename.

	* src/gtk/gtk_widget.c (filename_from_utf8, filename_to_utf8): added.

2009-11-16  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/nstring.c (nstrdup): remove (use g_strdup instead).

	* src/object.c (memalloc, memrealloc, memfree): remove (use
	g_malloc, g_realloc and g_free instead).

2009-11-14  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/strconv.h: moved from "src/gtk/strconv.c".

	* src/strconv.c: moved from "src/gtk/strconv.c".

	* src/math/math_parser.c (parse_primary_expression)
	(parse_const_def_expression): "*err" is "MATH_ERROR_EOEQ" when the
	type of the token is "MATH_TOKEN_TYPE_EOEQ".

	* src/gtk/strconv.c (utf8_to_sjis, sjis_to_utf8): use "CP932"
	instead of "shift-jis"

2009-11-12  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/omath.c (parse_original_formula): added.
	(mformula): use "parse_original_formula()".

2009-11-11  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/shellcm.c (str_calc): remove.

	* src/shell.c (str_calc): added.

	* src/object.c (getargument): use "str_calc()".

	* src/gra.c (GRAexpandmath): use "str_calc()".

	* src/ofile.c (put_func): restore old equation when new equation
	causes error.

2009-11-10  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/math/math_parser.c (parse_const_def_expression): set error
	code.
	(parse_const_def_expression): fix condition from "token->data.op
	== MATH_OPERATOR_TYPE_EQ" to "token->data.op !=
	MATH_OPERATOR_TYPE_ASSIGN"

2009-11-07  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11commn.c (get_save_opt): return "IDOK" or "IDCANCEL".
	(GraphSave): return "IDCANCEL" when "get_save_opt()" returns
	"IDCANCEL".

2009-11-06  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11view.c (mouse_down_move_data, move_data_cancel):
	first argument of "MessageBox()" is NULL.

	* src/gtk/x11print.c (CmOutputPrinter): first argument of
	"MessageBox()" is NULL.

	* src/gtk/x11opt.c (set_scrpt_option, CmOptionSaveNgp): first
	argument of "MessageBox()" is NULL.

	* src/gtk/x11menu.c: (static GtkWidget *CurrentWindow)
	(set_current_window, get_current_window): add
	(PutStderr): first argument of "MessageBox()" is NULL.

	* src/gtk/x11gui.c (DialogExecute): save and restore current window.
	(MessageBox): use "get_current_window()" as parent if "parent" is NULL.

	* src/gtk/x11commn.c (ErrorMessage): first argument of
	"MessageBox()" is NULL.

	* src/math/math_error.c (math_err_get_error_message): convert
	error message from utf-8 to locale.

	* src/gtk/x11lgnd.c (pos_edited, width_edited): don't show error
	message.

	* src/gtk/x11axis.c (pos_edited_common): don't show error message.
	(pos_edited_common): change first argument (from "struct
	objlist *" to "struct SubWin*").

	* src/gtk/gtk_widget.c (spin_change_value_cb): don't show error
	message (because Gtk+ shows following error message).
	Gtk-WARNING **: GtkEntry - did not receive focus-out-event. If you
	connect a handler to this signal, it must return FALSE so the
	entry gets the event as well

2009-11-04  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/ofile.c (put_func): change 5th argument from "int type" to
	"char *field".

	* src/ofit.c (fitput): use "math_err_get_error_message()".

2009-11-03  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/math/math_expression.c (math_constant_definition_expression_new):
	set error id to "*err" when the constant is already defined.

	* src/math/math_error.c (ERR_MSG_CONST_EXIST)
	(ERR_MSG_CALCULATION): added.

	* src/math/math_equation.c (math_equation_set_const_error)
	(math_equation_get_const_name): added.
	(math_equation_add_const_definition): add argument "int *err".

	* src/math/math_error.c (check_error_position)
	(math_err_get_error_message, ERR_MSG_FUNC_NEST)
	(ERR_MSG_UNEXP_OP, ERR_MSG_UNEXP_TOK, ERR_MSG_ARG_NUM)
	(ERR_MSG_MISS_RP, ERR_MSG_MISS_RC, ERR_MSG_MISS_RB)
	(ERR_MSG_UNKNOWN_F, ERR_MSG_INVARID_F, ERR_MSG_INVARID_P)
	(ERR_MSG_MEMORY, ERR_MSG_UNKNOWN, ERR_MSG_POS_FUNC): added.

	* src/math/math_parser.c (parse_array_expression)
	(parse_primary_expression, get_argument, create_math_func)
	(parse_unary_expression, parse_expression)
	(parse_expression_list): call "math_equation_set_parse_error()",
	"math_equation_set_func_arg_num_error()" or
	"math_equation_set_func_error()" when parse error.

	* src/math/math_equation.h (_struct _math_equation): add member
	"err_info".

	* src/math/math_equation.c (math_equation_new): use "memset()" to
	initialize struct.
	(math_equation_set_parse_error)
	(math_equation_set_func_arg_num_error)
	(math_equation_set_func_error): added.
	(math_equation_parse): initialize "eq->err_info".

	* src/gtk/x11lgnd.c (width_edited, pos_edited): add 4th argument
	for the function "str_calc()".
	(width_edited, pos_edited): show message on an error.

	* src/gtk/x11axis.c (pos_edited_common): add 4th argument for the
	function "str_calc()".
	(pos_edited_common): show message on an error.

	* src/gtk/gtk_widget.c (spin_change_value_cb): add 4th argument
	for the function "str_calc()".
	(spin_change_value_cb): show message on an error.

	* src/gtk/gtk_subwin.c (numeric_cb): add 4th argument for the
	function "str_calc()".

	* src/shellcm.c (str_calc): add argument "char **err_msg".
	(str_calc): set error message when "*err_msg" is not NULL.
	(cmdexpr): show error message created in new math code.

	* src/ofile.c (put_func): show message on an error.
	(f2dputmath): don't show error message.

2009-10-27  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* addin/legend.tcl (savescript): move frame rectangle to the top
	of the instances.
	(makescript): bug fix: fix typo "in" to "int".

2009-10-22  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/ofile.c (struct f2dlocal): add member "total_line",
	(f2dinit): initialize "f2dlocal->total_line".
	(set_final_line): added.
	(check_mtime, getminmaxdata): call "set_final_line()".

2009-10-21  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/shellcm.c (str_calc): add code for new math code.

	* src/omath.c (mlocalclear, minit, mdone): add code for new math
	code.
	(create_func_def_str): added.
	(mformula, mcalc): add code for new math code.

	* src/ofit.c (fitdone, fitput, fituser): add code for new math
	code.

	* src/ofile.c (struct f2ddata_buf): add members "colr2", "colg2"
	and "colb2" when "NEW_MATH_CODE" is true.
	(struct f2ddata): add some members when "NEW_MATH_CODE" is true.
	(struct f2dload): add some members when "NEW_MATH_CODE" is true.
	(file_color, file_rgb_sub, file_rgb, file_rgb2, file_hsb_sub)
	(file_hsb, file_hsb2, file_marksize, file_marktype, struct funcs)
	(add_file_func): added.
	(opendata, reopendata, f2dputmath): add code for new math code.
	(create_func_def_str, set_user_fnc, set_equation, put_func): added.
	(create_math_equation): added.
	(f2dinit, f2ddone, getdataarray, getdata_get_other_files): add
	code for new math code.
	(set_var, set_const, file_calculate, set_const_all): added.
	(getdata_sub2, getdata_sub1, getdata, getdata2, getdataraw)
	(getminmaxdata, markout, rectout, barout, fitout, f2ddraw)
	(f2devaluate, f2dgetdataraw, f2dstat, f2dstat2, f2dboundings)
	(f2doutputfile): add code for new math code.

	* src/object.c (getargument): add code for new math code.

	* src/gra.c (GRAexpandmath): add code for new math code.

	* src/gtk/x11file.c (FitDialogResult): add code for new math code.

	* src/math/parse_bin_expression.h: added.

	* src/math/math_scanner.h: added.

	* src/math/math_scanner.c: added.

	* src/math/math_parser.h: added.

	* src/math/math_parser.c: added.

	* src/math/math_operator.rb: added.

	* src/math/math_operator.h.in: added.

	* src/math/math_operator.h: added.

	* src/math/math_operator.c: added.

	* src/math/math_function.rb: added.

	* src/math/math_function.h.in: added.

	* src/math/math_function.h: added.

	* src/math/math_function.c: added.

	* src/math/math_expression.h: added.

	* src/math/math_expression.c: added.

	* src/math/math_error.h: added.

	* src/math/math_equation.h: added.

	* src/math/math_equation.c: added.

	* src/math/math_constant.rb: added.

	* src/math/math_constant.h.in: added.

	* src/math/math_constant.h: added.

	* src/math/math_constant.c: added.

	* src/math/math_basic_function.c: added.

	* src/math/Makefile.am: added.

	* configure.in: add macro for new math code.

	* src/gtk/x11axis.c (axiswin_scale_clear): call
	"set_graph_modified()" after call "exeobj()".

2009-10-20  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/shell.c (expand): new upstream release (6.3.51).

	* src/ofile.c (f2dtime, f2ddate): new upstream release (6.3.51).

	* src/omerge.c (mergedate, mergetime): new upstream
	release (6.3.51).

2009-10-10  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11commn.c (AxisDel): fix 3rd argument of
	"strncpy()" (from "sizeof(group)" to "sizeof(group3)").

2009-10-02  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11view.c (ViewerEvKeyDown): call "UnFocus()" when the
	escape key is pressed.

2009-09-05  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/mathcode.c (mathexpand): maximum value of the operand for
	operator '!' is 169 (not 69).

2009-08-28  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11commn.c (get_save_opt): added.
	(GraphSave): use "get_save_opt()".

2009-08-19  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11file.c (draw_type_pixbuf): call "g_object_unref()"
	for "pix" when "ggc" is lesser than 0.

	* src/gtk/x11view.c (drag_drop_cb): check the drop is success or
	not.
	(text_dropped): use "CheckGrid()".
	(enum EvalDialogColType, eval_dialog_set_parent_cal)
	(mask_selected_data): added.
	(EvalDialogSetupItem, eval_dialog_copy_selected)
	(EvalDialogSetup, select_data_cb): use "GtkTreeStore" instead of
	"GtkListStore".
	(Evaluate): use "mask_selected_data".
	(mouse_down_move_data): don't return but "goto ErrEnd;" when
	"fileobj" is NULL.

2009-08-18  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11view.c (eval_dialog_copy_selected): save text to not
	only "CLIPBOARD" but "PRIMARY".

2009-08-17  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/gtk_widget.c (_create_spin_entry): fix argument of
	"gtk_spin_button_set_digits()".

	* src/gtk/x11dialg.c (get_style_string): added.
	(SetStyleFromObjField): use "get_style_string()".

	* src/gtk/x11lgnd.c (legend_list_set_val): don't display size of
	mark object.
	(legend_list_set_val): show mark size in "LEGEND_WIN_COL_WIDTH"
	column.
	(legend_list_set_val): show some fields in "LEGEND_WIN_COL_PROP"
	column.
	(width_edited): edit "size" field of mark object.
	(get_points): added.

2009-08-14  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11gui.c (DialogExecute): set "GlobalLock" as TRUE, save
	and restore "GlobalLock" to inhibit DnD during executing dialog.

	* src/gtk/x11view.c (init_dnd): use
	"gtk_target_list_add_text_targets()" to add text target.
	(drag_drop_cb): do nothing when "GlobalLock" is TRUE.
	(drag_drop_cb): always call "gtk_drag_finish()".
	(paste_cb): call "UpdateAll()" after call "ShowFocusFrame()".
	(text_dropped): focus newly created text.

2009-08-13  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11gui.c (DialogSpinEntry): call
	"gtk_spin_button_set_numeric()".

	* src/gtk/x11print.c (OutputImageDialogSetup): second argument of
	"gtk_spin_button_set_numeric()" is TRUE.

	* src/gtk/x11lgnd.c (pos_edited, width_edited): use "str_calc()"
	instead of "strtod()".

	* src/gtk/x11axis.c (pos_edited_common): use "str_calc()" instead
	of "strtod()".

	* src/gtk/gtk_widget.c (spin_change_value_cb): added.
	(_create_spin_entry): call "g_signal_connect()" for "input"
	signal.
	(_create_spin_entry): second argument of
	"gtk_spin_button_set_numeric()" is FALSE.

	* src/gtk/gtk_subwin.c (start_editing): second argument of
	"gtk_spin_button_set_numeric()" is FALSE.
	(numeric_cb): use "str_calc()" instead of "strtod()".

	* src/gtk/x11lgnd.c (width_edited): added.
	(CmLegendWindow): call "set_editable_cell_renderer_cb()" for
	"LEGEND_WIN_COL_WIDTH".
	(legend_list_set_val): add case for "LEGEND_WIN_COL_WIDTH".
	(legend_list_set_val): add mark character and mark size for the
	case of "LegendTypeMark".
	(MarkChar, MarkCharNum): added.
	(Llist): add column "lw/pt", remove column "object" and change
	column from "property" to "object/property".
	(LEGEND_WIN_COL_WIDTH): added.
	(legend_list_set_val): gettextize some strings.
	(legend_list_set_val): remove case for "LEGEND_WIN_COL_NAME".
	(legend_list_build, legend_list_set): set strings to
	"LEGEND_WIN_COL_PROP" column.

2009-08-12  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11file.c (fit_load_dialog_default_cb): remove.
	(FitLoadDialogSetup): use "GtkComboBox" instead of "GtkTreeView".
	(FitSaveDialogSetup): add delete button.
	(FitSaveDialogClose): call "g_strstrip()" for the profile.
	(FitSaveDialogClose): show confirm message when the profile is not
	specified.
	(copy_settings_to_fitobj, delete_fitobj): added.
	(FitDialogSave): use "copy_settings_to_fitobj()" and
	"delete_fitobj()".
	(FitCB): return "type" only when "profile" is NULL.

2009-08-11  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11view.c (eval_dialog_copy_selected)
	(eval_data_sel_cb): added.
	(EvalDialogSetup): add "Copy" button.
	(paste_cb): place pasted text to center of the widget.
	(text_dropped): position of the text is multiple of 100.

	* src/gtk/x11file.c (math_dialog_key_pressed_cb): use
	"gtk_tree_selection_count_selected_rows()" to check rows are
	selected or not.

	* src/gtk/x11dialg.c (multi_list_default_cb): use
	"gtk_tree_selection_count_selected_rows()" to check rows are
	selected or not.

	* src/gtk/x11dialg.c (multi_list_default_cb): remove redundant
	call of "gtk_tree_view_get_selection()".

	* src/gtk/x11dialg.h (struct FitDialog): add member "func_label".

	* src/gtk/x11file.c (FitDialogSetup): add equation label.
	(FitDialogSetup): improve the placement of widgets.
	(FitDialogSetup): maximum number of "d->dim" is 9.
	(FitDialogSetup): maximum number of "d->div" is 65535.
	(FitDialogSetSensitivity): set equation label string.
	(set_fitdialog_sensitivity): added.

	* src/ofit.c (fituser): show "dxxc" in the progress dialog.

2009-08-10  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gra.c (GRAexpandtext): output '-' character when the string
	is '\-' (because 0xad "soft hyphen" is not printable usually).
	(GRAexpandtext): output no character when the string is '\x00'.

	* src/gtk/gtk_subwin.c (sub_window_create): call
	"gtk_widget_show_all()" for "swin".

2009-08-07  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11file.c (select_color): check version of GTK.

	* src/gtk/x11gui.c (FileSelectionDialog): call
	"file_dialog_set_current_neme()" only when "type" is
	"GTK_FILE_CHOOSER_ACTION_SAVE".

2009-08-06  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/object.c (sexeobjfield): check "arglist" before call
	"strcmp()".

	* src/odraw.h (enum SAVE_PATH_TYPE): added.

	* src/gtk/x11commn.c (SetFileName): use copy of "str".
	(ToRalativePath): added.
	(GraphSave): save and restore previous working directory.
	(GraphSave): change "file::file" and "merge::file" depend on the
	value of "path".

2009-08-05  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11opt.c (MiscDialogSetup): set label to some frames.

	* src/gtk/x11file.c (FitCB): just return "valstr".

	* src/gtk/x11commn.c (FileCB): use "g_strdup_printf()".
	(change_filename, get_basename, ToBasename): added.
	(ToFullPath): use "change_filename()".
	(LoadNgpFile): "system::ignore_path" is always FALSE.
	(LoadNgpFile): call "ToBasename()" when "ignorepath" is TRUE.

	* src/gtk/x11axis.c (AxisCB, AxisHistoryCB, GridCB): use
	"g_strdup_printf()".

	* src/gtk/x11commn.c (LoadPrmFile): set modified flag when load
	PRM file.

	* src/oaxis.c (draw_wave, draw_arrow): added.
	(axisdraw): use "draw_wave()" and "draw_arrow()".

2009-08-04  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/gtk_widget.c (direction_icon_released)
	(create_direction_entry): exchange up and down icon.

	* src/oline.c (arrowdraw, arrowbbox): use "enum
	ARROW_POSITION_TYPE".

	* src/oaxis.c (enum AXIS_SCALE_TYPE): added.
	(anumdirchar, enum AXIS_NUM_DIR): add member "normal2".
	(get_num_pos_horizontal, get_num_pos_parallel)
	(get_num_pos_normal, struct font_config, struct axis_config)
	(get_num_ofst_horizontal, get_num_ofst_parallel)
	(get_num_ofst_normal1, get_num_ofst_normal2, draw_numbering)
	(numbering, draw_gauge, get_axis_parameter)
	(get_reference_parameter): added.
	(axisdraw): use "get_reference_parameter()", "draw_gauge()" and
	"numbering()".
	(axisdraw): use "enum ARROW_POSITION_TYPE".

	* src/odraw.h (enum ARROW_POSITION_TYPE): added.

	* src/mathfn.c (compare_double): added.

	* src/axis.c (getaxispositionini): use "compare_double()" to
	compare two floating-point value.

2009-07-27  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11view.c (ncopyobj): use "copy_obj_field()".
	(new_file_obj): add argument "multi".
	(data_dropped): "Apply All" button is active when "i" is lesser
	than "num - 1".

	* src/gtk/x11file.c (copy_file_obj_field): use "copy_obj_field()".

	* src/gtk/x11commn.c (FitCopy): use "copy_obj_field()".

	* src/gtk/gtk_subwin.c (obj_copy): use "copy_obj_field()".

	* src/shellcm.c (cmcpy): use "copy_obj_field()".

	* src/object.c (copy_obj_field): added.

2009-07-26  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11file.c (copy_file_obj_field): add
	(FitDialogSave): check "DlgFitSave.Profile" and
	"DlgFitSave.Profile[0]".
	(FitDialogSave): check arguments of "strcmp()".
	(CmFileHistory): use "nstrdup()" instead of "memalloc()" and
	"strcpy()".
	(FileDialogCopyAll, update_file_obj_multi, file_obj_copy): use
	"copy_file_obj_field()".

	* src/gtk/x11gui.c (fsok): use "g_strdup_printf()" or "strdup()"
	instead of "malloc()" and "strcpy()".

	* src/gtk/x11commn.c (AxisDel): use "strncpy()" instead of
	"strcpy()".

	* src/gtk/ogra2cairofile.c (gra2cairofile_output): don't check
	"local->linetonum" before call "gra2cairo_draw_path()".

	* src/gtk/ogra2cairo.c (gra2cairo_update_fontmap): check arguments
	"fontname" and "fontalias".
	(gra2cairo_draw_path): check "local->linetonum".
	(gra2cairo_free, gra2cairo_flush, gra2cairo_output): don't check
	"local->linetonum" before call "gra2cairo_draw_path()".

	* src/gtk/gtk_entry_completion.c (entry_completion_append): check
	argument "str".

2009-07-23  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11file.c (FitDialogSave): bug fix: check and argument
	of "strcmp()".

	* src/gtk/x11gui.c (set_dialog_position, get_dialog_position):
	added.
	(DialogInput, DialogRadio, DialogCombo, DialogComboEntry)
	(DialogSpinEntry, DialogCheck): add add argument "x" and "y".

	* src/gtk/ox11dlg.c (dlginit): initialize "x" and "y" field.
	(dlginput, dlgradio, dlgcombo, dlgspin, dlgcheck): add argument
	"x" and "y" to create dialog window.
	(dialog): add field "x" and "y".

2009-07-22  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11axis.c (CmAxisWindow): call "sub_window_show_all()"
	instead of "sub_window_show()".

	* src/gtk/x11cood.c (CoordWinUpdate): call "sub_window_show_all()"
	instead of "sub_window_show()".

	* src/gtk/x11file.c (CmFileWindow): call "sub_window_show_all()"
	instead of "sub_window_show()".

	* src/gtk/x11info.c (InfoWinUpdate): call "sub_window_show_all()"
	instead of "sub_window_show()".

	* src/gtk/x11lgnd.c (CmLegendWindow): call "sub_window_show_all()"
	instead of "sub_window_show()".

	* src/gtk/x11merge.c (CmMergeWindow): call "sub_window_show_all()"
	instead of "sub_window_show()".

	* src/gtk/gtk_subwin.c (sub_window_show_all): added.
	(sub_window_show, sub_window_hide): call "gtk_widget_show()" and
	"gtk_widget_hide()" instead of "gtk_widget_show_all()" and
	"gtk_widget_hide_all()" respectively.

2009-07-21  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/omark.c (MODIFY_MARK_TYPE, rotate_cw, v_flip, h_flip): added.
	(markrotate, markflip): modify mark type when "MODIFY_MARK_TYPE"
	is TRUE.

2009-07-15  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11file.c (select_type): use 3rd column of the combo-box
	to specify which type of item is selected.
	(start_editing_type): don't activate the combo-box item.

	* src/gtk/gtk_liststore.c (start_editing_obj): add column to the
	model.

2009-07-14  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/gtk_liststore.c (create_column): set "expand" property
	as TRUE when ellipsize mode is not "PANGO_ELLIPSIZE_NONE".

	* src/gtk/x11file.c (enum FILE_COMBO_ITEM, select_color): added.
	(select_type): set not only "type" but color.
	(create_type_combo_box): add color setting combo item.

2009-07-10  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11file.c (count_line_number_str, set_line_number_tag)
	(create_text_tag): added.
	(FileDialogSetup): initialize "d->comment_num_tag" and set tag for
	line number.

	* src/gtk/x11dialg.h (struct FileDialog): add member
	"comment_num_tag".

	* addin/Makefile.am (pkglib_DATA): add "cal.nsc".

	* addin/cal.nsc: added.

	* src/gtk/x11gui.c (DialogSpinEntry): added.

	* src/gtk/ox11dlg.c (dlgspin): added.
	(dialog): add new field "double_entry" and "integer_entry".

2009-07-09  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11menu.c (clear_information): added.
	(create_windowmenu): add menu item "_Clear information window".

	* src/gtk/ox11menu.c (menudone): return "1" when GUI is active.
	(mxredraw, mxdpi, mxflush, mx_get_focused, mx_echo, mx_cat)
	(mx_clear_info, mx_toggle_win, mxdraw, mxclear): do nothing when
	GUI is not active.
	(menuerrorlist): add error message ("the GUI is not active").
	(SubwinData, _subwin_data, subwindow_show, subwindow_hide)
	(mx_show_win, mx_hide_win): added.
	(gtkmenu): add new field "show_window" and "hide_window".

	* src/gtk/x11info.c (create_win): initialize font and geometry
	settings.

2009-07-08  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11opt.c (MiscDialogSetupItem, MiscDialogSetup)
	(MiscDialogClose): add code for "infowin_font" setting.

	* src/gtk/x11info.c (InfoWinSetFont): added.
	(InfoWinUpdate): call "InfoWinSetFont()".

	* src/gtk/ox11menu.h (struct menulocal): add member
	"infowin_font".

	* src/gtk/ox11menu.c (menuerrorlist): add error message ("cannot
	open the file").
	(MenuConfigMisc): add "infowin_font" setting.
	(mx_cat, mx_clear_info, mx_toggle_win): added.
	(gtkmenu): add new field "cat", "clear_info" and "toggle_window".

2009-07-07  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/gtk_subwin.c (tree_hidden): don't execute "d->update()"
	but call "gtk_tree_store_set()".
	(toggle_cb): use "tree_hidden()".

	* src/object.c (sexefield): don't remove space character.
	(sexeobjfield): remove space character only when "arglist" is "s".

2009-07-06  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11commn.c (AddNgpFileList): free "full_name" after call
	"g_strdup_printf()".

	* src/gtk/x11view.c (paste_cb): don't use a temporary file and use
	"eval_script()".

	* src/shell.c (getcmdline): the type of argument "str" is "const
	char *".
	(eval_script): added.
	(cmdexecute): the type of argument "cline" is "const char *".

2009-07-05  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* initfile/Ngraph.nsc: use "NGRAPHCONF" instead of "NGRAPHLIB".

	* src/gtk/x11print.c (DriverDialogClose): use "g_strdup_printf()"
	instead of "snprintf()".

	* src/gtk/x11opt.c (create_font_selection_dialog): use
	"g_strdup_printf()" instead of "snprintf()".

	* src/gtk/x11menu.c (createmenu): use "g_strdup_printf()" instead
	of "snprintf()".
	(load_hist_file, save_hist_file): added.
	(save_entry_history): use "save_hist_file()".
	(load_hist): use "load_hist_file()".

	* src/gtk/x11dialg.c (SetObjAxisFieldFromWidget): use
	"g_strdup_printf()" instead of "snprintf()".

	* src/gtk/x11commn.c (check_overwrite, AddNgpFileList)
	(SaveHistory): use "g_strdup_printf()" instead of "snprintf()".

	* src/gtk/ox11menu.c (add_prm_str_to_array)
	(save_ext_driver_config, save_script_config): use
	"g_strdup_printf()" instead of "snprintf()".
	(menu): "arglist" of "menu" field is "s".

	* src/gtk/main.c (main, obj_member_completion_function): use
	"g_strdup_printf()" instead of "snprintf()".

	* src/shellcm.c (cmbasename): call "basename(3)" to duplicated
	string.
	(cmdirname): use duplicated string.
	(cmexist): add "-q" option.

	* driver/ngp2.in: use "-q" option for "exist" command.
	(save_image): copy settings of "gra" object.
	(save_image): set "display" field of "fit" object as false if
	exist.

	* initfile/Ngraph.nsc: use "-q" option for "exist" command.
	(load_graph): argument of "$LOGIN_SHELL" is full-path filename.

2009-07-02  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11print.c (DriverDialogBrowseCB, CmPrintGRAFile)
	(CmOutputImage, CmPrintDataFile): change the arguments of the
	function "nGetSaveFileName()".

	* src/gtk/x11opt.c (SetScriptDialogBrowse)
	(SetDriverDialogBrowse): change the arguments of the function
	"nGetOpenFileName()".

	* src/gtk/x11merge.c (CmMergeOpen): change the arguments of the
	function "nGetOpenFileName()".

	* src/gtk/x11gui.c (file_dialog_set_current_neme): added.
	(FileSelectionDialog): use "file_dialog_set_current_neme()".
	(nGetOpenFileNameMulti, nGetOpenFileName, nGetSaveFileName):
	remove the argument "filter".
	(struct nGetOpenFileData): remove member "filter".

	* src/gtk/x11graph.c (CmGraphLoad): change the
	arguments of the function "nGetOpenFileName()".

	* src/gtk/x11file.c (CmFileNew, CmFileOpen): change the arguments
	of the functions "nGetOpenFileName()" and
	"nGetOpenFileNameMulti()".

	* src/gtk/x11commn.c (GraphSave): change the arguments of the
	function "nGetSaveFileName()".

	* src/gtk/ox11dlg.c (dlggetopenfile, dlggetopenfiles)
	(dlggetsavefile): change the arguments of the functions
	"nGetOpenFileName()", "nGetOpenFileNameMulti()" and
	"nGetSaveFileName()".

	* src/gtk/ogra2cairo.c (gra2cairo_save_config): use
	"g_strdup_printf()" instead of "snprintf()".

	* src/gtk/gtk_widget.c (entry_icon_file_select): change the
	arguments of the function "nGetOpenFileName()".

	* src/gtk/gtk_subwin.c (file_select): change the arguments of the
	function "nGetOpenFileName()".

2009-07-01  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11print.c (DriverDialogClose): use "check_overwrite()".

	* src/gtk/x11gui.c (FileSelectionDialog): don't call
	"gtk_file_chooser_set_do_overwrite_confirmation()".
	(FileSelectionDialog): call "check_overwrite()" when "type" is "
	GTK_FILE_CHOOSER_ACTION_SAVE" and "data->overwrite" is false.

	* src/gtk/x11commn.c (check_overwrite): added.

2009-06-30  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/ogra2cairofile.c (gra2cairofile_output): call
	"gra2cairo_draw_path()" before call
	"cairo_surface_write_to_png()".

	* src/gtk/ogra2cairo.c (gra2cairo_draw_path): added.
	(gra2cairo_free, gra2cairo_flush, gra2cairo_output): use
	"gra2cairo_draw_path()".

2009-06-29  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/ofit.c (fitpoly, fituser): call "display_equation()" only
	when "disp" is true.

2009-06-26  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11file.c (FitDialogClose): check "ret" instead of
	"d->ret" with "IDOK".

2009-06-24  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/main.c (reset_fifo, exec_console): added.
	(nallocconsole): use "exec_console()".
	(nallocconsole): call "unlink()" after open fifo.

	* src/terminal.c (main): don't call "unlink()".

2009-06-18  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/main.c (main): initialize system::conf_dir.
	(main): search "conf_dir" instead of "lib_dir".

	* src/gtk/dir_defs.h.in (CONFDIR): added.

	* src/shell.c (ngraphenvironment): add new environment variable
	"NGRAPHCONF".

	* src/osystem.c (nsystem): add new field "conf_dir".

	* src/nconfig.c (searchscript, openconfig, replaceconfig)
	(removeconfig, writecheckconfig, copyconfig): search "conf_dir"
	instead of "lib_dir".

	* src/ioutil.h (CONFSEP): change from "/." to "/".

	* src/Makefile.am (pkglib_PROGRAMS): "terminal" is installed in
	"$pkglibdir".

	* initfile/Ngraph.ini.in: specify full path of "nterminal".

	* initfile/Makefile.am (ngraphconfdir): configration files are
	installed in "$(sysconfdir)/$(PACKAGE)".

	* initfile/fit.ngp: change file name from ".fit.ngp"

	* initfile/Ngraph.nsc: change file name from ".Ngraph"

	* initfile/Ngraph.ngp: change file name from ".Ngraph.ngp"

	* driver/Makefile.am (ngraphconfdir): configration files are
	installed in "$(sysconfdir)/$(PACKAGE)".

	* addin/Makefile.am (pkglib_DATA): install addins to $pkglibdir.

2009-06-15  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11commn.c (SaveDrawrable): use "NFMODE_NORMAL_FILE"
	instead of "NFMODE".

	* src/gtk/x11file.c (FitDialogSave): use "NFMODE_NORMAL_FILE"
	instead of "NFMODE".

	* src/ioutil.h (NFMODE_NORMAL_FILE): added.

	* src/osystem.c (sysdone): delete temporary files if exist.

2009-06-14  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/osystem.c (systemp): use "n_mkstemp()".

	* src/ioutil.c (n_mkstemp): set and restore umask.

2009-06-11  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* zsh/_ngraph: added.

	* zsh/_ngp2: added.

	* zsh/_gra2wmf: added.

	* zsh/_gra2ps: added.

	* zsh/Makefile.am: added.

	* src/gtk/x11print.c (draw_gra): check "NgraphApp.Viewer.win"
	before call "gdk_window_invalidate_rect()".

	* initfile/.Ngraph: add new option -cr, -cg, -cb, -CR, -CG, -CB,
	-incx, -maxx, -minx, -incy, -maxy, -miny, -L and -dialog.
	option -c, -C, -zx and -zy are obsolete.

2009-06-10  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* debian/rules: add mime types and bash completion settings.

	* src/ofile.c (markout): the argument "type" is not used in this
	function.

2009-06-09  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11menu.c (show_graph_menu_cb): remove code related to
	"ngp_history" and "ngp_dir_history".
	(create_recent_graph_menu): use "GtkRecentChooserMenu".

	* src/gtk/x11graph.c (CmGraphHistory): use "GtkRecentChooser".

	* src/gtk/x11commn.c (AddNgpFileList): static function.
	(AddNgpFileList): use "GtkRecentManager".
	(SaveHistory): don't save "ngp_history" and "ngp_dir_history".

	* src/gtk/ox11menu.c (MenuConfig): remove "ngp_history" and
	"ngp_dir_history".
	(menulocal_finalize, menuinit): remove code related to
	"ngp_history" and "ngp_dir_history".
	(menuinit): "Menulocal.ngpfilelist" is "GtkRecentManager *".

	* initfile/Ngraph.ini.in (viewer_load_file_data_number): remove
	"ngp_history" and "ngp_dir_history".

2009-06-08  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11graph.c (pagelist, PageDialogSetup): gettextize paper
	size strings.

2009-06-03  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gra.c (getintpar): check size of "s2".
	(GRAinputdraw): check number of the parameters and return success
	or not.
	(GRAinput): return the return value of "GRAinputdraw()".

	* src/gtk/x11menu.c (AppMainLoop): return 1 when terminated.
	(application): delete instance of "system" object when return
	value of "AppMainLoop()" is 1.

2009-06-02  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/main.c (nfreeconsole): send "SIGTERM" instead of
	"SIGCHLD".

	* src/terminal.c (main): use "sigsuspend()" if available.
	(main): trap "SIGTERM" instead of "SIGCHLD".

	* src/shell.c (cmdexec): bug fix: use "WEXITSTATUS" to get return
	status of external command.

	* src/gtk/x11menu.c (application): call "SaveHistory()".
	(AppMainLoop): don't call "SaveHistory()".

2009-06-01  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/shell.c (set_signal, set_shellevloop, reset_shellevloop):
	added.
	(shellevloop): use pthread.
	(shgetstdin, shget): use "set_shellevloop()" and
	"reset_shellevloop()".
	(childhandler, set_childhandler, unset_childhandler): added.
	(cmdexec): call "unset_childhandler()" and "set_childhandler()"
	before and after execute command.

	* src/gtk/x11menu.c (term_signal_handler): added.
	(childhandler): remove.
	(AppMainLoop): check type of "Hide_window".
	(application): use "set_signal()".
	(application): trap "SIGTERM" while GUI is active.

	* src/gtk/x11file.c (FitDialogClose): bug fix: delete unused fit
	objects not only in the case of "d->ret" is "IDOK" but "IDCANCEL"
	and "IDDELETE".
	(FileDialogFit): call "set_graph_modified()" if necessary.
	(FileDialogEdit, CmFileEdit, FileWinFileEdit): don't call
	"arrayadd()" for "ChildList".

	* src/shellux.c (cmsleep): use "set_signal()".

2009-05-26  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11menu.c (create_graphmenu): use "GTK_STOCK_PAGE_SETUP"
	when the version of GTK++ is greater than 2.14.

2009-05-23  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11lgnd.c (pos_edited): call "set_graph_modified()"
	after "exeobj()".

2009-05-19  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/nconfig.c (getconfig): treat the line as comment when the
	first caractor of the line is "#" or ";".

2009-05-18  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/ogra2cairo.c (gra2cairo): change permission of fields
	"init" and "done".

	* src/gtk/main.c (load_config): added.
	(load_config): bug fix: check return value of "getobject".

	* src/gtk/x11axis.c (file_button_show): added.
	(AxisDialogSetup): call "g_signal_connect()" for "show" signal of
	"File" button.

	* src/gtk/x11opt.c (set_font): added.
	(MiscDialogClose): use "set_font()".
	(MiscDialogSetupItem, MiscDialogSetup): initialize and setup
	"d->file_preview_font".

	* src/gtk/x11dialg.h (struct FileDialog): add member
	"comment_view".
	(struct MiscDialog): add member "file_preview_font".

	* src/gtk/x11file.c (FileDialogSetup): call
	"gtk_widget_modify_font" if "Menulocal.file_preview_font" is not
	NULL.

	* src/gtk/ox11menu.h (struct menulocal): add member
	"file_preview_font".

	* src/gtk/ox11menu.c (MenuConfigMisc): add config
	"file_preview_font".
	(menulocal_finalize): added.
	(menuinit, menudone): use "menulocal_finalize()".
	(menuinit): call "memset()" to initialize "Menulocal".

	* src/gtk/ogra2x11.c (gtkloadconfig): check string
	"use_external_viewer".

2009-05-17  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11axis.c (AxisPosDialogSetup): use
	"create_direction_entry()" instead of "create_spin_entry_type()".

	* src/gtk/x11lgnd.c (legend_dialog_setup_sub): use
	"create_direction_entry()" instead of "create_spin_entry_type()".

	* src/gtk/gtk_widget.c (direction_icon_released)
	(create_direction_entry): added.

2009-05-15  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11print.c (DriverDialogSelectCB): set value to
	"d->ext".
	(DriverDialogBrowseCB): set filter when "d->ext" is not NULL.
	(DriverDialogClose): use "d->widget" for first argument of
	"MessageBox()".
	(DriverDialog): initialize "data->ext".
	(CmPrintGRAFile, CmOutputImage, CmPrintDataFile): remove check of
	confirmation about overwriting an existing file.

	* src/gtk/x11opt.c (SetDriverDialogBrowse, SetDriverDialogClose)
	(PrefFontDialogAdd): use "d->widget" for first argument of
	"MessageBox()" and "nGetOpenFileName()".

	* src/gtk/x11merge.c (MergeDialogSetup): use "create_file_entry()"
	instead of "create_text_entry()".

	* src/gtk/x11gui.c (struct nGetOpenFileData): add member
	"overwrite".
	(FileSelectionDialog): check "parent".
	(FileSelectionDialog): call
	"gtk_file_chooser_set_do_overwrite_confirmation()" when "type" is
	"GTK_FILE_CHOOSER_ACTION_SAVE".
	(FileSelectionDialog): hide "data->chdir_cb" when "data->initdir"
	is NULL.
	(nGetSaveFileName): add argument "overwrite".

	* src/gtk/x11file.c (FitDialogLoadConfig, FitDialogLoad)
	(FitDialogSave): use "d->widget" for first argument of
	"DialogExecute".
	(FileDialogSetup): use "create_file_entry()" instead of
	"create_text_entry()".
	(FileWinFit): use "d->Win" for first argument of "DialogExecute".

	* src/gtk/x11dialg.h (struct DriverDialog): add member "ext".

	* src/gtk/x11commn.c (GraphSave): remove check of confirmation
	about overwriting an existing file.

	* src/gtk/x11axis.c (AxisDialogFile): use "d->widget" for first
	argument of "DialogExecute".

	* src/gtk/gtk_widget.c (get_parent_window)
	(entry_icon_file_select, create_file_entry): added.

	* src/gtk/gtk_subwin.c (file_select): added.
	(start_editing): call gtk_entry_set_icon_from_stock when
	"list->name" is "file".

	* src/gtk/gtk_common.h (USE_ENTRY_ICON): added.

	* src/omerge.c (merge): add field "ext".
	(mergeinit): initialize field "ext".

2009-05-14  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* initfile/.Ngraph: change directory when "ngp" or "prm" file is
	specified.

	* src/gtk/x11graph.c (DirectoryDialogSetup): use
	"GtkFileChooserButton" instead of "GtkEntry".

	* src/shell.c (cmdtable): add commands "basename" and "dirname".

	* src/shellcm.c (cmdirname, cmbasename): added.

2009-05-13  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11view.c (Trimming): use "axis_scale_push()" instead of
	"exeobj()".

	* src/gtk/x11axis.c (check_axis_history): added.
	(CmAxisWinScaleUndo): call "check_axis_history()" instead of
	"chkobjlastinst()".
	(axis_scale_push): added.
	(AxisDialogClose, axiswin_scale_clear, CmAxisClear)
	(axis_prm_edited_common): use "axis_scale_push()" instead of
	"exeobj()".
	(CmAxisWinScaleUndo): call "set_axis_undo_button_sensitivity()".

	* src/gtk/x11menu.c (hide_instance_menu_cb): added.
	(set_show_instance_menu_cb): add arguments "show_cb" and
	"hide_cb".
	(show_axis_menu_cb, hide_axis_menu_cb): added.
	(create_axismenu): add 5th and 6th arguments to call
	"set_show_instance_menu_cb()".
	(set_axis_undo_button_sensitivity): added.
	(setupwindow): call "set_axis_undo_button_sensitivity()".

	* src/gtk/x11file.c (CmFileWinMath): check number of instance.

2009-05-12  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11axis.c (AxisDialogSetupItem): add item to combo boxes
	when the value is different from previous one.
	(axis_prm_edited_common, min_edited, max_edited, inc_edited): added.
	(CmAxisWindow): call "set_editable_cell_renderer_cb()" for
	"AXIS_WIN_COL_MIN", "AXIS_WIN_COL_MAX" and "AXIS_WIN_COL_INC".
	(AxisHistoryCB): added.
	(AxisWinExpose): use "AxisHistoryCB()".
	(CmAxisDel): check "DlgCopy.sel".

	* src/gtk/x11lgnd.c (LegendTextCB): return whole string.

	* src/gtk/x11dialg.c (SelectDialogSetup, CopyDialogSetup):
	"PangoEllipsizeMode" of "property" column is
	"PANGO_ELLIPSIZE_END".
	(SelectDialogSetup, CopyDialogSetup): append item only when return
	value of a function "d->cb()" is not NULL.
	(SelectDialogClose): save value of "id" column.
	(CopyDialogClose): set value of "id" column of the selected row to
	"d->sel".

	* src/oaxis.c (axisbbox2): check "inst".
	(get_axis_box): this function returns int.
	(get_axis_box): check return value of "axisbbox2()".
	(get_axis_group_box): this function returns int.
	(get_axis_group_box): check return value of "get_axis_box()".
	(axisbbox): check return value of "get_axis_group_box()".
	(axisrotate2, axisflip2): check "inst".
	(axisrotate, axisflip): check return value of
	"get_axis_group_box()".
	(AXIS_HISTORY_NUM): added.
	(axisscalepush): use "AXIS_HISTORY_NUM".

2009-05-11  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/ox11menu.c (MenuConfigToggleView): add "{NULL}" at the
	end of the array.

2009-05-08  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/ofile.c (USE_BUF_PTR, USE_RING_BUF, BUF_TYPE, USE_MEMMOVE)
	(RING_BUF_INC, ring_buf_index): added.
	(struct f2ddata): add new member "buf_ptr" or "ringbuf_top".
	(struct f2ddata): now "buf" is array.
	(opendata): initialize "buf_ptr" or "ringbuf_top".
	(getdata): use array of pointer or ring buffer.

2009-05-01  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11view.h (enum FOCU_OBJ_TYPE): add
	"FOCUS_OBJ_TYPE_TEXT".

	* src/gtk/x11view.c (enum ViewerPopupIdn): add
	"VIEW_FLIP_HORIZONTAL" and "VIEW_FLIP_VERTICAL".
	(create_popup_menu): added.
	(create_popup_menu): add flip menu.
	(VIEWER_POPUP_ITEM_FLIP): added.
	(execute_selected_instances): added.
	(RotateFocusedObj): use "execute_selected_instances()".
	(FlipFocusedObj): added.
	(do_popup): set sensitivity of flip menu.
	(ViewerPopupMenu): add case for "VIEW_FLIP_HORIZONTAL" and
	"VIEW_FLIP_VERTICAL".
	(CmEditMenuCB): add case for "MenuIdEditFlipHorizontally" and
	"MenuIdEditFlipVertically".

	* src/gtk/x11menu.h (enum MenuID): add
	"MenuIdEditFlipHorizontally" and "MenuIdEditFlipVertically".

	* src/gtk/x11menu.c (show_edit_menu_cb): set sensitivity of
	"FlipH" and "FlipV".
	(create_editmenu): add flip menu.

	* src/orect.c (rectflip): added.
	(rect): add new field "flip".

	* src/opolygon.c (opoly): add new field "flip".

	* src/omark.c (markflip): added.
	(mark): add new field "flip".

	* src/oline.c (arrow): add new field "flip".

	* src/olegend.h (enum FLIP_DIRECTION): added.

	* src/olegend.c (flip, legendflip): added.

	* src/ocurve.c (curve): add new field "flip".

	* src/oaxis.c (axisbbox2, get_axis_box): remove unused arguments
	"argc" and "argv".
	(get_axis_group_box): added.
	(axisbbox, axisrotate): use "get_axis_group_box()".
	(axisflip2, axisflip): added.
	(axis): add new field "flip".

	* src/oarc.c (arcflip): added.
	(arc): add new field "flip".

	* addin/append.nsc: hide and recover axisgrid.

2009-04-30  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11menu.h (SUBWIN_PROTOTYPE): added.
	(struct SubWin, struct LegendWin, struct InfoWin): use
	"SUBWIN_PROTOTYPE".
	(struct CoordWin): remove.

	* src/gtk/x11dialg.h (DIALOG_PROTOTYPE): added. use
	"DIALOG_PROTOTYPE" for all struct which inherit "DialogType"
	struct.

	* src/gtk/x11cood.c (CoordWinSetCoord, CoordWinUpdate): use
	"struct InfoWin" instead of "struct CoordWin".

2009-04-28  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/gtk_subwin.c (ev_button_down_tree): remove.
	(ev_button_down): don't respond to right button click.
	(ev_button_down): call "tree_update()" when "d->type" is
	"TypeLegendWin".
	(ev_button_up): added.
	(list_sub_window_create, tree_sub_window_create): call back
	function for "button-release-event" is "ev_button_up()".

	* src/gtk/x11view.h (struct FocusObj): change name of the struct
	from "focuslist".
	(struct Point): moved from x11view.c and change name of the struct
	from "pointslist".

	* src/gtk/x11menu.c (SetPoint): show width and height when
	"d->Capture" is TRUE.

2009-04-27  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11menu.c (create_windowmenu): change accel path of
	"View" menu.
	(create_legendmenu): do not gettextize menu title.
	(create_legendsubmenu): gettextize "label".
	(create_legendsubmenu): remove under score from "label" for accel
	path string.

	* src/gtk/gtk_subwin.c (numeric_cb, string_cb): do nothing when
	"d->type" is "TypeLegendWin".

	* src/gtk/x11lgnd.c (LEGEND_WIN_COL_HIDDEN, LEGEND_WIN_COL_PROP)
	(LEGEND_WIN_COL_X, LEGEND_WIN_COL_Y): added.
	(legend_list_set_val): use "case" instead of "strcmp()".
	(enum CHANGE_DIR, pos_edited, pos_x_edited, pos_y_edited): added.
	(CmLegendWindow): call "set_editable_cell_renderer_cb()" for
	"LEGEND_WIN_COL_X" and "LEGEND_WIN_COL_Y".
	(Llist):  colum "x" and "y" is editable.

	* src/gtk/x11file.c (FILE_WIN_COL_HIDDEN, FILE_WIN_COL_FILE)
	(FILE_WIN_COL_X, FILE_WIN_COL_Y): added.
	(file_list_set_val): use "case" instead of "strcmp()".

	* src/gtk/x11axis.c (AXIS_WIN_COL_HIDDEN, AXIS_WIN_COL_NAME)
	(AXIS_WIN_COL_MIN, AXIS_WIN_COL_MAX, AXIS_WIN_COL_INC): added.
	(axis_list_set_val): use "case" instead of "strcmp()".

	* src/gtk/x11merge.c (MERG_WIN_COL_HIDDEN, MERG_WIN_COL_FILE):
	added.
	(merge_list_set_val): use "case" instead of "strcmp()".

	* src/gtk/gtk_liststore.h (tree_store_path_get_string): added.

2009-04-26  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/ox11menu.c (menuinit): free "sdel->description" when
	error is occurred.

	* src/oaxis.c (check_group): added.
	(axisuniqgroup): use "check_group()".

2009-04-25  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11view.c (Focus): check if "man" is valid id.

	* src/gtk/x11commn.c (AxisDel): call "delobj()" after check all
	instances.

	* src/odraw.c (clear_bbox): check if "inst" is NULL.

	* src/oaxis.c (INST_ARRAY_NUM): added.
	(axisdone): change "group" field of other instances belong to the
	same group.
	(get_axis_group_type): initialize "inst_array".

2009-04-24  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11axis.c (enum CHANGE_DIR, pos_edited_common)
	(pos_x_edited, pos_y_edited): added.
	(CmAxisWindow): call "set_editable_cell_renderer_cb()" for
	"AXIS_WIN_COL_X" and "AXIS_WIN_COL_Y".

	* src/gtk/gtk_subwin.c (start_editing): call "UnFocus()".
	(set_cell_renderer_cb): set "list[i].edited_id" when
	"g_signal_connect()" is called for "edited" signal.
	(set_editable_cell_renderer_cb): added.
	(update): call "UnFocus()".

	* src/gtk/gtk_liststore.h: add member "edited_id".

	* src/gtk/gtk_liststore.c (create_tree_view): initialize
	"list[i].edited_id".

	* src/oaxis.c (axisgeometry): clear all bbox of instances belong
	to the group.
	(get_axis_group_type): add argument "check_all".

	* src/gtk/x11menu.c (struct command_data): add member "button",
	(createcommand1, createcommand2): set pointer of the GtkToolItem
	to "cdata->button" when "cdata->button" is not NULL.

	* src/gtk/x11file.c (set_btn_sensitivity_delete_cb)
	(set_btn_sensitivity_insert_cb, set_sensitivity_by_row_num): added.
	(MathDialogSetup, FileMoveDialogSetup, FileMaskDialogSetup): call
	"set_sensitivity_by_row_num()".

2009-04-23  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11file.c (set_btn_sensitivity_cb)
	(set_sensitivity_by_selection): added.
	(MathDialogSetup, FileMoveDialogSetup, FileMaskDialogSetup): call
	"set_sensitivity_by_selection()"

	* src/oshell.c (cmdsecurity): use "set_security()".

	* src/shell.c (set_security, set_environ): added.

	* src/gtk/x11commn.c (LoadNgpFile): check execution of
	"shell::shell" for loding graph is success or not.

	* src/gtk/x11view.c (create_popup_menu): change title of a
	menuitem from "Show cross" to "cross Gauge".
	(ViewerEvKeyDown): change case from " GDK_KP_Space" to "
	GDK_space". remove case for "GDK_BackSpace".

	* src/gtk/x11opt.c (MiscDialogSetupItem): remove codes related to
	widgets visibility.
	(MiscDialogSetup): remove codes related to widgets visibility and
	change order of widgets.
	(MiscDialogClose): remove codes related to
	widgets visibility.

	* src/gtk/x11menu.h (enum MenuID): add "MenuIdToggleStatusBar",
	"MenuIdToggleRuler", "MenuIdToggleScrollbar",
	"MenuIdToggleCToolbar", "MenuIdTogglePToolbar",
	MenuIdToggleCrossGauge", "MenuIdAxisUndo" and "MenuIdFileMath".
	(struct Viewer): add "PToolbar" and "CToolbar", remove
	"ShowCross".

	* src/gtk/x11menu.c (create_filemenu): add menu item for "Math
	Transformation".
	(create_axismenu): add menu item for "Scale Undo".
	(show_win_menu_cb): set active state for "ToggleStatusBar",
	"ToggleRuler", "ToggleScrollbar", "ToggleCToobar", "TogglePToobar"
	and "ToggleCrossGauge".
	(toggle_view_cb): added.
	(create_windowmenu): create some menu items to show and hide
	widgets.
	(create_windowmenu): now the title of this menu is "View".
	(createmenu): reorder menus.
	(create_toolbar): add argument "hbox" and set GtkHandleBox to the
	variable.
	(set_widget_visibility): add argument "cross" and set visibility of
	some other widgets and cross gauge.
	(setupwindow): add argment to call "create_toolbar()".x
	(application): save settings for widgets visibility.

	* src/gtk/x11file.c (CmFileMenu): add case for "MenuIdFileMath".

	* src/gtk/x11dialg.h (struct MiscDialog): remove member "ruler"
	and "statusbar".

	* src/gtk/x11axis.c (CmAxisMenu): add case for "MenuIdAxisUndo".

	* src/gtk/ox11menu.h (struct menulocal): add member "scrollbar",
	"ctoolbar", "show_cross" and "ptoolbar".
	(enum SAVE_CONFIG_TYPE): add "SAVE_CONFIG_TYPE_TOGGLE_VIEW".

	* src/gtk/ox11menu.c (MenuConfigToggleView): added.
	(MenuConfigArrray): add "MenuConfigToggleView".
	(menu_save_config): add codes for "SAVE_CONFIG_TYPE_TOGGLE_VIEW".

	* src/nconfig.c (replaceconfig_match): return "buf" when next
	section was found.
	(replaceconfig): print "buf" after print configurations if "buf"
	is not NULL.

2009-04-22  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11view.c (CmEditMenuCB): add case for
	"MenuIdAlignLeft", "MenuIdAlignVCenter", "MenuIdAlignRight",
	"MenuIdAlignTop", "MenuIdAlignHCenter" and "MenuIdAlignHBottom".

	* src/gtk/x11menu.h (enum MenuID): add "MenuIdAlignLeft",
	"MenuIdAlignVCenter", "MenuIdAlignRight", "MenuIdAlignTop",
	"MenuIdAlignHCenter" and "MenuIdAlignHBottom".

	* src/gtk/x11menu.c (hide_edit_menu_cb, create_alignmenu): added.
	(create_editmenu): call "create_alignmenu()".

	* src/object.h (struct objlist): add member "child".

	* src/object.c (addobject): set "parent->child" if "parent" in not
	NULL.
	(addobject): initialize "objnew->child" as NULL.
	(addobject): change the order of object list.

2009-04-21  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11view.h (ROTATE_CLOCKWISE, ROTATE_COUNTERCLOCKWISE)
	(enum FOCU_OBJ_TYPE): added.

	* src/gtk/x11view.c (enum ViewerPopupIdn): add "VIEW_CUT",
	"VIEW_PASTE" add "VIEW_DUP".
	(CopyFocusedObjects, CutFocusedObjects, check_last_insts)
	(focus_new_insts, paste_cb, PasteObjectsFromClipboard): added.
	(create_popup_menu): add cut, copy and paste menu item.
	(check_focused_obj_type): added.
	(do_popup): use "check_focused_obj_type()".
	(ViewerPopupMenu): add case for "VIEW_CUT", "VIEW_PASTE" add
	"VIEW_DUP".
	(CmEditMenuCB): added.

	* src/gtk/x11menu.h (enum MenuID): add "MenuIdEditCut",
	"MenuIdEditCopy", "MenuIdEditPaste", "MenuIdEditDelete",
	"MenuIdEditRotateCW" and "MenuIdEditRotateCCW".

	* src/gtk/x11menu.c (show_edit_menu_cb, hide_edit_menu_cb)
	(create_editmenu): added.
	(createmenu): call "create_editmenu()".

2009-04-19  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/orect.c (rectrotate, rectmove, rectchange, rectzoom)
	(rectgeometry): use "clear_bbox()".
	(set_position, get_position): added.
	(rectdraw): use "get_position()".
	(rectrotate, rectmove, rectchange, rectzoom): use "set_position()".

	* src/otext.c (textgeometry, textmove, textrotate, textzoom): use
	"clear_bbox()".

	* src/opolygon.c (polygeometry): use "clear_bbox()".

	* src/omerge.c (mergefile, mergemove, mergezoom, mergegeometry):
	use "clear_bbox()".

	* src/omark.c (markmove, markrotate, markzoom, markgeometry): use
	"clear_bbox()".

	* src/oline.c (arrowput): use "clear_bbox()".

	* src/olegend.c (legendgeometry, legendmove, legendrotate)
	(legendchange, legendzoom): use "clear_bbox()".

	* src/ocurve.c (curvegeometry): use "clear_bbox()".

	* src/oaxis.c (axisgeometry, axismove2, axisrotate2)
	(axischange2, axischange, axiszoom2, axisadjust, set_group_pos):
	use "clear_bbox()".

	* src/oarc.c (arcgeometry, arcmove, arcchange, arcrotate)
	(arczoom): use "clear_bbox()".

	* src/odraw.c (clear_bbox): added.

2009-04-17  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/oagrid.c (struct axis_prm, struct axis_pos)
	(struct grid_prm, get_grid_prm, draw_grid_line, draw_background)
	(calc_intersection): added.
	(agriddraw): use "get_grid_prm()", "draw_grid_line()" and
	"draw_background()".

2009-04-16  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11view.c (do_popup): popup item related to change order
	of instances is also sesensitive when the focused instances is
	"merge" object.
	(reorder_object): reorder instances when the focused instance is
	"merge" object.

	* src/oaxis.c (axis_get_box): added.
	(axisbbox2): use "axis_get_box()".
	(axisrotate2, axisrotate): added.
	(axis): add field "rotate".

2009-04-15  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11menu.c (SetPoint): show the value of "s->Angle" when "d->Angle"
	is greater or equal to 0.

	* src/gtk/x11menu.h (struct Viewer): add member "Angle".

	* src/gtk/x11view.c (show_focus_line_arc): add argument "clear"
	and save previous state when "clear" is TRUE.
	(ShowFocusLine): add argument "clear".
	(mouse_move_change): second argument of "ShowFocusLine()" is TRUE
	at the first time to call "ShowFocusLine()".
	(enum ViewerPopupIdn): add "VIEW_ROTATE_CLOCKWISE" and "VIEW_ROTATE_COUNTER_CLOCKWISE".
	(create_popup_menu): added.
	(create_popup_menu): add item "_Rotate".
	(VIEWER_POPUP_ITEM_ROTATE): added.
	(RotateFocusedObj): added.
	(do_popup): set sensitivity of "d->popup_item[VIEWER_POPUP_ITEM_ROTATE]".
	(ViewerPopupMenu): add case for "VIEW_ROTATE_CLOCKWISE" and "VIEW_ROTATE_CONTER_CLOCKWISE"

	* src/orect.c (rectrotate): added.

	* src/otext.c (textrotate): added.
	(text): add field "rotate".

	* src/orect.c (rectrotate): added.
	(rect): add field "rotate".

	* src/opolygon.c (opoly): add field "rotate".

	* src/omark.c (markrotate): added.
	(mark): add field "rotate".

	* src/oline.c (arrow): add field "rotate".

	* src/olegend.c (rotate, legendrotate): added.

	* src/ocurve.c (curve): add field "rotate".

	* src/oarc.c (arcrotate): added.
	(arc): add field "rotate".

2009-04-14  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/ox11menu.c (mxd2p, mxd2px, mxd2py, mxp2d): remove.

	* src/gtk/x11view.c (mxd2p, mxp2d coord_conv_x, coord_conv_y)
	(draw_frame_rect, draw_focus_line): added.
	(GetFocusFrame, ShowFocusFrame, show_focus_line_arc)
	(draw_frame_rect, ShowFocusLine, ShowPoints, ShowFrameRect)
	(ShowCrossGauge, get_mouse_cursor_type): use "coord_conv_x()" and
	"coord_conv_y()".
	(ShowFocusLine): use "draw_frame_rect()" and "draw_focus_line()".

2009-04-13  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11view.c (arc_get_angle, show_focus_line_arc): added.
	(ShowFocusLine): call "show_focus_line_arc()" when focused object
	is "arc".
	(ShowFocusLine): add argument "state".
	(mouse_up_change): check if the focused object is "arc".

	* src/oarc.h: added.

	* src/oarc.c (arcbbox): add points to modify angle.
	(arcchange): added.
	(arc): add "change" field.

	* src/gtk/ogra2cairo.c (gra2cairo_output): do nothing when "a1 ==
	a2" in the case of "code" ic "C".

	* src/gtk/x11commn.c (ToFullPath): use loop to modify "file" field
	of "file" and "merge" object.

2009-04-11  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11view.c (do_popup): check if the focused object is
	child of the "legend" object when "num == 1" .

2009-04-10  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11view.c (ShowPoints): draw arc and rectangle when
	"num" is greater or equal to 2.
	(mouse_move_drag, mouse_move_zoom, mouse_move_change)
	(mouse_move_scroll, mouse_move_draw): added.
	(ViewerEvMouseMove): use "mouse_move_drag()", "mouse_move_zoom()",
	"mouse_move_change()", "mouse_move_scroll()" and
	"mouse_move_draw()".
	(get_mouse_cursor_type): return "GDK_TCROSS" when "d->MoveData" is
	TRUE.

2009-04-09  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11view.c (ShowCrossGauge): don't call
	"gdk_window_get_position()".
	(ViewerEvMouseMotion): call "gdk_event_request_motions()".
	(ViewerWinSetup): set GDK_POINTER_MOTION_HINT_MASK to "d->Win".

2009-04-07  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11scrip.h: remove.

	* src/gtk/x11scrip.c: remove.

	* src/gtk/x11menu.c (script_exec): added.
	(create_addin_menu): use "script_exec()" as callback.

2009-04-06  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11lgnd.c (LegendWinLegendUpdate): remove argument of
	function "UnFocus()".

	* src/gtk/x11view.c (clear_focus_obj): remove unused arguments.
	(UnFocus): remove unused argument "init_cursor".
	(CloseGC, Clear, CmViewerButtonArm, Focus): remove argument of
	function "UnFocus()".

	* src/gtk/x11commn.c (axis_move_each_obj): added.
	(AxisMove): use "axis_move_each_obj()".

	* src/gtk/x11axis.c (AxisWinAxisTop, AxisWinAxisLast)
	(AxisWinAxisUp, AxisWinAxisDown): added.
	(axiswin_ev_key_down): call "AxisWinAxisTop()",
	"AxisWinAxisLast()", "AxisWinAxisUp()" and "AxisWinAxisDown()".
	(Popup_list): set "AxisWinAxisTop()", "AxisWinAxisLast()",
	"AxisWinAxisUp()" and "AxisWinAxisDown()" to related member.

	* src/ofit.c (enum FitError, display_equation): added.
	(fitpoly, fituser, fitfit): use "FitError".
	(fitpoly, fituser): use "snprintf()" instead of "sprintf()".
	(fitpoly, fituser): call "display_equation()".
	(fitpoly, fituser): return "enum FitError".
	(fitfit): change type of "type" from "int" to "enum FIT_OBJ_TYPE".

	* demo/demo2.ngp.in: use "fit::calc" for legend text.

	* src/gtk/x11graph.c (CmGraphHistory, DirectoryDialogClose):
	remove argument of "ErrorMessage()".

	* src/gtk/x11file.c (FitDialogSave): check return value of
	"nopen()".
	(FitDialogSave): call "ErrorMessage()" instead of "MessageBox()".

	* src/gtk/x11commn.c (SaveDrawrable): check return value of
	"nopen()".
	(SaveDrawrable): call "ErrorMessage()" instead of "MessageBox()".
	(SaveDrawrable): return "error" instead of "! error".
	(GraphSave): call "reset_graph_modified()", "changefilename()",
	"AddNgpFileList()" and "SetFileName()" only when success
	"SaveDrawrable()".
	(ErrorMessage): argument of function is now "void".

2009-04-04  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/mathcode.c (mathexpand, calculate): new upstream
	release (6.3.48).

	* driver/gra2ps.c: new upstream release (6.3.48).

	* driver/Ngraph.ps: new upstream release (6.3.48).

2009-04-03  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/ofit.c (fitfit): use loop to initialize values related to
	parameters "%0?" and "parameter0?".
	(fitcalc): added.
	(fit): add member "calc".

	* src/omath.c (mparam): bug fix: fix calculation of "m".
	(struct mlocal): now member "idpm" is array.
	(msettbl): use loop to set value related to "mlocal->idpm[]".
	(minit): use loop to set value to "mlocal->idpm[]".

2009-04-02  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11graph.c (DirectoryDialogSetup): change width of
	"d->dir".

	* src/gtk/ogra2cairo.c (relative_move): added.
	(draw_str, gra2cairo_output): use "relative_move()" instead of
	"cairo_rel_move_to()".

2009-04-01  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11merge.c (Mlist): gettextize.

	* src/gtk/x11file.c (Flist): gettextize.

	* src/gtk/x11axis.c (Alist): gettextize.

	* src/gtk/x11lgnd.c (legend_list_set_val): just set converted text
	to tree view when "type" is "LegendTypeText".
	(Llist): gettextize.
	(Llist): ellipsize mode of "property" column is
	"PANGO_ELLIPSIZE_END".

	* src/gtk/gtk_liststore.c (create_column): add attribute
	"ellipsize" to "renderer".

	* src/gtk/gtk_liststore.h (_list_store): add member "ellipsize".

	* src/ofile.c (search_mask): check if the index "i" of array
	"mask" is lesser than "n".

	* src/gtk/x11graph.c (CmHelpHelp, about_link_activated_cb): use
	"execlp()" instead of "system()".

2009-03-31  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11file.c (FileMoveDialogClose): free "ptr".
	(FileMoveDialogClose): call "set_graph_modified()".

	* src/gtk/x11opt.c (PrefFontDialogUpdate): free "fontalias".

	* src/shell.c (shputstdout, shprintfstdout): check return value of
	"write()".
	(expand, checkcmd, cmdexec): use "n_mkstemp()" instead of
	"tempnam()".

	* src/ioutil.c (n_mkstemp): added.

	* src/ogra2prn.c (mytempfile): added.
	(gra2p_output): use "mytempfile()".

	* src/nconfig.c (replaceconfig_match, removeconfig_match, make_backup): added.
	(replaceconfig): use "replaceconfig_match()" and "make_backup()".
	(removeconfig): use "removeconfig_match()" and "make_backup()".
	(replaceconfig, removeconfig): use "tmpfile()" instead of "tempnam()".
	(lockconfig): call "msleep()" while checking "configlocked()".

2009-03-29  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* driver/gra2wmf.c (getboundingbox): remove unused variable
	"exchange".
	(draw): remove unused variables "lBrush" and "rect".

2009-03-26  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11axis.c (NumDialogSetup): arrange widgets.

	* src/oprm.c (prmload): use "R_OK", "W_OK", "X_OK" for "access()".

	* src/omerge.c (mergeload): use "R_OK", "W_OK", "X_OK" for
	"access()".

	* src/ofile.c (f2dload): use "R_OK", "W_OK", "X_OK" for
	"access()".

	* src/nconfig.c (writecheckconfig): use "R_OK", "W_OK", "X_OK" for
	"access()".

	* src/ioutil.c (findfilename, nsearchpath, nglob2): use "R_OK",
	"W_OK", "X_OK" for "access()".

	* src/ofile.c (f2dload): use "R_OK", "W_OK", "X_OK" for "access()".

	* src/gra.c (GRAC_INIT_VAL): added.
	(GRAClist): use "GRAC_INIT_VAL".
	(get_gra_font): added.
	(GRAinputold): use "get_gra_font()".

	* src/shell.c (shputstderr, shprintfstderr): comment out.

	* src/ogra2.c (gra2disconnect): comment out.

	* src/object.c (vdisplaywindow, unregisterallevloop)
	(chkobjectlocal, chkobjproc, getobjproc, getuniqname): comment
	out.

	* src/nstring.c (getitok3, getitok4): comment out.

	* src/ioutil.c (nselectdir, nselectfile): comment out.

	* src/gra.c (GRAdirect, GRAremark): comment out.

	* src/gtk/ox11dlg.c (dialogclose): remove.

	* src/gtk/ogra2cairo.c (FONT_FACE_NUM): added.
	(check_type): use "FONT_FACE_NUM".

	* src/gtk/ogra2x11.c (gtkevsize): remove.

2009-03-24  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/oprm.c (remarkconv): use "greektable_num()".

	* src/gra.c (greektable_num): added.
	(FONTTBL_NUM): added.
	(GREEK_TBL_NUM): added.
	(GRAinputold): check index of "fonttbl[]".

2009-03-23  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/ox11menu.c (SetCaption, graph_modified_sub): added.
	(set_graph_modified, reset_graph_modified): use
	"graph_modified_sub()".
	(gtkmenu): field "modified" use function "mxmodified".
	(mxmodified): added.

	* src/gtk/x11menu.c (SetCaption): remove.

	* src/ofile.c (f2dload_sub): added.
	(f2dload, f2dloaddum): use "f2dload_sub()".

	* src/gtk/x11file.c (FileDialogSetupItemCommon,start_editing): use
	"CHK_STR()".

	* src/gtk/x11axis.c (AxisDialogSetup, AxisCB)
	(AxisDialogSetupItem, AxisPosDialogSetupItem): use "CHK_STR()".

	* src/gtk/x11print.c (DriverDialogSelectCB): use "CHK_STR()".

	* src/gtk/ox11dlg.c (dlgconfirm): use "CHK_STR()".

	* src/oaxis.c (axisautoscale): return 0 even if the return value
	of axisautoscalefile() is not 0.

2009-03-20  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11print.c (OutputImageDialogSetupItem): sensitivity of
	dpi settings is FALSE for ps and pdf output.

2009-03-18  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11view.c (ViewerWinFileUpdate): use "update_file_obj_multi()".

	* src/gtk/x11file.c (update_file_obj_multi): added.
	(CmFileUpdate, CmFileOpen): use "update_file_obj_multi()".

2009-03-17  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/ox11dlg.c (get_sarray_argument): accept multi "sarray"s.

2009-03-12  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11menu.h (struct NgraphApp): remove member "Message3".

	* src/gtk/x11view.c (init_zoom, mouse_up_zoom)
	(ViewerEvMouseMove): remove "SetZoom()" or "ResetZoom()".
	(mouse_up_zoom): set coordinate of a mouse to "d->MouseX2" and
	"d->MouseY2".
	(ViewerEvLButtonUp): call "SetPoint()" after call "SetCursor()".

	* src/gtk/x11print.c (CmOutputDriver): call "ResetStatusBar()".

	* src/gtk/x11menu.c (SetZoom, ResetZoom): remove.

2009-03-11  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11menu.c (tool_button_enter_leave_cb): use
	"SetStatusBarSub()" instead of "SetStatusBarXm()".
	(SetStatusBarXm): remove.
	(ResetZoom, SetZoom, ResetStatusBar): use "SetStatusBarSub()" or
	"ResetStatusBarSub()".
	(SetStatusBarSub, ResetStatusBarSub): added.

	* src/gtk/ox11menu.c (mgtkdisplaystatus): use "DisplayDialog()"
	instead of "DisplayStatus()".

	* src/gtk/x11graph.c (CmGraphNewFrame, CmGraphNewSection)
	(CmGraphNewCross, CmGraphAllClear): remove.
	(CmGraphNewMenu): clear graph and set NULL to
	"NgraphApp.FileName". call "reset_graph_modified()".

	* src/gtk/x11view.c (ViewerWinSetup): use "value-changed" signal
	instead of "change-value" signal for "d->HScroll" and
	"d->VScroll".
	(ViewerEvVScroll, ViewerEvHScroll): change return value and
	argument. don't call "gdk_window_get_position()",
	"gdk_draw_drawable()", "gdk_drawable_get_size()", "gdk_gc_new()"
	and "g_object_unre()".
	(scrollbar_scroll_cb, ViewerEvMouseMove, ViewerEvScroll)
	(ViewerEvKeyDown): don't call "ViewerEvVScroll()" or
	"ViewerEvHScroll()" after call "range_increment()".
	(SetHRuler, SetVRuler): change argument. get size of drawable
	widget inside the function.

2009-03-10  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/gtk_liststore.c (create_column): set user data with
	"g_object_set_data()" instead of "g_object_set()".

	* src/gtk/x11file.c (start_editing_type, start_editing): remove
	unused variable "list".

	* src/gtk/x11axis.c (start_editing): remove unused variable
	"list".

	* src/gtk/gtk_widget.c (spin_entry_set_range)
	(spin_entry_set_inc, spin_entry_set_val, spin_entry_get_val)
	(_create_spin_entry): use "g_object_[gs]et_data()" instead of
	"gtk_object_[gs]et_user_data()".

	* src/gtk/gtk_subwin.c (numeric_cb, string_cb, start_editing): use
	"g_object_[gs]et_data()" instead of
	"gtk_object_[gs]et_user_data()".

	* src/gtk/x11lgndx.c (LegendGaussDialogSetup): use
	"gtk_widget_set_size_request()" instead of
	"gtk_drawing_area_size()".

	* src/gtk/x11opt.c (add_str_to_array): remove.

	* src/gtk/x11lgnd.c (CmOptionTextDef): save and restore modified
	state.

	* src/gtk/x11file.c (CmOptionFileDef): save and restore modified
	state.

	* src/ofile.c (f2dstore): use "nstrdup()" instead of "memalloc()"
	to create string "[EOF]\n".
	(f2dstat, f2dstat2): use "nstrdup()" instead of "memalloc()".

	* src/osystem.c (sysinit): use "nstrdup()" instead of "memalloc()"
	to create string "./".

	* src/ofit.c (fitfit): use "nstrdup()" instead of "memalloc()" to
	create string "equation".

	* src/ntime.c (ndate, ntime): use "nstrdup()" instead of
	"memalloc()".

	* src/nconfig.c (removeconfig): free "buf" when "change" is FALSE.

	* src/ioutil.c (fgetline): set NULL to "*buf" when EOF or error.

2009-03-09  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/ox11menu.c (enum menu_config_type): add
	"MENU_CONFIG_TYPE_CHILD_WINDOW", "MENU_CONFIG_TYPE_HISTORY",
	"MENU_CONFIG_TYPE_COLOR", "MENU_CONFIG_TYPE_SCRIPT" and
	"MENU_CONFIG_TYPE_DRIVER".
	(struct child_win_stat, MenuConfigDriver, MenuConfigScript)
	(MenuConfigMisc, MenuConfigViewer, MenuConfigGeometry)
	(MenuConfigChildGeometry, MenuConfigArrray, BUF_SIZE)
	(add_str_with_int_to_array, add_child_geometry_to_array)
	(add_geometry_to_array, add_color_to_array)
	(add_prm_str_to_array, save_ext_driver_config)
	(save_script_config, add_str_to_array, menu_save_config_sub)
	(menu_save_config): added.
	(menu_config_set_child_window_geometry): use "struct child_win_stat *"
	(addmenu): initialize "MenuConfigHash" with "MenuConfigArrray".

	* src/gtk/ox11menu.h (enum SAVE_CONFIG_TYPE)
	(SAVE_CONFIG_TYPE_X11MENU): added.

	* src/gtk/x11opt.c (CHK_STR, save_font_config, save_misc_config)
	(save_script_config, save_ext_driver_config, save_viewer_config)
	(save_child_geometory_config, add_geometry_to_array)
	(save_geometory_config, add_prm_str_to_array)
	(SAVE_CONFIG_TYPE_X11MENU, SAVE_CONFIG_TYPE): remove.
	(save_config): use "menu_save_config()" and
	"gra2cairo_save_config()".

	* src/nstring.h (CHK_STR): add

	* src/gtk/ogra2cairo.c (gra2cairo_save_config): added.

	* src/oaxis.c (enum axis_config_type): remove.
	(axisloadconfig): use "obj_load_config()".

	* src/otext.c (TextConfig): added.
	(textloadconfig): use "obj_load_config()".
	(textsaveconfig): use "obj_save_config()".
	(addtext): initialize "TextConfigHash".

	* src/ofile.c (f2dinit): use "nstrdup()" instead of "memalloc()".
	(f2dinit): free "s3" and "s4" when error is occurred.
	(f2dsaveconfig): use "obj_save_config()".
	(f2dloadconfig): use "obj_load_config()".
	(enum file_config_type, struct file_config): remove.

	* src/oaxis.c (axisinit): use "nstrdup()" instead of "memalloc()".

2009-03-06  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11commn.c (LoadPrmFile, LoadNgpFile): call
	"reset_graph_modified()".

	* src/gtk/x11view.c (graph_dropped): don't call
	"reset_graph_modified()".

	* src/gtk/x11graph.c (CmGraphLoad): don't call
	"reset_graph_modified()".

	* src/omerge.c (mergestore): bug fix: buffer over run. use
	"nstrdup()" instead of "memalloc()".

	* src/gtk/gtk_liststore.c (create_tree_view): header of the tree
	view is visible when "n" greater than 1.
	(list_store_set_sort_all, list_store_set_sort_column): header of
	the tree view is always visible.

	* src/gtk/x11view.c (struct viewer_popup): add member "type".
	(create_menu): create GtkCheckMenuItem when "popup[i].type" is
	"POP_UP_MENU_ITEM_TYPE_CHECK".
	(do_popup): set active state of the menu item when i is
	"POPUP_ITEM_HIDE".
	(ViewCross): add argument "dtate".

	* src/gtk/x11merge.c (Popup_list): add initial data for member
	"type".
	(POPUP_ITEM_HIDE): add
	(MergeWinExpose): set active state of the menu item when i is
	"POPUP_ITEM_HIDE".

	* src/gtk/x11menu.h (enum pop_up_menu_item_type): added.

	* src/gtk/x11lgnd.c (Popup_list): add initial data for member
	"type".
	(POPUP_ITEM_HIDE): add
	(LegendWinExpose): set active state of the menu item when i is
	"POPUP_ITEM_HIDE".

	* src/gtk/x11file.c (Popup_list): add initial data for member
	"type".
	(POPUP_ITEM_HIDE): add
	(popup_show_cb): set active state of the menu item when i is
	"POPUP_ITEM_HIDE".

	* src/gtk/x11axis.c (Popup_list): add initial data for member
	"type".
	(POPUP_ITEM_HIDE): added.
	(popup_show_cb): set active state of the menu item when i is
	"POPUP_ITEM_HIDE".

	* src/gtk/gtk_subwin.h (struct subwin_popup_list): add member "type".

	* src/gtk/gtk_subwin.c (tree_set_hidden_state, set_hidden_state):
	added.
	(list_sub_window_hide): use "set_hidden_state()".
	(tree_sub_window_hide): use "tree_set_hidden_state()"
	(sub_win_create_popup_menu): create GtkCheckMenuItem when
	"list[i].type" is "POP_UP_MENU_ITEM_TYPE_CHECK".

	* src/gtk/ox11menu.c (reset_graph_modified, set_graph_modified):
	call "SetCaption()".

	* src/gtk/x11menu.c (SetCaption): no argument. use "ngp" field of
	"menu" object for file name of the window title.

	* src/gtk/x11commn.c (LoadPrmFile, LoadNgpFile, GraphSave): don't
	call "SetCaption()".

2009-03-05  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11menu.c (SetPoint): add argument "struct Viewer *d".
	(SetPoint): show parameter when change, zoom or drag object.
	(change_window_state_cb): remove.

2009-03-04  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/ogra2x11.c (gtkloadconfig): print warning when unused
	parameter is appeared.

	* src/otext.c (textloadconfig): print warning when unused
	parameter is appeared.

	* src/gtk/ogra2cairo.c (loadconfig): print warning when unused
	parameter is appeared.

	* src/ofile.c (f2dloadconfig): print warning when unused
	parameter is appeared.

	* src/gtk/ox11menu.c (mgtkloadconfig): print warning when unused
	parameter is appeared.

	* src/oaxis.c (axisloadconfig): print warning when unused
	parameter is appeared.

	* src/gtk/x11dialg.h (struct ViewerDialog): remove unused member
	"redraw".

	* src/gtk/ox11menu.h (struct menulocal): remove unused member
	"autoredraw".

	* src/gtk/x11opt.c (ViewerDialogSetupItem, ViewerDialogClose)
	(ViewerDialogSetup, save_viewer_config): remove codes related to
	"Menulocal.autoredraw".

	* src/gtk/ox11menu.c (mxautoredraw): remove.
	(MenuConfig, menuinit, gtkmenu): remove codes related to
	"Menulocal.autoredraw".

	* src/gtk/x11opt.c (enum SAVE_CONFIG_TYPE)
	(SAVE_CONFIG_TYPE_X11MENU, save_config): added.
	(DefaultDialogClose): use "save_config()" to save configuration.
	(PrefScriptDialogSetup, PrefDriverDialogSetup)
	(PrefFontDialogSetup, MiscDialogSetup, ExViewerDialogSetup)
	(ViewerDialogSetup): add a save button.
	(PrefScriptDialogClose, PrefDriverDialogClose)
	(PrefFontDialogClose, MiscDialogClose, ExViewerDialogClose)
	(ViewerDialogClose): save configuration if the save button is
	clicked.

2009-03-03  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11opt.c (save_viewer_config, save_misc_config)
	(MiscDialogSetupItem, MiscDialogSetup, MiscDialogClose)
	(ViewerDialogSetupItem, ViewerDialogSetup, ViewerDialogClose):
	settings for status-bar and ruler are moved from viewer dialog to
	misc dialog, and setting for line attribute of focus frame is
	moved from misc dialog to viewer dialog

2009-02-28  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/object.c (_newobj, _delobj): static.

2009-02-26  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11view.c (ViewerEvMouseMove): don't call
	"CoordWinSetCoord()".

	* src/gtk/x11menu.c (SetPoint): call "CoordWinSetCoord()".

	* src/gtk/ox11menu.c (set_menu_config_mxlocal): remove.
	(gtkmenu): remove field "_gtklocal".
	(mx_clear): call "draw_paper_frame()" after call
	"gdk_draw_rectangle()".
	(menuinit): unref "Menulocal.pix" if "Menulocal.pix" is not NULL.
	(menu_config_set_prn_driver): remove.

	* src/gtk/ox11menu.h (struct menulocal): remove unused member
	"output", "outputobh", "prnprinterroot".
	(struct mxlocal): remove mxlocal and use menulocal.
	(struct prnprinter): remove.

	* src/gtk/x11opt.c (save_viewer_config, ViewerDialogSetupItem)
	(ViewerDialogSetup, ViewerDialogClose): add codes related to
	status bar.

	* src/gtk/x11menu.c (toggle_status_bar): remove.
	(show_outputmenu_cb): added.
	(create_outputmenu): call "g_signal_connect()" for "Output" menu.
	(show_winmwnu_cb, create_windowmenu): remove codes related to
	status bar.
	(SetPoint): add offset to coordinate.

	* src/gtk/x11opt_proto.h (Pref*DialogMoveSub): added.
	(Pref*DialogUp, Pref*DialogUp): use Pref*DialogMoveSub.
	(Pref*ListDefailtCb): respond to "GDK_Up", "GDK_Down" and
	"GDK_Delete".

2009-02-25  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11view.c (ViewerEvLButtonDblClk): use
	"POINT_TYPE_DRAW_ALL".

	* src/gtk/x11menu.h (POINT_TYPE_DRAW_ALL): add

	* src/gtk/x11opt.c (script_free, script_init, extprinter_free)
	(extprinter_init): added.
	(PrefScriptDialogUpdate, PrefScriptDialogRemove)
	(PrefScriptDialogAdd, PrefScriptDialogUp, PrefScriptDialogDown)
	(script_list_defailt_cb, script_list_sel_cb)
	(PrefDriverDialogUpdate, PrefDriverDialogRemove)
	(driver_list_defailt_cb, driver_list_sel_cb)
	(PrefDriverDialogAdd, PrefDriverDialogUp, PrefDriverDialogDown)
	(PrefFontDialogUp, PrefFontDialogDown, font_list_defailt_cb)
	(font_list_sel_cb) : remove (use "x11opt_proto.h").
	(PrefScriptDialogSetupItem, PrefDriverDialogSetupItem): remove
	unused argument.

	* src/gtk/ogra2cairo.c (free_font_map, create_font_map): remove
	codes related to "fcur->prev" and so on.

	* src/gtk/ogra2cairo.h (struct fontmap): remove member "prev".

	* src/gtk/Makefile.am (libngraph_la_SOURCES): add
	"x11opt_proto.h".

2009-02-24  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11opt.c (PrefScriptDialogUp, PrefScriptDialogDown)
	(PrefDriverDialogUp, PrefDriverDialogDown, PrefFontDialogUp)
	(PrefFontDialogDown): add
	(scriptlist_sel_cb, drvlist_sel_cb, fontlist_sel_cb): set
	sensitivity of "d->up_b" and "d->down_b".
	(PrefScriptDialogSetup, PrefDriverDialogSetup)
	(PrefFontDialogSetup): create GtkButton "d->up_b" and "d->down_b".

	* src/gtk/x11view.c (ShowPoints, mouse_up_lgend2): use
	"POINT_TYPE_DRAW1".
	(ViewerEvLButtonUp): use "POINT_TYPE_POINT".
	(ViewerEvMouseMove): use "POINT_TYPE_TRIM", "POINT_TYPE_POINT",
	"POINT_TYPE_DRAW1" and "POINT_TYPE_DRAW2".
	(ViewerEvKeyDown): use "POINT_TYPE_POINT".
	(ViewCopy): use "POINT_TYPE_POINT".
	(ShowPoints): use "POINT_TYPE_DRAW1".
	(mouse_up_lgend2): use "POINT_TYPE_DRAW1".
	(ViewerEvMouseMove, ViewerEvPaint): use "Mxlocal->gc" instead of
	newly created GdkGC.

	* src/gtk/x11menu.h (POINT_TYPE_POINT, POINT_TYPE_DRAW1)
	(POINT_TYPE_DRAW2, POINT_TYPE_TRIM): added.

	* src/gtk/x11menu.c (SetCursor): do nothing when "type" is same as
	"CursorType".

	* src/gtk/ox11menu.c (mx_clear): turn off clipping after draw
	pixmap.

	* src/gtk/ogra2x11.c (gtkevpaint): turn off clipping after draw
	pixmap.

2009-02-23  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/ox11menu.c (mx_redraw): call "draw_paper_frame()" after
	call "GRAredraw()".
	(check_object_name): added.
	(mx_get_focused): use "check_object_name()" to check the object is
	exist in the argument.
	(gtkmenu): argument type of "focused" is "sa".

	* src/gtk/x11menu.h (struct Viewer): add member "VRuler" and
	"HRuler".

	* src/gtk/x11opt.c (ViewerDialogClose): call
	"set_widget_visibility()".

	* src/gtk/x11menu.c (setupwindow): create GtkHRuler and GtkVRuler.
	(SetPoint): set position of "NgraphApp.Viewer.HRuler" and
	"NgraphApp.Viewer.VRuler".
	(set_widget_visibility): added.
	(application): call "set_widget_visibility()" after call
	"gtk_widget_show_all()".

	* src/gtk/x11view.c (MakeRuler): remove.
	(SetVRuler, SetHRuler): added.
	(ChangeDPI): call "SetHRuler()" and "SetVRuler()".
	(ViewerEvHScroll): call "SetVRuler()".
	(ViewerEvVScroll): call "SetHRuler()".
	(draw_paper_frame): added.
	(Draw, create_pix): call "draw_paper_frame()".
	(ViewerWinSetup): call "ChangeDPI" after initialize "d->cx",
	"d->cy", "d->hscroll" and "d->vscroll".
	(ViewerEvPaint): don't call "MakeRuler()".

	* src/gtk/main.c (my_sprintf): don't change "buf_size" when the
	return value of "realloc()" is NULL.

2009-02-20  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11view.c (ViewerEvPaint): call "gdk_draw_drawable()"
	even if "GlobalLock" is TRUE.
	(ViewerEvPaint): don't check "chkobjinstoid(Menulocal.GRAobj,
	Menulocal.GRAoid)".

	* demo/demo.ngp: use dialog::check

	* src/gtk/ox11dlg.c (get_sarray_argument): added.
	(dlgradio, dlgcombo, dlgcheck): use "get_sarray_argument()".

	* src/object.c (saveobj, restoreobj): remove.
	(_copyobj): static function.

	* src/shellcm.c (cmput): never save and restore image of instance.

2009-02-19  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/ox11dlg.c (dlgradio, dlgcombo, dlgcheck): return 1 when
	no arguments are given.

	* src/shell.c (cmdstackfree): call "memfree(stdel->pat)".
	(cmdstackcat): initialize "stnew->pat".
	(cmdstackrmlast): call "memfree(stdel->pat)".
	(cmdexec): set NULL to "st->pat" if "st->pat" will not be used any
	more.

	* src/gtk/x11opt.c (PrefScriptDialogRemove): call
	"memfree(sdel->description)".

	* src/gtk/ox11menu.c (menudone): call "memfree(sdel->description)".
	(mx_get_focused): use "arrayfree2()" instead
	of "memfree()" to free "*rval".

	* src/gtk/ox11dlg.c (dlggetopenfiles): use "arrayfree2()" instead
	of "memfree()" to free "*rval".

	* src/oaxis.c (axisbbox): set NULL to "rval" when return value of
	"set_axis_box()" is NULL.

	* src/otext.c (textbbox): set NULL to "rval" after call "arrayfree()".

	* src/orect.c (rectbbox):  set NULL to "rval" after call "arrayfree()".

	* src/olegend.c (legendbbox):  set NULL to "rval" after call "arrayfree()".

	* src/omerge.c (mergebbox):  set NULL to "rval" after call "arrayfree()".

	* src/omark.c (markbbox):  set NULL to "rval" after call "arrayfree()".

	* src/oline.c (arrowbbox):  set NULL to "rval" after call "arrayfree()".

	* src/ofile.c (f2dgetcoord):  set NULL to "rval" after call "arrayfree()".

	* src/ocurve.c (curvebbox):  set NULL to "rval" after call "arrayfree()".

	* src/oarc.c (arcbbox):  set NULL to "rval" after call "arrayfree()".

2009-02-18  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/ox11dlg.c (dlgcombo_entry): remove.
	(dlgradio, dlgcombo, dlgcheck): check "select" field.
	(dlgcheck): now "check" field return array of selected index.
	(dialog): add field "select".

	* src/gtk/x11gui.c (DialogRadio): initialize state of toggle
	button by the value of "*r".
	(DialogCombo, DialogComboEntry): add argument "sel" and activate
	item related to "sel".
	(DialogCheck): change type of argument from "int **r" to "int *r".
	(DialogCheck): initialize state of toggle button by the value of
	"r[i]".

	* src/gtk/ox11menu.c (mx_get_focused): return 0 when "num" is less
	than 1.
	(mx_echo): added.
	(gtkmenu): add field "echo".

2009-02-17  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/ofile.c (f2ddraw): do "fp->datanum = f2dlocal->num" after
	call "fitout()" when "fp->datanum" is zero.

	* src/gtk/x11opt.c (CHK_STR): added.
	(save_ext_driver_config, save_script_config)
	(SetScriptDialogSetupItem, SetDriverDialogSetupItem): use
	"CHK_STR"
	(PrefScriptDialogAdd): initialize "fnew->description".

2009-02-16  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11scrip.c (ScriptDialog, ScriptDialogClose)
	(ScriptDialogSetup, script_list_default_cb)
	(ScriptDialogSetupItem): remove.
	(CmScriptExec): add arguments "GtkWidget *w" and "gpointer
	client_data".
	(CmScriptExec): don't use  "ScriptDialog".

	* src/gtk/x11opt.c (save_script_config): save description of the
	script.
	(SetScriptDialogSetup): change title from "Script:" to "Script
	file".
	(SetScriptDialogSetup): add widgets for script description.
	(set_scrpt_option): added.
	(SetScriptDialogClose): use "set_scrpt_option()".
	(SetScriptDialogClose): save description of the script.
	(PrefScriptDialogSetup): add column for file name and script
	description.
	(PrefScriptDialogSetupItem): set file name and script description.
	(PrefScriptDialogClose): call "update_addin_menu()".

	* src/gtk/x11menu.h (enum MenuID): remove "MenuIdScriptExec".

	* src/gtk/x11menu.c: add global variable "AddinMenu".
	(show_graphmwnu_cb): set sensitivity of "AddinMenu".
	(create_addin_menu, update_addin_menu): added.
	(create_graphmenu): now "Add-In" menu has sub menu.

	* src/gtk/x11graph.c (CmGraphMenu): remove case for
	"MenuIdScriptExec".

	* src/gtk/x11dialg.h (struct ScriptDialog): remove.
	(struct SetScriptDialog): add member "description".

	* src/gtk/x11dialg.c: remove unused variable "DlgScript".

	* src/gtk/ox11menu.h (struct script): add member "description".

	* src/gtk/ox11menu.c (menu_config_set_script): set description.

	* initfile/Ngraph.ini.in (script): change format (add description
	column).

2009-02-13  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/object.c (error22): now the type of the argument "mes1" and
	"mes2" are "const char *".
	(error2): now the type of the argument "mes" is "const char *".

	* initfile/Ngraph.ini.in (num_script_size): fix
	typo (from "num_scriptsize" to "num_script_size").

	* src/gtk/x11dialg.c (SetObjPointsFromText): check field of the
	instance is modified or not after call "sgetobjfield()".
	(chk_sputobjfield): added.
	(SetObjFieldFromText, SetObjFieldFromStyle)
	(SetObjFieldFromFontList, SetObjAxisFieldFromWidget): use
	"chk_sputobjfield()".

	* src/gtk/gtk_subwin.c (modify_numeric): check field of the
	instance is modified or not after call "getobj()".
	(modify_string): use "chk_sputobjfield()".

2009-02-12  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11axis.c (axiswin_delete_axis)
	(axis_delete_popup_func, axiswin_ev_key_down): added.
	(CmAxisWindow): initialize "d->ev_key".
	(Popup_list): "axis_delete_popup_func()" is called when delete
	menu is activated.

	* src/oaxis.c (check_direction): also check position of axises.

	* src/gtk/x11axis.c (Alist): "length" column accept negative
	value.

2009-02-11  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/oaxis.c (axischange): check length of axis instead of
	position.
	(FIND_X, FIND_Y, FIND_U, FIND_R, FIND_FRAME, FIND_CROSS)
	(CHECK_FRAME, CHECK_CROSS): added.
	(get_axis_group_type): use "FIND_X", "FIND_Y", "FIND_U", "FIND_R",
	"CHECK_FRAME" and "CHECK_CROSS".
	(axis_save_groupe): added.
	(axissave): use "axis_save_groupe()" and "get_axis_group_type()".
	(struct axis_config, AxisConfig, enum axis_config_type): added.
	(addaxis): initialize "AxisConfigHash".
	(axisloadconfig): use "AxisConfigHash".

2009-02-10  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11commn.c (GraphSave): "overwrite" is FALSE when
	"initfil" is NULL.
	(GraphSave): check overwrite before show save dialog.

	* src/gtk/x11axis.c (SectionDialogSetup, CrossDialogSetup)
	(AxisPosDialogSetup): type of spin buttons for width, height and
	length are "SPIN_BUTTON_TYPE_POSITION".

	* src/oaxis.c (get_axis_group_type, get_axis_box, set_axis_box):
	added.
	(axisbbox): use "get_axis_group_type()", "get_axis_box()" and
	"set_axis_box()".
	(axismatch, axismove, axischange, axiszoom): use
	"get_axis_group_type()".
	(axis_change_point0, axis_change_point1, axis_change_point2)
	(axis_change_point3): added.
	(axischange): use "axis_change_point0()", "axis_change_point1()",
	"axis_change_point2()" and "axis_change_point3()".
	(check_direction): added.
	(axisbbox, axischange): call "check_direction()" to check
	direction of axises.

2009-02-09  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/oaxis.c (axissave, axisbbox, axismatch, axismove)
	(axischange, axiszoom, axisadjust, axisautoscalefile)
	(axisdraw): add initialization to avoid compile warnings.
	(axisautoscalefile): set "set" as TRUE when "set" is FALSE.
	(axisgrouping): check "data[0]".
	(set_group, set_group_pos): added.
	(axisgrouping): use "set_group()".
	(axisgrouppos): use "set_group_pos()".
	(axis_default, axis_default_set, axis_default_set_ref)
	(axis_default_set_adj): added.
	(axisdefgrouping): use "axis_default()", "axis_default_set_adj()"
	and "axis_default_set_ref()".
	(enum AXIS_TYPE, enum AXIS_GAUGE, enum AXIS_NUM_POS)
	(enum AXIS_NUM_ALIGN, enum AXIS_NUM_DIR): added.

	* src/omath.c (mformula): use "mathcode_error()".

	* src/ofit.c (fitput): use "mathcode_error()".

	* src/omath.c (addmath): initialize "MathErrorCodeArray".

	* src/ofit.c (addfit): initialize "MathErrorCodeArray".

	* src/ofile.c (f2dloadconfig2): remove.
	(mathcode_error): remove.
	(addfile): initialize "MathErrorCodeArray".

	* src/mathcode.c (mathcode_error): added.

2009-02-06  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11opt.c (add_prm_str_to_array): added.
	(save_misc_config): use "add_prm_str_to_array()".
	(save_misc_config): save "coordwin_font".
	(DefaultDialogClose): call "add_str_to_array()" when
	"Menulocal.coordwin_font" is NULL.
	(MiscDialogSetupItem): set font name to "d->coordwin_font" if
	"Menulocal.coordwin_font" is not NULL.
	(MiscDialogSetup): create widgets for "Menulocal.coordwin_font".
	(MiscDialogClose): set selected font to "Menulocal.coordwin_font"
	and call "CoordWinSetFont()".

	* src/gtk/x11dialg.h (struct MiscDialog): add member
	"coordwin_font".

	* src/gtk/x11cood.c (CoordWinSetFont): added.
	(CoordWinDrawTex): remove.
	(CoordWinSetCoord): call "gtk_label_set_text()" instead of
	"CoordWinSetCoord()".
	(CoordWinSetCoord): change format strings for "x" and "y" from
	"%.2f" to "%6.2f".
	(CoordWinSetCoord): change format strings for axis id from "%d" to
	"%2d".
	(CoordWinUpdate): call "label_sub_window_create()" instead of
	"text_sub_window_create()".

	* src/gtk/ox11menu.c (MenuConfig): add data for "coordwin_font".
	(menuinit): initialize "Menulocal.coordwin_font".

	* src/gtk/ox11menu.h (struct menulocal): add member
	"coordwin_font".

	* src/gtk/gtk_subwin.c (sub_window_create): add argument
	"with_view_port".
	(sub_window_create): use "gtk_scrolled_window_add_with_viewport()"
	when "with_view_port" is TRUE.
	(label_sub_window_create): added.

	* src/omath.c (mformula): use "switch" to check "rcode".

	* src/ofile.c (mathcode_error): added.
	(f2dputmath, fitout): use "mathcode_error()".

	* src/gtk/x11gui.c (DialogExecute): call "gtk_widget_grab_focus()"
	when "data->focus" is not NULL.
	(DialogExecute): call "gtk_widget_show_all()" outside of the loop.
	(DialogExecute): check "data->show_buttons "outside of the loop.

	* src/gtk/x11lgnd.c (LegendTextDialogSetup): set poniter of the
	widget as "d->focus" instead of call "gtk_widget_grab_focus()".

	* src/gtk/x11graph.c (SaveDialogSetup): set poniter of the widget
	as "d->focus" instead of call "gtk_widget_grab_focus()".

	* src/gtk/x11file.c (MarkDialogSetup): set poniter of the widget
	as "d->focus" instead of call "gtk_widget_grab_focus()".

	* src/gtk/x11dialg.c (initdialog): initialize member "focus" of
	each instance of struct.

	* src/gtk/x11dialg.h (struct DialogType): add member "focus" to
	dialog related struct.

2009-02-05  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/oagrid.c (agriddraw): bug fix: fix calculation of coordinate
	when "axdir" or "aydir" is 3.
	(agriddraw): adjust "dirx" and "diry" as these value is greater or
	equal to zero and less than 36000.

	* src/oaxis.c (axisdirection): added.
	(axis): "axisdirection()" is called when field "direction" is
	changed.

	* src/odraw.h (enum INTERPOLATION_TYPE): added.

	* src/mathcode.c (mathcode): return value type of "mathcode()" is
	"enum MATH_CODE_ERROR_NO".

	* src/gtk/x11graph.c (DirectoryDialogClose, CmGraphHistory): call
	"ErrorMessage()" when "chdir()" returns non zero value.

	* src/gtk/x11commn.c (ErrorMessage): added.

	* src/gtk/x11file.c (FitDialogSetSensitivity): use "FIT_OBJ_TYPE".
	(enum MATH_FNC_TYPE): added.
	(MathTextDialogSetup, MathTextDialogClose): use "MATH_FNC_TYPE".
	(FitDialogSetSensitivity): use "FIT_OBJ_TYPE".
	(FileDialogFit, FileDialogType, draw_type_pixbuf, select_type)
	(start_editing_type, f2dsettings): use "FILE_OBJ_PLOT_TYPE".

	* src/ofit.c (fitpoly, fitfit): use "FIT_OBJ_TYPE".

	* src/ofit.h: added.

	* src/ofile.c (f2ddraw): do "fp->datanum = f2dlocal->num" after
	call "fitout()" when "redraw" is true.
	(opendata, rectout, errorbarout, stairout, barout, f2ddraw): use
	"FILE_OBJ_PLOT_TYPE".
	(curveout, curveoutfile, f2dsettings): use "INTERPOLATION_TYPE".

	* src/ofile.h (enum FILE_OBJ_PLOT_TYPE): add

2009-02-04  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* driver/Makefile.am (ngp2, dir_defs.h): depend on Makefile.

	* src/gtk/Makefile.am (dir_defs.h): depend on Makefile.

	* src/gtk/ogra2cairo.c (loadfont): remove unused variables "lang"
	and "lang_ja".
	(gra2cairo_get_fontmap_num): added.

	* src/gtk/x11opt.c (save_font_config, save_ext_viewer_config)
	(save_misc_config, save_script_config, save_ext_driver_config)
	(save_viewer_config, save_child_geometory_config)
	(save_geometory_config, add_str_to_array)
	(add_str_with_int_to_array, add_geometry_to_array): added.
	(DefaultDialogClose): use "add_str_to_array()",
	"save_geometory_config()" and so on.
	(scriptlist_sel_cb, drvlist_sel_cb, fontlist_sel_cb): added.
	(PrefScriptDialogSetup, PrefDriverDialogSetup)
	(PrefFontDialogSetup): set signal handler to GtkTreeSelection for
	"changed" signal.
	(get_font_alias): added.
	(set_font_from_font_selection_dialog): use "get_font_alias()".
	(PrefFontDialogAdd): use "get_font_alias()" and
	"gra2cairo_get_fontmap()" to check if "alias" is valid string.

	* src/gtk/x11dialg.h (struct PrefScriptDialog)
	(struct PrefDriverDialog, struct PrefFontDialog): add member
	"update_b" and "del_b".

	* src/gtk/gtk_liststore.c (list_store_set_string)
	(list_store_path_set_string, tree_store_set_string): type of
	argument "v" is "const char *".

2009-02-03  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11opt.c (DefaultDialogSetup): add "Font aliases"
	button.
	(DefaultDialogClose): add codes for save font map.
	(PrefFontDialogSetupItem, create_font_selection_dialog)
	(set_font_from_font_selection_dialog, PrefFontDialogUpdate)
	(PrefFontDialogRemove, PrefFontDialogAdd, font_list_defailt_cb)
	(PrefFontDialogSetup, PrefFontDialogClose, PrefFontDialog)
	(CmOptionPrefFont): added.
	(CmOptionMenu): add case for "MenuIdOptionPrefFont".

	* src/gtk/x11menu.h (enum MenuID): add "MenuIdOptionPrefFont".

	* src/gtk/x11menu.c (create_preferencemenu): add menu item "Font
	aliases".

	* src/gtk/x11dialg.h (struct PrefFontDialog): added.

	* src/gtk/x11dialg.c: add global variable "DlgPrefFont".

	* src/gtk/ogra2cairo.c (FontFaceStr, gra2cairo_get_fontmap)
	(gra2cairo_remove_fontmap, gra2cairo_add_fontmap, free_fonts)
	(gra2cairo_update_fontmap, check_type): added.
	(init_conf, free_conf): use "free_fonts()".
	(loadconfig): remove unused variable "fcur".
	(init_conf): use "FontFaceStr".

	* src/gtk/ogra2cairo.h (struct gra2cairo_local): remove unused
	member "font_opt".

2009-01-29  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11view.c (create_legendx): use "swapint()".

2009-01-28  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* addin/math.nsc: format result with "text::printf".

	* src/gtk/x11view.c (mouse_down_move): don't check
	"arraynum(d->focusobj)".
	(mouse_up_point): remove unused variables "num" and "focused".
	(mouse_up_point): use "switch" instead of "if".
	(mouse_up_drag, mouse_up_zoom, mouse_up_change): don't call
	"SetCursor()".
	(ViewerEvLButtonUp): call "SetCursor()" when "d->Mode" is
	"PointB", "LegendB", "AxisB", "TrimB", "DataB" or "EvalB".
	(get_mouse_cursor_type): return GDK_LEFT_PTR when "num == 0".

	* src/gtk/x11scrip.c (ScriptDialogClose): initialize
	"d->execscript" as NULL before check "d->ret".
	(CmScriptExec): call "delobj(shell, newid)" when "arrayadd()"
	returns NULL.

2009-01-23  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* debian/Makefile.am: add files for debian package.

	* src/gtk/x11menu.c (application): call "gtk_widget_show_all()"
	instead of "gtk_window_present()".

2009-01-20  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11file.c (start_editing): treat "id" as oid when
	"name[0] == '^'".

	* src/oagrid.c (agridtight): use "obj_do_tighten()".

	* src/oaxis.c (axistight): use "obj_do_tighten()".

	* src/ofile.c (f2dtight): use "obj_do_tighten()".

	* src/object.c (obj_do_tighten): added.

2009-01-18  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11merge.c (POPUP_ITEM_TOP, POPUP_ITEM_UP)
	(POPUP_ITEM_DOWN, POPUP_ITEM_BOTTOM): added.
	(MergeWinExpose): change sensitivity of popup menu item.

	* src/gtk/x11lgnd.c (POPUP_ITEM_TOP, POPUP_ITEM_UP)
	(POPUP_ITEM_DOWN, POPUP_ITEM_BOTTOM): added.
	(LegendWinExpose): change sensitivity of popup menu item.

	* src/gtk/x11file.c (POPUP_ITEM_TOP, POPUP_ITEM_UP)
	(POPUP_ITEM_DOWN, POPUP_ITEM_BOTTOM): added.
	(popup_show_cb): change sensitivity of popup menu item.
	(FileDialog): d->multi_open is TRUE when "multi > 0".

	* src/gtk/x11axis.c (POPUP_ITEM_TOP, POPUP_ITEM_UP)
	(POPUP_ITEM_DOWN, POPUP_ITEM_BOTTOM): added.
	(popup_show_cb): change sensitivity of popup menu item.

2009-01-17  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11dialg.h (struct FitDialog): add members
	"through_box", "dim_box", "weight_box", "usr_deriv_box",
	"usr_def_frame" and "div_box".

	* src/gtk/x11file.c (FitDialogSetSensitivity): added.
	(FitDialogSetup): add signal handler for some widgets to change
	sensitivity of widgets.

2009-01-14  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11dialg.h (struct FileDialog): add member "apply_all"
	and "multi_open".

	* src/gtk/x11merge.c (MergeDialogSetup): add signal handler for
	"copy" button.

	* src/gtk/x11lgnd.c (LegendCurveDialogSetup)
	(LegendPolyDialogSetup, LegendArrowDialogSetup)
	(LegendRectDialogSetup, LegendArcDialogSetup)
	(LegendMarkDialogSetup, LegendTextDialogSetup): add signal handler
	for "copy" and "copy all" button.

	* src/gtk/x11file.c (FitDialogSetup, FileMoveDialogSetup)
	(FileMaskDialogSetup, FileLoadDialogSetup, FileMathDialogSetup)
	(FileDialogSetup): add signal handler for "copy" button.
	(FileDialogSetupItem): set sensitivity of "d->apply_all" by
	"d->multi_open".
	(FileDialog): initialize "d->multi_open".
	(FitDialogApply): check "poly_dimension" field is changed or not.
	(FileMoveDialogSetupItem, FileMoveDialogClose): execute
	"move_data_adjust" before get "move_data", "move_data_x" and
	"move_data_y".
	(FileDialogFit): delete instance of "fit" object when "ret ==
	IDCANCEL" and "create == FALSE".

	* src/gtk/x11axis.c (GridDialogSetup, AxisBaseDialogSetup)
	(AxisPosDialogSetup, NumDialogSetup, AxisFontDialogSetup)
	(GaugeDialogSetup, AxisDialogSetup): add signal handler for "copy"
	button.
	(SectionDialogGrid): delete instance of "axisgrid" object when
	"ret == IDCANCEL" and "create == FALSE".
	(SectionDialogGrid): don't call "set_graph_modified()" when
	"axisgrid" object is not created.

	* src/gtk/x11gui.c (set_sensitivity_by_check_instance): added.
	(DialogExecute): call "gtk_widget_hide_all()" before call
	"gtk_widget_show_all()".

	* src/shellcm.c (dispfield): change field size for field name from
	15 to 16.

	* src/gtk/x11view.c (mouse_down_move_data): execute
	"move_data_adjust" before get "move_data", "move_data_x" and
	"move_data_y".

	* src/oprm.c (prmload): execute "move_data_adjust" before get
	"move_data", "move_data_x" and "move_data_y".

	* src/ofile.c (adjust_move_num): added.
	(file2d): add field "move_data_adjust".
	(opendata): execute "move_data_adjust" before get "move_data",
	"move_data_x" and "move_data_y".

2009-01-13  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11view.c (menu_activate): added.
	(ViewerWinSetup): add signal handler for "selection-done" to
	"d->menu".
	(Evaluate): cursor type is "GDK_TCROSS" when move data mode.
	(mouse_down_move_data): check return value of "getobj()" and
	"getobjlist()" and goto "ErrEnd" when these functions return FALSE.
	(move_data_cancel): add argument "show_message".
	(mouse_down_move_data): check return value of "arraynget()".
	(do_popup): check id of focused object when "num == 1".

	* src/gtk/x11menu.h (struct Viewer): add member "menu".

	* src/gtk/x11menu.c (Cursor): add "GDK_TCROSS".
	(SetCursor): add case "GDK_TCROSS".
	(setupwindow): initialize "NgraphApp.Viewer.menu".

2009-01-11  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11menu.h (enum MouseMode): added.
	(struct Viewer): member "MouseMode" and "Mode" are enum.

	* src/gtk/x11view.c (init_zoom): added.
	(mouse_down_move): use "get_mouse_cursor_type()" to check cursor
	position.
	(get_mouse_cursor_type): set "d->ChangePoint".
	(POINT_LENGTH, FOCUS_FRAME_OFST, FOCUS_RECT_SIZE): added.
	(ShowFocusFrame, get_mouse_cursor_type): use "FOCUS_RECT_SIZE" and
	"FOCUS_FRAME_OFST".
	(ShowPoints): use "POINT_LENGTH".

2009-01-10  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11view.c (do_popup): set sensitivity of popup item
	related to "VIEWER_POPUP_ITEM_UP" and "VIEWER_POPUP_ITEM_DOWN".
	(create_popup_menu): add "#error" directive to check array size.

2009-01-09  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11menu.h (VIEWER_POPUP_ITEM_NUM): change value from 7
	to 9.

	* src/gtk/x11gui.c (GetColor): remove.

	* src/gtk/x11menu.c (application): change color of "gray" from
	"#7f7f7f" to "#aaaaaa".

2009-01-08  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/ogra2x11.c (gtkMakeRuler): use "GDK_INVERT" instead of
	"GDK_XOR".
	(gtkRGB): remove.

	* src/gtk/x11lgndx.c (clear_view): don't call
	"gdk_window_clear()".
	(LegendGaussDialogSetup): use "value-changed" signal instead of
	"change-value".

	* src/gtk/x11opt.c (DefaultDialogClose): use
	"sub_window_save_geometry()" to get geometry of a sub window.

	* src/gtk/x11menu.c (CmReloadWindowConfig): use
	"sub_window_hide()" to hide sub window.

	* src/gtk/x11info.c (CmInformationWindow): use "sub_window_show()"
	 and "sub_window_toggle_visibility()".

	* src/gtk/x11cood.c (CmCoordinateWindow): use "sub_window_show()"
	 and "sub_window_toggle_visibility()".

	* src/gtk/x11merge.c (CmMergeWindow): use "sub_window_show()" and
	 "sub_window_toggle_visibility()".

	* src/gtk/x11lgnd.c (CmLegendWindow): use "sub_window_show()" and
	 "sub_window_toggle_visibility()".

	* src/gtk/x11axis.c (CmAxisWindow): use "sub_window_show()" and
	 "sub_window_toggle_visibility()".

	* src/gtk/x11file.c (CmFileWindow): use "sub_window_show()" and
	 "sub_window_toggle_visibility()".

	* src/gtk/gtk_subwin.c (set_geometry): add argument "state" and
	save window state.
	(sub_window_save_geometry): save window state.
	(sub_window_hide, sub_window_show, sub_window_toggle_visibility):
	added.
	(cb_del): just call "sub_window_hide()".

2009-01-07  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11menu.c (CmReloadWindowConfig): call
	"sub_window_set_geometry()" after show the window.

	* src/gtk/x11cood.c (CmCoordinateWindow): call
	"sub_window_save_geometry()" before hide.
	(CmCoordinateWindow): call "sub_window_set_geometry()" after call
	"gtk_widget_show_all()".

	* src/gtk/x11axis.c (CmAxisWindow): call
	"sub_window_save_geometry()" before hide.
	(CmAxisWindow): call "sub_window_set_geometry()" after call
	"gtk_widget_show_all()".

	* src/gtk/x11file.c (CmFileWindow): call
	"sub_window_save_geometry()" before hide.
	(CmFileWindow): call "sub_window_set_geometry()" after call
	"gtk_widget_show_all()".

	* src/gtk/x11lgnd.c (CmLegendWindow): call
	"sub_window_save_geometry()" before hide.
	(CmLegendWindow): call "sub_window_set_geometry()" after call
	"gtk_widget_show_all()".

	* src/gtk/x11merge.c (CmMergeWindow): call
	"sub_window_save_geometry()" before hide.
	(CmMergeWindow): call "sub_window_set_geometry()" after call
	"gtk_widget_show_all()".

	* src/gtk/x11info.c (InfoWinUpdate): call
	"sub_window_save_geometry()" before hide.
	(InfoWinUpdate): call "sub_window_set_geometry()" after call
	"gtk_widget_show_all()".

	* src/gtk/gtk_subwin.c (sub_window_set_geometry)
	(sub_window_save_geometry): added.
	(cb_show): call "sub_window_set_geometry()".
	(cb_del): call "sub_window_save_geometry()".

	* src/gtk/x11view.c (ShowFocusFrame): use
	"Menulocal.focus_frame_type" for line attribute of focus frame.

	* src/gtk/x11opt.c (DefaultDialogClose): save
	"Menulocal.focus_frame_type".
	(MiscDialogSetupItem): setpu "d->fftype".
	(MiscDialogClose): set "Menulocal.focus_frame_type".

	* src/gtk/ox11menu.h (struct menulocal): add member
	"focus_frame_type".

	* src/gtk/ox11menu.c (MenuConfig): add item for
	"focus_frame_type".
	(menuinit): initialize "Menulocal.focus_frame_type".

	* src/gtk/x11menu.c (show_instance_menu_cb)
	(set_show_instance_menu_cb, struct show_instance_menu_data): added.
	(create_filemenu, create_axisgridmenu, create_axismenu)
	(create_mergemenu, create_outputmenu): call
	"show_instance_menu_cb()".
	(create_legendmenu): call "g_signal_connect()" for "show" signal.
	(create_legendsubmenu): return "menu".

2009-01-06  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/object.c: variable "looproot" is static.
	(has_eventloop): added.

	* src/shell.c (msleep): added.
	(cmdexec): don't set "WNOHANG" when "has_eventloop()" returns
	FALSE.
	(cmdexec): use "msleep()" after call "eventloop()".

	* src/shellux.c (cmsleep): use "sleep()" when "has_eventloop()"
	returns FALSE.
	(cmsleep): use "msleep()" after call "eventloop()".

	* demo/demo.ngp.in: added.

	* src/gtk/gtk_subwin.c (sub_window_create): add argument "xpm2"
	and call "gtk_window_set_icon_list()" when "xpm2" is not NULL.

	* src/gtk/x11bitmp.c: add "Axiswin48_xpm", "Coordwin48_xpm",
	"Filewin48_xpm", "Infowin48_xpm", "Legendwin48_xpm" and
	"Mergewin48_xpm".

	* src/gtk/x11menu.c (struct command_data): remove member "xbm".

	* src/gtk/x11bitmp.c: remove xbm data.

	* src/gtk/x11menu.c (createpixmap, createicon): use
	"gdk_pixbuf_new_from_xpm_data()" instead of
	"create_pixbuf_from_xpm()".

	* src/gtk/gtk_subwin.c (sub_window_create): use
	"gdk_pixbuf_new_from_xpm_data()" instead of
	"create_pixbuf_from_xpm()".

	* src/gtk/x11menu.c (create_pixbuf_from_xpm): remove.

2009-01-04  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/terminal.c (my_signal): added.
	(main): use "my_signal".

	* src/gtk/main.c: variables "consolecol", "consolerow",
	"consolefdout", "consolefdin", "consoleac" and "systemname" are
	static.
	(interruptconsole, inputynconsole, displaydialogconsole)
	(displaystatusconsole): these functions are static.

	* src/osystem.c (systemresize): don't check "data[0]" and
	"data[1]".

2009-01-03  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11menu.c (create_cursor): use "gdk_cursor_new()"
	instead of "gdk_cursor_new_for_display()".

	* src/gtk/main.c: remove global variable "Disp".

	* src/gtk/x11view.c (OpenGC): don't call
	"gdk_display_get_default()".

	* src/gtk/ogra2x11.c (gtkflush): added.

	* src/gtk/ox11menu.c (mxflush): don't call "gdk_display_flush()".

	* src/gtk/x11view.c (CloseGC, ReopenGC): don't call
	"gdk_display_flush()".

2009-01-02  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/terminal.c (main): use named pipe.
	(main): use "pause()" to wait termination.

	* src/gtk/main.c: global variables "terminal", "consolesave",
	"consolefd[]" and "consolepid" are static.
	remove unused variable "pipefd".
	(nallocconsole): use named pipe.
	(nfreeconsole): use "kill()" to terminate "nterminal".

2008-12-31  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/main.c (putconsole, printfconsole, inputynconsole)
	(nallocconsole): check return value of "write()".
	(nfreeconsole): check value of "pipefd".

	* src/gtk/ogra2x11.c (gtkflush): remove.
	(gra2gtk): remove field "flush".
	(gra2gtk): rename field "redraw" to "expose".
	(gra2gtk): add field "dpix" and "dpiy".
	(gtkinit): "gtkevpaint()" is connected to "gtklocal->View".
	(gdkgc_set_arc_mode, gdkgc_set_fill_rule): remove.
	(gtkinit): show error message when "OpenApplication()" returns
	FALSE.

2008-12-30  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* demo/demo.ngp: added.

	* src/gtk/x11view.c (AlignFocusedObj, ViewDelete, ViewCopy)
	(ViewCross): do nothing when "Menulock" or "GlobalLock" is TRUE.
	(mouse_up_zoom): minimum value of "zm" is 1000.

	* src/gtk/x11opt.c (CmOptionSaveNgp): do nothing when "Menulock"
	or "GlobalLock" is TRUE.

	* src/gtk/x11graph.c (CmHelpAbout, CmHelpHelp): do nothing when
	"Menulock" or "GlobalLock" is TRUE.

	* src/gtk/ogra2x11.c (gtkclear): clear pixmap.
	(gtk_set_dpi): added.
	(gra2gtk): add filed "dpi".

	* src/gtk/x11scrip.c (CmScriptExec): use "menu_lock()" to lock
	gui.

	* src/gtk/x11menu.c (menu_lock): add

	* src/gtk/x11graph.c (CmGraphShell): use "menu_lock()" to lock
	gui.

	* src/gtk/x11file.c (select_type, start_editing_type)
	(start_editing, edited_axis):  use "menu_lock()" to lock
	gui.

	* src/gtk/x11commn.c (LoadNgpFile): use "menu_lock()" to lock gui.
	(LoadNgpFile): call "registerevloop()" and "unregisterevloop()"
	before and after call "_exeobj()" respectively.

	* src/gtk/x11axis.c (start_editing, edited): use "menu_lock()" to
	lock gui.

	* src/gtk/ox11menu.c (mx_print): use "menu_lock()" to lock gui.
	(gtkmenu): type of "print" field is "NVFUNC".

	* src/gtk/gtk_subwin.c (start_editing, cancel_editing)
	(numeric_cb, string_cb):  use "menu_lock()" to lock
	gui.

	* src/shellux.c (cmsleep): call "sleep()" while waiting timeout.

2008-12-28  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11view.c (mouse_up_drag): move object only when
	"dx != 0 || dy != 0".
	(mouse_up_change): change object only when "dx != 0 || dy != 0".
	(mouse_up_zoom): zoom object only when "zm != 0 && zm != 10000".

2008-12-26  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/omark.c (marktype): added.
	(mark): check marktype.

	* demo/demo5b.ngp (text): maximum value of "i" is 8.

	* src/gtk/x11view.c (ShowFrameRect, ShowPoints, ShowFocusLine)
	(ShowFocusFrame): do not call "gdk_gc_set_dashes()".

	* src/gtk/x11lgndx.c (LegendGaussDialogPaint): do not call
	"gdk_gc_set_dashes()".

	* src/gtk/x11dialg.c: remove variables "Dashes" and "DashesNum".

	* src/gtk/x11view.c (get_mouse_cursor_type): bug fix: fix
	conditions for "GDK_TOP_RIGHT_CORNER".

	* src/gtk/ogra2cairo.c (draw_str): create PangoLayoute only when
	"local->layout" is NULL.
	(gra2cairo_init): initialize "local->layout".
	(gra2cairo_free): unref "local->layout" if "local->layout" is not
	NULL.

	* src/gtk/ogra2cairo.h (struct gra2cairo_local): add member
	"layout".

2008-12-25  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* initfile/.Ngraph: add "-gra" option.
	do not create new "gra" object after evaluate ngp file.

2008-12-22  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11view.c (new_merge_obj, new_file_obj)
	(text_dropped, ViewerWinFileUpdate, Evaluate, Trimming)
	(AlignFocusedObj, mouse_down_move_data, mouse_up_drag)
	(mouse_up_zoom, mouse_up_change, create_legend1, create_legend2)
	(create_legend3, create_legendx, create_single_axis)
	(create_axis, ViewerEvKeyUp, ViewUpdate, ViewDelete)
	(reorder_object, ViewCopyAxis, ViewCopy): use
	"set_graph_modified()".
	(graph_dropped): use "reset_graph_modified()".

	* src/gtk/x11merge.c (CmMergeOpen, CmMergeClose, CmMergeUpdate):
	use "set_graph_modified()".

	* src/gtk/x11lgnd.c (legend_dialog_close, CmLineDel)
	(CmLineUpdate, CmCurveDel, CmCurveUpdate, CmPolyDel)
	(CmPolyUpdate, CmRectDel, CmRectUpdate, CmArcDel, CmArcUpdate)
	(CmMarkDel, CmMarkUpdate, CmTextDel, CmTextUpdate)
	(LegendWinLegendUpdate): use "set_graph_modified()".

	* src/gtk/x11graph.c (CmGraphSwitch, CmGraphPage): use
	"set_graph_modified()".
	(CmGraphLoad, CmGraphHistory): use "reset_graph_modified()".

	* src/gtk/x11file.c (MathDialogList, FileMaskDialogClose)
	(FileLoadDialogClose, FileDialogCopyAll, CmFileHistory)
	(CmFileNew, CmFileOpen, CmFileClose, CmFileUpdate)
	(FileWinFileDelete, file_obj_copy, FileWinFileUpdate)
	(FileWinFileDraw, select_type, edited_axis): use
	"set_graph_modified()".

	* src/gtk/x11dialg.c (SetObjPointsFromText, SetObjFieldFromText)
	(SetObjFieldFromSpin, SetObjFieldFromToggle)
	(SetObjFieldFromStyle, SetObjFieldFromList)
	(SetObjFieldFromFontList, SetObjAxisFieldFromWidget)
	(_putobj_color): use "set_graph_modified()".

	* src/gtk/x11commn.c (CheckSave): use "get_graph_modified()".
	(GraphSave): use "reset_graph_modified()".

	* src/gtk/x11axis.c (SectionDialogGrid, CmAxisNewFrame)
	(CmAxisNewSection, CmAxisNewCross, CmAxisNewSingle, CmAxisDel)
	(CmAxisZoom, CmAxisClear, CmAxisGridNew, CmAxisGridDel)
	(CmAxisGridUpdate, AxisWinExpose, edited): use
	"set_graph_modified()".

	* src/gtk/ox11menu.h: add prototype of "get_graph_modified",
	"reset_graph_modified" and "set_graph_modified".

	* src/gtk/ox11menu.c (get_graph_modified, reset_graph_modified)
	(set_graph_modified): add
	(menuinit): initialize "modified" field.
	(gtkmenu): add "modified" field.

	* src/gtk/gtk_subwin.c (copy, delete, move_top, move_last)
	(move_up, move_down, modify_numeric, modify_string, hidden)
	(tree_copy, tree_delete, tree_move_top, tree_move_last)
	(tree_move_up, tree_move_down, tree_hidden): use
	"set_graph_modified()".

	* addin/math.nsc: set +e and check return value of dexpr.

	* src/gtk/x11dialg.h (struct MiscDialog): add menber "Obj" and
	"Id".

	* src/gtk/x11menu.c (init_ngraph_app_struct): initialize
	"NgraphApp.Interrupt".

	* src/gtk/x11menu.h (struct NgraphApp): remove unused member
	"interrupt" and "Changed".

	* src/gtk/x11opt.c (ViewerDialogClose): call "putobj()" to set
	"redraw_num" field.
	(MiscDialog): add argument "struct objlist *obj" and "int id".
	(CmOptionMisc): add argument to call "MiscDialog()".
	(MiscDialogClose): call "putobj()" to save "data_head_lines".

	* src/gtk/ox11menu.c (gtkmenu): type of "redraw_num" field is
	"NINT".

2008-12-20  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/ox11menu.c (menuerrorlist): add message "cannot open
	display.".
	(enum): add error identifier.
	(menuinit): call "error()" when "OpenApplication()" returns FALSE.

	* src/gtk/ox11dlg.c (dlginit): call "error()" when
	"OpenApplication()" returns FALSE.

2008-12-19  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/ofile.c (set_data_progress): check if "frac" is greater than
	1 or not.

2008-12-18  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11menu.c (kill_signal_handler): added.
	(childhandler): use "sigaction()" instead of "signal()".
	(AppMainLoop): call "CheckSave()" when "Hide_window" is TRUE.
	(application): use "sigaction()" instead of "signal()".
	(application): set signal handler for "SIGINT" signal.

	* src/gtk/x11graph.c (CmGraphQuit): just call "QuitGUI()".

	* src/gtk/x11opt.c (MiscDialogSetup): change design of the dialog.

	* src/gtk/x11view.c (enum ViewerPopupIdn): add "VIEW_UP" and
	"VIEW_DOWN".
	(enum object_move_type): added.
	(create_popup_menu): add up and down object menu item.
	(ViewerPopupMenu): add case "VIEW_DOWN" and "VIEW_UP".
	(reorder_object): change argument from int to "enum
	object_move_type".

	* src/gtk/ogra2cairo.c (gra2cairo_output): don't draw arc if "w"
	or "h" is 0 in the case of "code" is 'C'.

	* src/otext.c (textzoom): minimum value of "pt" is 1.

	* src/orect.c (rectzoom): minimum value of "width" is 1.

	* src/omark.c (markzoom): minimum value of "size" and "width" is 1.
	(markgeometry): use temporal variable "val".

	* src/olegend.c (legendzoom): minimum value of "width" is 1.

	* src/oarc.c (arcgeometry): use temporal variable "val".
	(arczoom): minimum value of "rx", "ry", and "width" is 1.

2008-12-17  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11file.c (FileWinFileDraw): check if the graph is
	changed or not.

	* src/oline.c (arrowbbox): bug fix: add valiable "num2" and "num2"
	is used only to calculate positions of an arrow.

	* src/gtk/x11view.c (Match): return matched instance number.
	(mouse_up_point): change cursor if any object is focused.

	* src/gtk/ox11menu.c (gtkmenu): add field "draw".
	(mxdraw): added.
	(mx_redraw): call "gdk_window_invalidate_rect()".

	* src/gtk/x11merge.c (MergeDialogSetup): use
	"gtk_check_button_new_with_mnemonic()" instead of
	"gtk_check_button_new_with_label()".

	* src/gtk/x11gui.c (FileSelectionDialog): use
	"gtk_check_button_new_with_mnemonic()" instead of
	"gtk_check_button_new_with_label()".

2008-12-16  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11view.c (struct viewer_popup): add member "submenu_item_num".
	(create_menu): add argument "int n".
	(create_menu): add separator when "popup[i].title" is NULL.
	(create_popup_menu): add separator to menus.

	* src/gtk/x11merge.c (Mlist): add separator.
	(Mlist): "file" column is editable.

	* src/gtk/x11lgnd.c (Popup_list): add separator.

	* src/gtk/x11file.c (Flist): minimum value of "step" is 1.
	(Popup_list): add separator.

	* src/gtk/x11axis.c (Popup_list): add separator.
	(Popup_list): add clear menu item.
	(axiswin_scale_clear): added.

	* src/gtk/gtk_subwin.c (sub_win_create_popup_menu): add
	"GtkSeparatorMenuItem" when "list[i].title" is NULL.

2008-12-15  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11menu.c (find_gra2gdk_inst): bug fix: always get
	"_local" field.

2008-12-12  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/ogra2x11.c (struct gtklocal): remove unused member
	"autoredraw", "cmap" and "minus_hyphen".
	(gra2gtk): remove unused field "auto_redraw".

	* src/gtk/ox11menu.h (struct mxlocal): remove unused member
	"privatecolor", "cmap", "cdepth", "cairo_save", "minus_hyphen" and
	"points".
	(struct menulocal): remove unused member "mousecloick" and
	"movechild".

	* src/gtk/x11menu.c (createcommand1, createcommand2): check
	"Menulocal.showtip".

	* src/gtk/gtk_liststore.c (create_column): set page_size of
	GtkAdjustment as 0.

2008-12-09  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/shellcm.c (cmecho): add "-n" option.

2008-12-03  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/ofile.c (getdata_skip_step): call "memfree(buf)" when
	"rcode" is 1 or -1.

2008-12-02  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/ofile.c (search_mask): added.
	(getdata_sub2, getdata2, getdataraw): use "search_mask()".
	(struct f2ddata): add member "mask_index".
	(opendata, reopendata): initialize "fp->mask_index".

2008-12-01  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/ox11dlg.c

	* src/gtk/x11gui.c (DialogRadio, DialogCombo, DialogCheck): add
	label if "caption" is not NULL.
	(DialogComboEntry): added.

	* src/gtk/ox11dlg.c (dlgconfirm, dlgmessage, dlgradio, dlgcombo)
	(dlgcheck): check and use "title" field.
	(dlginput, dlgradio, dlgcombo, dlgcheck): check and use "caption"
	field.
	(dlgcombo_entry): added.
	(dialog): add "combo_entry", "title" and "caption" field.

2008-11-28  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/ox11dlg.c (dlggetopenfile, dlggetopenfiles)
	(dlggetsavefile): second argument is used as an initial file name.

	* src/gtk/x11gui.c (FileSelectionDialog): check "type" before call
	set name.
	(fsok): check "filter".

	* src/gtk/ox11dlg.c (dlgcombo): added.
	(dialog): add field "combo".
	(dlggetsavefile, dlggetopenfile): use "memfree()" to free "*(char
	**)rval".

	* src/gtk/x11gui.c (DialogCombo): added.

	* demo/encoding.ngp: use "dialog::combo" instead of
	"dialog::input".

2008-11-27  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/ox11dlg.c (dlgcheck, dlgradio): added.
	(dialog): add fields "radio" and "check".
	now all functions dfined in ox11dlg.c is static.

	* src/gtk/x11gui.h: add prototype of "DialogCheck" and "DialogRadio"

	* src/gtk/x11gui.c (DialogCheck, DialogRadio): added.

	* src/gtk/ox11menu.h (struct menulocal): remove unused member
	"framex", "framey" and "exwinbackingstore".
	(struct mxlocal): remove unused member "backingstore".

	* src/gtk/ox11menu.c (enum menu_config_type)
	(menu_config_menu_geometry, menu_config_file_geometry)
	(menu_config_axis_geometry, menu_config_legend_geometry)
	(menu_config_merge_geometry, menu_config_dialog_geometry)
	(menu_config_coord_geometry, struct menu_config, MenuConfig)
	(MenuConfigHash, menu_config_set_four_elements)
	(menu_config_set_window_geometry, menu_config_set_bgcolor)
	(menu_config_set_ext_driver, menu_config_set_prn_driver)
	(menu_config_set_script, set_menu_config_mxlocal): added.
	(addmenu): initialize "MenuConfigHash".
	(mgtkloadconfig, mgtkwindowconfig): use "FileConfigHash".

2008-11-26  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/ofile.c add global valiable "FileConfigHash".
	(enum file_config_type, struct file_config, FileConfig): added.
	(f2dloadconfig): use "FileConfigHash".
	(addfile): initialize "FileConfigHash".

	* src/gtk/ox11menu.h (struct mxlocal): remove unused member "fontalias".

	* src/gtk/x11dialg.c (SetObjFieldFromFontList): free "fontalias".

	* src/gtk/main.c (get_obj_font_list): use
	"Gra2cairoConf->font_num".

	* src/gtk/ogra2cairo.c (free_font_map): added.
	(create_font_map): added.
	(loadconfig): use "create_font_map()"
	(init_conf): initialize "Gra2cairoConf->font_num".
	(free_fonts_sub): added.
	(free_conf): use "nhash_each" and "nhash_free" to free font maps.
	(loadfont): remove second argument and return "struct fontmap *".
	(loadfont): remove codes related with " Gra2cairoConf->font".
	(draw_str): change 4th argument.
	(gra2cairo_output): use "local->loadfont".

	* src/gtk/ogra2cairo.h: remove definition of "struct fontlocal".
	(struct fontmap): add member "PangoFontDescription *font".
	(struct fontmap): add member "struct fontmap *prev".
	(struct gra2cairo_local): remove member "loadfontf" and add member
	"loadfont".

2008-11-25  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/orect.c (rect): use "oputcolor()" to set value to fields
	"R2", "G2" and "B2".

	* src/omark.c (mark): use "oputcolor()" to set value to fields
	"R2", "G2" and "B2".

	* src/ofile.c (file2d): use "oputcolor()" to set value to fields
	"R2", "G2" and "B2".

	* src/odraw.c (draw): use "oputcolor()" to set value to fields
	"R", "G" and "B".

	* src/oroot.h: add prototype of "oputcolor()".

	* src/oroot.c (oputcolor): added.

	* src/gtk/x11dialg.c (SetFontListFromObj): use
	"Gra2cairoConf->fontmap_list_root" instead of
	"Gra2cairoConf->fontmaproot".
	(SetFontListFromObj): bug fix: check if "font" is NULL or not.
	(SetFontListFromObj): default value of "selfont" is now 0.
	(SetObjFieldFromFontList): use hash to search font alias.
	(_set_color): check value of "R", "G" and "B".

	* src/gtk/ogra2cairo.h (struct gra2cairo_config): add member
	"fontmap_list_root".

	* src/gtk/ogra2cairo.c: add global valiable "FontFace".
	(loadconfig): save font configuration to hash.
	(init_conf): init "FontFace" and "Gra2cairoConf->fontmaproot".
	(free_conf): use "nhash_free_with_memfree_ptr()" to free fontmap.
	(loadfont, gra2cairo_charheight): use hash to search font alias
	settings.

	* src/gtk/main.c (get_obj_font_list): use
	"Gra2cairoConf->fontmap_list_root" instead of
	"Gra2cairoConf->fontmaproot".

	* src/nhash.h: add prototype of "nhash_num()".

	* src/nhash.c (count_hash, nhash_num): added.

2008-11-21  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gra.c  (GRAcharascent, GRAchardescent, GRAcharwidth): return
	calculated value when return value of "__exeobj()" is not zero.

2008-11-18  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* initfile/.Ngraph: use new gra to create image file.

	* driver/ngp2.in: added.

	* driver/Makefile.am (ngp2): added.
	(bin_SCRIPTS): added.

2008-11-17  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/ogra.c (oGRAopen): put error message when the return value
	of "GRAinit()" is false.

	* src/gra.c (GRAinit): don't return "ERROPEN" when
	"GRAClist[GC]output == -1".

2008-11-16  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/nhash.c (create_hash_with_hkey): fix condition (from "lr ==
	-1" to "lr < 0").

	* src/gtk/main.c (main): check return value of "newobj()" and
	"chkobjinst()".

2008-11-12  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11graph.c (CmGraphShell): create new instance when
	there are no instances of "shell" object.

	* src/shell.h (struct nshell): add member "deleted".

	* src/shell.c (cmdexecute): exit loop when "nshell->deleted" is
	true.
	(newshell): initialize "nshell->deleted".

	* src/oshell.c (cmddone): if "shlocal->lock" is true, set
	"shlocal->nshell->deleted" as 1.
	(cmdshell): exit roop when "nshell->deleted" is true.
	(cmdshell): call "delshell()" when "nshell->deleted" is true.

	* src/nhash.c (nhash_del_with_hkey, nhash_del): check "h".

2008-11-10  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11file.c (FileDialogType): set sensitivity of parent widgets.

	* src/gtk/x11opt.c (use_external_toggled): set sensitivity of parent widgets.

	* src/gtk/x11graph.c (pagelist): fix label string of "Legal L".
	(PageDialogPage): set sensitivity of parent widgets.

2008-11-07  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11menu.c (get_home): added.
	(createmenu): load accel map when "KEYMAP_FILE" is exist in
	"NGRAPH_HOME".

	* src/object.h (struct objlist): add member "fieldnum".

	* src/object.c (addobject): initialize "objnew->fieldnum".
	(chkobjfieldnum): return "obj->fieldnum" when value of
	"obj->fieldnum" is valid.

2008-11-06  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/shell.c (saveval): bug fix: "valcur->next" is NULL when
	"name" is found in nshell->valroot.

	* src/gtk/x11print.c (DriverDialogClose): change buffer size of a
	message.

	* src/shellcm.c (printexp): added.
	(cmexport, cmset): use hash when "USE_HASH" is true.

	* src/shell.c (create_vallist, free_vallist): added.
	(addval, saveval, restoreval, addexp, delval, getval, getexp)
	(newfunc, addfunc, getfunc, cmdexec, newshell, delshell): use hash
	when "USE_HASH" is true.

	* src/object.c (ARGBUFNUM): change value from 10 to 32.

	* src/nhash.c (free_hash_list): add argument "free_ptr".
	(free_hash_list): call memfree() when "free_ptr" is true.
	(nhash_free): add second argument.
	(nhash_free_with_memfree_ptr, create_hash_with_hkey)
	(nhash_set_int_with_hkey, nhash_set_ptr_with_hkey)
	(nhash_get_with_hkey, nhash_get_int_with_hkey)
	(nhash_del_with_hkey, nhash_get_ptr_with_hkey): added.

2008-10-23  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/ofile.c: add macro "check_infinite()".
	(getdataarray, f2dsettings): use "check_infinite()".

2008-10-22  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/ofile.c (f2dinit): initialize "line_join" as "bevel".

2008-10-20  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/main.c (main): call 'init_cmd_tbl()'.

	* src/shellcm.c (cmtype): use 'check_cpcmd()' and 'check_cmd()'.

	* src/shell.c (init_cmd_tbl, check_cmd, check_cpcmd): added.
	(checkcmd): use 'check_cpcmd()'.
	(cmdexec): use 'check_cmd()'.

2008-10-17  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/shell.c (cmdtable): add setting for 'seq'.

	* src/shellcm.c (cmseq): added.

2008-10-10  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11graph.c (set_objlist_btn_state)
	(set_drawlist_btn_state): added.
	(SwitchDialogAdd, SwitchDialogInsert, SwitchDialogRemove): call
	set_drawlist_btn_state() after call SwitchDialogSetupItem().
	(SwitchDialogSetup): set_drawlist_btn_state() and
	set_objlist_btn_state() after call SwitchDialogSetupItem().
	(drawlist_sel_cb, objlist_sel_cb): added.

	* src/gtk/x11dialg.h (struct SwitchDialog): add member "top",
	"up", "down", "bottom", "del", "ins", "add" and "btn_lock".

2008-10-08  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11graph.c (SwitchDialogDown, SwitchDialogUp): added.
	(SwitchDialogSetup): add 'GO UP' and 'GO DOWN' button.
	(SwitchDialogLast): select last item after move object.
	(SwitchDialogTop): select first item after move object.

	* src/gtk/x11view.c (ViewDelete): set mouse cursor to GDK_LEFT_PTR
	after delete objects.

	* src/otext.c (textprintf): add 'G' to the conversion specifier.
	(textprintf): check format string.

	* src/gra.c (GRAexpandpf): add 'G' to the conversion specifier.
	(GRAexpandpf): check format string.

2008-10-07  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11scrip.c (CmScriptExec): call
	gdk_window_invalidate_rect() after execute script.

2008-10-06  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11file.c (FileMaskDialogClose): don't check if the line
	number is already contained in mask.

	* call arrayuniq_int() after call arrayuniq_int().

	* src/object.c (arrayndel): use memmove() instead of memcpy().
	(arrayuniq_int): add

	* src/gtk/x11view.c (Evaluate): call file::modified when add mask
	points.

	* src/ofile.c (opendata): initialize fp->num.
	(closedata): add argument "f2dlocal".
	(closedata): set fp->datanum to f2dlocal->num.
	(f2ddone, getminmaxdata, f2ddraw, f2devaluate, f2dopendata)
	(f2dgetdata, f2dclosedata, f2dopendataraw, f2dgetdataraw)
	(f2dclosedataraw, f2dstat, f2dstat2, f2dboundings)
	(f2doutputfile): add argument to closedata().
	(get_mtime): added.
	(f2dstat): use get_mtime() to check mtime.
	(fitout): remove closedata().

2008-10-03  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/ofile.c (update_mask): added.
	(file2d): use update_mask() for "mask" field.
	(getdataraw, getdata2, getdata_sub2): use bsearch_int() to check
	mask.

	* src/gtk/x11view.c (Evaluate): add masked line as sorted.

	* src/object.c (cmp_func_int, arraysort_int): added.

	* src/mathfn.c (bsearch_int): added.

2008-09-25  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11view.c (ViewerEvKeyDown): add case "GDK_Page_Up" and
	"GDK_Page_Down".
	(ViewerEvKeyDown): in case of GDK_Down, GDK_Up, GDK_Left and
	GDK_Right, scroll screen if no objects are focused.

2008-09-24  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/ofile.c (getdata_sub2, getdata_skip_step): added.
	(getdata_sub1): use getdata_sub2().
	(struct f2ddata): use enum instead of int for 'type'.

2008-09-23  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* initfile/.Ngraph (check_set): added.
	* initfile/.Ngraph: use check_set to initialize file object.

2008-09-22  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/ofile.c (struct f2ddata): add member 'mtime' and
	'interrupt'.
	(opendata): set mtime to 'fp->mtime'.
	(check_mtime): added.
	(getminmaxdata): call check_mtime() and hskipdata().
	(f2ddraw, f2devaluate, f2dopendata, f2dstat, f2dstat2)
	(f2dboundings, f2doutputfile): remove check_mtime() placed before
	getminmaxdata().
	(f2dstat): check if 'f2dlocal->mtime == fp->mtime'.

2008-09-19  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11file.c (FileMoveDialogAdd, FileMoveDialogRemove)
	(FileMoveDialogCopy): set 'd->changed' as 'TRUE'.
	(FileMoveDialogClose, FileMaskDialogClose): do nothing when
	'd->changed' is 'FALSE'.
	(FileMaskDialog, FileMoveDialog): initialize 'data->changed'.

	* src/gtk/gtk_widget.h (enum SPIN_BUTTON_TYPE): add
	'SPIN_BUTTON_TYPE_NATURAL'.

	* src/gtk/gtk_widget.c (create_spin_entry_type): add case
	'SPIN_BUTTON_TYPE_NATURAL'

	* src/gtk/x11dialg.h (struct FileMoveDialog)
	(struct FileMaskDialog): add member 'changed'.

	* src/gtk/x11view.c (ViewerWinFileUpdate, ViewUpdate): set
	'NgraphApp.Changed' as 'TRUE' only when return value is
	'IDDELETE'.

	* src/gtk/x11merge.c (CmMergeClose): set 'NgraphApp.Changed' as
	'TRUE' only when return value is 'IDDELETE'.

	* src/gtk/x11lgnd.c (legend_dialog_close): check if the value is
	really changed.
	(CmLineUpdate, CmCurveUpdate, CmPolyUpdate, CmRectUpdate)
	(CmArcUpdate, CmMarkUpdate, CmTextUpdate, LegendWinLegendUpdate):
	set 'NgraphApp.Changed' as 'TRUE' only when return value is
	'IDDELETE'.

	* src/gtk/x11file.c (MathDialogList): remove AddMathList().
	(MathDialogList): check if the math text is really changed.
	(FitDialogApply): do not set 'TRUE' to 'NgraphApp.Changed'.
	(FileLoadDialogClose): check if the ifs text is really changed.
	(FileDialogCloseCommon): call SetObjAxisFieldFromWidget().
	(FileDefDialogClose): remove duplicate settings.

	* src/gtk/x11axis.c (CmAxisUpdate, CmAxisGridUpdate): do not set
	'TRUE' to 'NgraphApp.Changed' when the return value is not IDOK.

	* src/gtk/x11file.c (FileDialogCloseCommon): use
	SetObjAxisFieldFromWidget().

	* src/gtk/x11axis.c (GridDialogClose, AxisPosDialogClose)
	(AxisDialogClose): use SetObjAxisFieldFromWidget().

	* src/gtk/x11dialg.c (SetObjPointsFromText, SetObjFieldFromText)
	(SetObjFieldFromSpin, SetObjFieldFromToggle)
	(SetObjFieldFromStyle, SetObjFieldFromList)
	(SetObjFieldFromFontList, _putobj_color): check if the value is
	really changed.
	(SetObjAxisFieldFromWidget): add

	* src/gtk/gtk_subwin.c (update): do not set 'TRUE' to
	'NgraphApp.Changed'.

	* src/ofile.c (struct f2dlocal): add member "sumx, sumy, sumxx,
	sumyy, sumxy, minx, maxx, miny, maxy, num and mtime".
	(f2dfile, f2dput): set 'f2dlocal->mtime' as 0.
	(update_field, foputabs, foputge1): added.
	(getminmaxdata): add argument 'local'.
	(f2ddraw, f2devaluate, f2dopendata, f2dstat, f2dstat2)
	(f2dboundings, f2doutputfile): add argument to getminmaxdata().

2008-09-18  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/ofile.c (opendata): check mtime of the file.
	(file2d): add field "mtime".

	* src/gtk/x11commn.c (FileAutoScale): return when fail to allocate
	memory.

	* src/ofile.c (f2dbounding): return 1 when error is occurred.

	* src/oaxis.c (axisautoscalefile): check the return value of
	getobj().
	(axisautoscale): return 1 when the return value of
	axisautoscalefile() is not 0.

	* src/gtk/x11print.c (CmPrintDataFile): check the return value of
	exeobj().

	* src/gtk/ogra2gtkprint.c (create_cairo): show error message when
	error is occurred.

	* src/ofile.c (f2doutputfile): show error message when error is
	occurred.

	* src/gtk/x11menu.c (PutStdout, PutStderr): convert string from
	locale to UTF-8.

2008-09-17  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11print.c (draw_gra): check the return value of
	exeobj().

	* src/gtk/x11gui.c (fsok): set NULL to data->ext when filer name
	is "All".
	(fsok): call error22() after call gdk_beep().

	* src/gtk/ogra2cairofile.c (create_cairo): add argument 'err' and
	set cairo_status to err.
	(gra2cairofile_output): call error2() when some error is occurred
	in the case of 'I' and 'E'.
	(addgra2cairofile): add error messages.

	* src/gtk/ogra2cairo.c (check_cairo_status): added.
	(gra2cairo_flush): call check_cairo_status().
	(gra2cairo_output): call check_cairo_status() in the case of 'I'
	and 'E'.
	(addgra2cairo): add error messages.

	* src/ogra.c (oGRAopen): check the return value of GRAinit().

	* src/gra.c (GRAreopen, GRAdraw, GRAinit, GRAend): return int.

	* src/ogra.h (ERROPEN): added.

2008-09-16  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/object.c (add_obj_to_hash): added.
	(addobject): set object name and table position to hash.
	(chkobject): use hash to search object.
	(chkobjtblpos): use hash to search table position.
	(chkobjoffset, chkobjfield): use chkobjtblpos().

	* src/object.h (struct objlist): add member 'table_hash'.

	* src/nhash.h: added.

	* src/nhash.c: added.

2008-09-12  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11opt.c (DefaultDialogClose, ExViewerDialogSetupItem)
	(ExViewerDialogSetup): add settings for 'use_external'.
	(use_external_toggled): added.

	* src/gtk/ox11menu.h (struct menulocal): add member
	"exwin_use_external".

	* src/gtk/x11dialg.h (struct ExViewerDialog): add member
	"use_external".

	* src/gtk/x11print.c (draw_gra): use 'exeobj()' to call "open"
	member function.
	(CmOutputViewer): add argument 'select_file'.
	(CmOutputViewer): use "menu::print" instead of "gra2gtk".
	(CmOutputMenu, CmOutputViewerB): add argument to call
	CmOutputViewer().
	(CmOutputPrinterB): now second argument of CmOutputPrinter() is
	'FALSE'.

	* src/shellcm.c (cmset): use memmove().
	(cmobject): fix typo ("filed" to "field").

	* src/object.c (arrayndel2): use memmove().

2008-09-11  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11print.c (CmOutputPrinter): add argument 'int
	show_dialog'.
	(CmOutputPrinter): check 'show_dialog' when call
	gtk_print_operation_run().
	(CmOutputPrinterB): add argument when call CmOutputPrinter().
	(init_graobj): added.
	(CmOutputPrinter, CmOutputDriver, CmOutputViewer)
	(CmPrintGRAFile, CmOutputImage): use init_graobj().
	(draw_gra): added.
	(draw_page, CmOutputDriver, CmPrintGRAFile, CmOutputImage): use draw_gra().

	* src/gtk/x11menu.c (SetPoint, SetZoom, ResetZoom, SetStatusBar)
	(SetStatusBarXm, ResetStatusBar): check 'NgraphApp.Message' is
	NULL or not.
	(SetCursor): check 'NgraphApp.Cursor' is NULL or not.

	* src/gtk/x11graph.c (CmGraphMenu): add argument when call
	CmOutputPrinter().

	* src/gtk/ox11menu.c (mx_print): added.
	(gtkmenu): add member "print".

	* src/gtk/ogra2gtkprint.c (gra2gtkprint): remove member "next".

	* src/gtk/ogra2cairo.c (gra2cairo): remove member "next".

	* initfile/.Ngraph: add -p option.

2008-09-10  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11print.c (CmPrintGRAFile): set base-name of ngp file
	as default GRA filename.
	(get_base_ngp_name): added.
	(CmPrintGRAFile, CmOutputImage): use get_base_ngp_name().

	* src/gtk/ogra2cairo.c (draw_str, gra2cairo_charheight)
	(gra2cairo_charwidth):  check font size.

	* src/gtk/x11view.c (new_merge_obj, new_file_obj): added.
	(data_dropped): add argument 'file_type'. use new_file_obj() and
	new_merge_obj().

	* src/gtk/x11view.h: add prototype of data_dropped().

	* src/gtk/x11merge.c: include "x11view.h"
	(drag_drop_cb, init_dnd): added.
	(CmMergeWindow): call init_dnd().

	* src/gtk/x11file.c (drag_drop_cb, init_dnd): added.
	(CmFileWindow): call init_dnd().

	* src/gtk/x11menu.c (createcommand2): set signal handler for
	"button-press-event".

	* src/gtk/x11view.h: add prototype of CmViewerButtonPressed().

	* src/gtk/x11view.c: add 'KeepMouseMode'.
	(ViewerEvLButtonDblClk): call gtk_toggle_tool_button_set_active()
	when 'KeepMouseMode == FALSE'.
	(CmViewerButtonPressed): added.

2008-09-08  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11view.c (Focus): remove
	'gtk_toggle_tool_button_set_active()'.
	(check_focused_obj): now return index of found item.
	(ShowPoints): draw arc when 'd->Mode == ArcB'.
	(calc_snap_angle, calc_integer_ratio, SQRT3): added.
	(ViewerEvMouseMove): call calc_snap_angle() or
	calc_integer_ratio().

	* src/gtk/gtk_subwin.c (ev_key_down_tree): add 'break;' in the
	case of 'GDK_space'.
	(ev_key_down_tree): return 'FALSE' when shift key is pressed in
	the case of 'GDK_Return'.

2008-09-05  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11view.c (mouse_up_point): don't change cursor.
	(get_mouse_cursor_type): added.
	(set_mouse_cursor_hover): use get_mouse_cursor_type().

	* src/gtk/x11menu.c (Command2_data): remove MoveB.

2008-09-04  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11file.c (POPUP_ITEM_FIT): added.
	(popup_show_cb): check if the object associate with fit.

	* src/gtk/x11view.c (ViewerWinFileUpdate): call
	ProgressDialogCreate() before evaluate.
	(range_increment): added.
	(scrollbar_scroll_cb, ViewerEvScroll): use range_increment().
	(ViewerEvMouseMove): scroll when mouse position is out of the
	widget.
	(AlignFocusedObj): align to the paper when number of focused
	object is 1.
	(do_popup): set sensitivity of d->popup_item[3] as TRUE when 'num
	> 0'.

2008-09-01  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/gtk_subwin.c (start_editing): use snprintf() when
	'list->type == G_TYPE_STRING' and 'chkobjfieldtype(d->obj,
	list->name) == NDOUBLE' to set value.
	(modify_string): check if the value is really modified.

2008-08-29  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/gtk_subwin.c (ev_button_down, ev_button_down_tree):
	check 'event->time' to treat double click as double click.

2008-08-28  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11lgnd.c (legend_dialog_close): bug fix: call
	SetObjPointsFromText().

2008-08-27  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11lgnd.c (legend_dialog_close): bug fix: call
	SetObjFieldFromStyle().

	* src/gtk/x11opt.c (CmOptionViewer): uncomment 'ChangeDPI(TRUE);'.

	* src/gtk/x11dialg.h (struct MiscDialog): add 'data_head_lines'.

	* src/gtk/ox11menu.h (struct mxlocal): add 'data_head_lines'.

	* src/gtk/x11file.c (FileDialogSetup): use
	Mxlocal->data_head_lines.

	* src/gtk/ox11menu.c (mgtkloadconfig, menuinit): add settings for
	'Mxlocal->data_head_lines'.
	(mx_data_head_lines): added.
	(gtkmenu): add 'data_head_lines'.

	* src/gtk/x11opt.c (DefaultDialogClose, MiscDialogSetupItem)
	(MiscDialogSetup, MiscDialogClose): add settings for
	'Mxlocal->data_head_lines'.

2008-08-26  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/ofile.c (f2dhead): check the return value of nstrnew() is
	NULL or not.

	* src/gtk/x11gui.c (dialog_key_down_cb): return FALSE when 'w' key
	is pressed without control key.

	* src/gtk/gtk_subwin.c (ev_sub_win_key_down): return FALSE when
	'w' key is pressed without control key.

	* src/gtk/ogra2x11.c (ev_key_down): return FALSE when 'w' key is
	pressed without control key.

	* src/ofile.c (f2dhead): add line number.

	* src/ioutil.c (fgetnline): use fgetline().

2008-08-25  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/ofile.c (f2dhead): change length of 'buf' from 128 to 256.
	(f2dhead): use 'sizeof()' instead of immediate.

	* src/gtk/x11file.c (FileDialogSetup): change value of 'line' from
	10 to 20.

2008-08-22  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/ofile.c (struct f2ddata): add ifs_buf.
	(check_ifs_init, CHECK_IFS, CHECK_REMARK): added.
	(opendata): call check_ifs_init().
	(getdataarray, getdata_sub1, getdata2, getdataraw): use
	CHECK_REMARK and CHECK_IFS instead of strchr().

	* src/ioutil.c: added.
	(char_type_buf_init): added.
	(fgetline): use is_line_sep() when EOF == -1.

	* src/gtk/x11file.c (FileMoveDialogAdd): check if x and y are NaN or INF.

	* src/gtk/x11dialg.c (SetObjPointsFromText): check if d is NaN or INF.

	* src/gtk/gtk_subwin.c (numeric_cb): check if val is NaN or INF.

	* src/ofile.c (f2dsettings): check if f1, a2 and f3 are NaN or INF.

2008-08-21  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/ofile.c (struct f2ddata_buf): added.
	(struct f2ddata, opendata, closedata, getdata_sub1, getdata): use
	'struct f2ddata_buf'.

	* src/gra.c (GRAboundingbox): consider line width in the case 'R'.

	* src/ofile.c (reopendata): set fp->prev_datanum.
	(getdataraw): call set_data_progress().
	(getdataraw): increment fp->datanum in loop.

	* src/ioutil.c (fgetline): bug fix: increment 'i' only
	after nstraddchar().
	(fgetline) now '\r' is treated as line break.

2008-08-20  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/ofile.c (getdataarray): bug fix: check if val is NaN or INF.

	* src/ioutil.c (fgetline): use switch instead of if.

	* src/ofile.c (getdata_sub1): added.
	(getdata): use getdata_sub1().
	(getdata): use memmove() instead of loop.

	* src/axis.c (getaxispositionfirst): use alocal->inc instead of
	alocal->dposm to determine alocal->dposs.

2008-08-19  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gra.c (GRAboundingbox): now ch is int.
	(GRAboundingbox): first argument of Gracharwidth is '(ch & 0xff)'.

2008-08-18  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11file.c (select_type): set selected item to d->select.

	* src/gtk/x11menu.c (add_underscore): added.
	(show_graphmwnu_cb, show_filemwnu_cb): call add_underscore().

2008-08-15  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11menu.c: added.
	(create_graphmenu, create_axismenu): add accelerator.
	(create_toggle_menu_item): added.
	(create_windowmenu): use create_toggle_menu_item().

	* src/gtk/x11menu.h: added.

	* src/gtk/gtk_subwin.c (sub_window_create): add accel group to sub
	window.

	* src/gtk/x11view.c (AddList): bug fix: call GRAdellist() when
	inst2 == NULL.

2008-08-14  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11opt.c (DefaultDialogClose): check
	NgraphApp.FileWin.Win->window etc.

2008-08-11  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11menu.c (MARK_PIX_SIZE): change mark size from 28 to 24.

	* src/gtk/x11file.c (create_type_combo_box): added.
	(select_type, start_editing_type): modified for tree model.

	* src/gtk/gtk_liststore.c (start_editing_obj): use GtkTreeModel
	for combo_box.

2008-08-08  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/gtk_liststore.c (start_editing_obj): added.
	(create_column): set some properties to GtkCellRenderer.
	set start_editing virtual function.

	* src/gtk/gtk_subwin.c (set_obj_cell_renderer_cb): added.

	* src/gtk/x11file.c (select_type, start_editing_type): added.
	(CmFileWindow): call set_obj_cell_renderer_cb.

2008-08-06  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* initfile/.Ngraph: add save_image().
	add -png, -ps, -eps, -pdf and -svg option.

	* src/gtk/main.c (inputynconsole): add message ' [yn] '.
	use strchr() to check input character.
	read while '\n' appear.

2008-08-05  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/ox11menu.h (struct menulocal): add member 'expandtofullpath'

	* src/gtk/ox11menu.c (mgtkloadconfig): add condition for
	'expand_to_fullpath'
	(menuinit): initialize Menulocal.expandtofullpath.

	* src/gtk/x11commn.c (ToFullPath): added.
	(LoadNgpFile): call ToFullPath() when 'Menulocal.expandtofullpath
	&& (!ignorepath)'

	* src/ioutil.c (getfullpath): argument of changefilename() is
	'name'.

	* src/object.c (memrealloc): add sleep().

	* src/shellux.c (cmtest): add condition
	'(strcmp2(argv[i+1],"=")!=0) && (strcmp2(argv[i+1],"!=")!=0)'

	* src/jnstring.h: added.

	* src/jnstring.c: added.

	* src/ngraph.h (ALIGNSIZE): added.

2008-07-24  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11file.c (get_axis_obj_str): added.
	(file_list_set_val): use get_axis_obj_str().
	(start_editing): check axis object.

2008-07-23  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11file.c (select_axis, select_axis_x, select_axis_y):
	added.
	(start_editing): use "changed" signal.

	* src/gtk/x11axis.c (select_type): added.
	(start_editing): use "changed" signal.

2008-07-22  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11file.c (edited_y, edited_x, edited_axis)
	(start_editing): added.
	(CmFileWindow): call set_combo_cell_renderer_cb().

	* src/gtk/x11axis.c (start_editing, edited): added.
	(CmAxisWindow): call set_combo_cell_renderer_cb().

	* src/gtk/gtk_subwin.c (set_combo_cell_renderer_cb): added.

	* src/gtk/gtk_liststore.c (create_column): add case G_TYPE_ENUM.
	(create_tree_view): column type of G_TYPE_ENUM is string.

	* src/gtk/x11menu.c: add global variables RecentGraph and
	RecentData.
	(create_recent_graph_menu, create_recent_data_menu): added.
	(create_graphmenu): call create_recent_graph_menu.
	(create_filemenu): call create_recent_data_menu.

	* src/gtk/gtk_subwin.c (modify_numeric, modify_string): check the
	value is modified or not.
	(ev_button_down, ev_button_down_tree): return FALSE when locked.

2008-07-18  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11dialg.c (search_id): added.
	(SelectDialogSetup, SelectDialogSetup): add id column. check id
	column insteadof index.

	* src/gtk/x11lgnd.c (LegendLineCB, LegendRectCB, LegendArcCB)
	(LegendTextCB): remove id.

	* src/gtk/x11file.c (FitCB): remove id.

	* src/gtk/x11commn.c (FileCB): remove id.

	* src/gtk/x11axis.c (AxisDialogFile): always get scale type.
	(AxisDialogSetup): bug fix: widget type of Scale setting is
	GtkComboBox.
	(AxisCB, GridCB): remove id.

	* src/gtk/x11file.c (MathDialogSetup, MathDialogList): now math
	dialog can be sorted.

	* src/gtk/gtk_liststore.c (list_store_path_get_int): added.

	* src/gtk/x11file.c (FileMoveDialogSetup, FileMaskDialogSetup):
	now lists of masked and moved data are sorted by line number.

	* src/gtk/gtk_liststore.c (list_store_set_sort_column)
	(list_store_set_sort_all): added.

2008-07-17  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/ogra2cairo.c (gra2cairo_output): in the case 'V' call
	cairo_reset_clip() before clip rectangle and restore clip region
	when local->region is not NULL.

	* src/shell.c (checkcmd): bug fix: initialize prmcur->prmno as
	NULL when prmcur->str[1] == ';'.
	(checkcmd): fix indent.

	* src/gtk/ogra2x11.c (gtkinit): free gra2cairo_local when failed.

	* src/gtk/ogra2gdk.c (g2g_init): free gra2cairo_local when failed.

	* src/gtk/ox11menu.c (menuinit): free gra2cairo_local when failed.

	* src/gtk/ogra2cairo.c (gra2cairo_free): added.
	(gra2cairo_init): call free_conf() only when Instance == 0.

	* src/gtk/ogra2cairofile.c (gra2cairofile_init): free
	gra2cairo_local when failed.

2008-07-16  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/gtk_subwin.c (start_editing, cancel_editing)
	(numeric_cb, string_cb): added.
	(set_cell_renderer_cb): set callback functions when type is
	G_TYPE_DOUBLE, G_TYPE_INT or G_TYPE_STRING.
	(modify_numeric, modify_string): added.

	* src/gtk/gtk_liststore.h (_list_store): add min, max, inc and
	page.

	* src/gtk/gtk_liststore.c (create_column): set "editable",
	"adjustment", "digits" and "user-data" properties to renderer when
	editable is TRUE.

	* src/ofile.c (closedata): call set_data_progress();

	* src/gtk/x11dialg.c (SetObjFieldFromWidget)
	(SetWidgetFromObjField): added.

2008-07-15  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11dialg.c (SetTextFromObjPoints)
	(SetObjPointsFromText): added.
	(SetObjFieldFromStyle): call SetObjPointsFromText() to set value.
	(SetStyleFromObjField): call SetTextFromObjPoints() to set value.

	* src/gtk/x11axis.c (Alist): type of 'x', 'y', 'dir' and 'len' are
	G_TYPE_DOUBLE.
	(axis_list_set_val): now position and length are shown in mm.
	direction is shown in degree.

	* src/gtk/x11file.c (Flist): type of 'size' and 'width' are
	G_TYPE_DOUBLE.
	(file_list_set_val): now size and width are shown in mm.

	* src/gtk/x11merge.c (Mlist): type of 'tm', 'lm' and 'zm' are
	G_TYPE_DOUBLE.
	(merge_list_set_val): now margin and zoom are shown in mm and
	percent respectively.

	* src/gtk/x11cood.c (CoordWinSetCoord): now position is shown in
	mm.

	* src/gtk/x11menu.c (SetPoint): now position is shown in mm.

	* src/gtk/x11lgnd.c (Llist): type of 'x' and 'y' are
	G_TYPE_DOUBLE.
	(LegendLineCB, LegendRectCB, LegendArcCB): now position is shown
	in mm.
	(legend_dialog_setup_item): use SetTextFromObjPoints() for
	"points" property.
	(legend_dialog_close): use SetObjPointsFromText() for "points"
	property.
	(legend_list_set_val): now position and size are shown in mm.

	* src/gtk/gtk_liststore.c (tree_store_set_double)
	(list_store_set_double): set formated string.
	(create_tree_view): set G_TYPE_STRING when type is G_TYPE_DOUBLE.

2008-07-14  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/ofile.c (curveoutfile): remove condition "getposition2(fp,
	fp->axtype, fp->aytype, &(fp->dx), &(fp->dy)) == 0"
	(opendata): bug fix: initialize some variables when "axis" is
	FALSE.

	* src/gtk/x11gui.c (fsok): bug fix: : add braces as "(n + 1)"
	in argument of malloc.

	* src/orect.c (rectzoom): check if x1 and y1 are equal to x2 and
	y2 respectively.

	* src/oaxis.c (axisput): use TEXT_SIZE_MIN macro.

	* src/oarc.c (arczoom): check value of rx and ry.

	* src/otext.c (textgeometry): use macro; TEXT_OBJ_SCRIPT_SIZE_MIN,
	TEXT_OBJ_SCRIPT_SIZE_MAX and TEXT_SIZE_MIN.

	* src/gtk/x11print.c (OutputDataDialogSetupItem)
	(OutputDataDialogClose): use GtkSpinButton.

	* src/gtk/x11opt.c (MiscDialogSetupItem, MiscDialogSetup)
	(MiscDialogClose, ExViewerDialogSetupItem, ExViewerDialogSetup)
	(ExViewerDialogClose, ViewerDialogSetupItem, ViewerDialogSetup)
	(ViewerDialogClose):  use GtkSpinButton.

	* src/gtk/x11merge.c (MergeDialogSetup):  use GtkSpinButton.

	* src/gtk/x11lgndx.c (LegendGaussDialogSetup):  use GtkSpinButton.

	* src/gtk/x11lgnd.c (legend_dialog_setup_item)
	(legend_dialog_close, width_setup, miter_setup)
	(LegendRectDialogSetup, LegendArcDialogSetup)
	(LegendMarkDialogSetup, legend_dialog_setup_sub)
	(LegendTextDialogSetup):  use GtkSpinButton.

	* src/gtk/x11graph.c (PageDialogSetupItem, PageDialogPage)
	(PageDialogSetup, PageDialogClose):  use GtkSpinButton.

	* src/gtk/x11file.c (FitDialogSetup, FileMaskDialogAdd)
	(FileLoadDialogSetup, FileMathDialogSetup)
	(FileDialogSetupCommon):  use GtkSpinButton.

	* src/gtk/x11dialg.c (SetObjFieldFromSpin, SetSpinFromObjField):
	use GtkSpinButton.

	* src/gtk/x11axis.c (gauge_syle_setup, SectionDialogSetupItem)
	(SectionDialogSetup, SectionDialogClose, CrossDialogSetupItem)
	(CrossDialogSetup, CrossDialogClose, ZoomDialogSetup)
	(ZoomDialogClose, AxisBaseDialogSetup, AxisPosDialogSetup)
	(NumDialogSetup, AxisFontDialogSetup, AxisDialogSetup): use
	GtkSpinButton.

	* src/gtk/gtk_widget.c: added.

2008-07-11  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/gtk_liststore.c (create_column): set "mode" attribute as
	GTK_CELL_RENDERER_MODE_ACTIVATABLE when the column is editable.

	* src/gtk/gtk_subwin.c (set_cell_renderer_cb, toggle_cb): added.
	(list_sub_window_create, tree_sub_window_create): call
	set_cell_renderer_cb().

2008-07-05  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11file.c (FileMoveDialogSetup, FileMaskDialogSetup):
	add copy button.
	(FileMaskDialogClose, FileMoveDialogClose): add case for IDCOPY.
	(FileMoveDialogCopy, FileMaskDialogCopy): added.

2008-07-04  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11menu.c (SetCaption): free 'buf'.

	* src/ogra.c (set_progress_val): initialize progress bar when 'i == 0'.

	* src/gtk/ogra2cairo.c (gra2cairo_done): free 'local->fontalias'.

	* src/gtk/x11file.c (file_list_set_val, FileDialogSetupItem): free
	'valstr'.

	* src/gtk/ogra2cairo.c (free_conf): free fontmap.

	* src/gtk/gtk_entry_completion.c (add_completion): free 'buf'.

	* src/gtk/ogra2gtkprint.c (create_cairo): remove cairo_destroy().
	(gra2gtkprint_done): set NULL to local->cairo.

	* src/gtk/x11graph.c (PageDialogPage): width and height entry is
	sensitive only when paper type is custom.

	* src/gtk/ox11menu.h (struct menulocal): add PaperLandscape,
	PaperId and PaperName.
	(enum paper_id): added.

	* src/gtk/x11graph.c (PageDialogClose): check paper size.
	(set_paper_type): added.
	(struct pagelisttype, pagelist): add name, landscape and id;

	* src/gtk/x11commn.c (CheckPage): bug fix: remove redundant return.

2008-07-03  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11graph.c (CmGraphMenu): call CmOutputPrinter() when
	sel == MenuIdOutputDriver.

	* src/gtk/ogra2gtkprint.c: added.

	* src/gtk/x11print.c (CmOutputPrinter, draw_page)
	(struct print_obj): added.
	add global variable PrintSettings.

	* src/gtk/ogra2cairo.c (gra2cairo_output): save current point
	after call cairo_stroke() for graphic command 'T'.

	* src/ofile.c (fitout): fitout is now static.

	* src/ofit.c (fitpoly): bug fix: write information in 'buf'
	instead of 'equation'.

	* src/gtk/x11file.c (FitDialogSetupItem, FitDialogSave)
	(FitDialogApply): bug fix: poly_dimension is active item + 1.

	* src/gtk/x11commn.c (GetDrawFiles): added.

	* src/gtk/x11print.c (CmPrintDataFile): now CmPrintDataFile() can
	output multi data files into one file.

	* src/gtk/x11commn.c (SetFileHidden): add arraydel(&ifarray) when
	return value of DialogExecute() is not IDOK.

	* src/ofile.c (f2doutputfile): add append mode.
	(file2d): change arguments of "output_file" from "si" to "sib".

2008-07-02  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11view.c (create_pix): add settings for antialias.
	(OpenGC, ReopenGC): add settings for pixel_dot_x and pixel_dot_y.

	* src/gtk/x11opt.c (DefaultDialogClose, ViewerDialogSetupItem)
	(ViewerDialogSetup, ViewerDialogClose): add settings for antialias.

	* src/gtk/ox11menu.c (mgtkloadconfig, menuinit): add settings for
	antialias.
	(mxdpi): add settings for pixel_dot_x and pixel_dot_y.
	(mxd2p, mxd2px, mxd2py, mxp2d): use pixel_dot_x and pixel_dot_y.
	remove gtk_output().

	* src/gtk/ogra2x11.c (gtkinit): add settings for dpix and dpiy.
	(dot2pixel): use pixel_dot_x.

	* src/gtk/ogra2gdk.c (g2g_init): add settings for dpix and dpiy.

	* src/gtk/ogra2cairofile.c (gra2cairofile_init): add settings for
	dpix and dpiy

	* src/gtk/ogra2cairo.c (gra2cairo_antialias_type)
	(gra2cairo_set_antialias, set_antialias): added.
	(gra2cairo_output, gra2cairo_init): add antialias settings.
	(gra2cairo): add member "antialias", "dpix" and "dpiy".
	(mxp2dw, mxd2pw, mxp2dh, mxd2ph, mxd2px, mxd2py): added.
	(gra2cairo_init, gra2cairo_set_dpi): add settings for pixel_dot_x
	and pixel_dot_y.
	(gra2cairo_set_dpi_x, gra2cairo_set_dpi_y): added.
	(draw_str, gra2cairo_output): use mxp2dw(), mxd2pw(), mxp2dh(),
	mxd2ph(), mxd2px() and mxd2py().

	* src/gtk/ogra2cairo.h (struct gra2cairo_local): add antialias,
	pixel_dot_x and pixel_dot_y.

2008-07-01  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11menu.c (create_image_outputmenu): added.
	(create_outputmenu): add "Export image" sub menu.

	* src/gtk/x11menu.h (enum MenuID): add MenuId MenuIdOutputPSFile,
	MenuIdOutputEPSFile, MenuIdOutputPDFFile, MenuIdOutputPNGFile and
	MenuIdOutputSVGFile.

	* src/gtk/x11print.c (OutputImageDialogSetupItem)
	(OutputImageDialogSetup, OutputImageDialogClose)
	(OutputImageDialog, CmOutputImage): added.
	(CmOutputMenu): add case MenuIdOutputPSFile, MenuIdOutputEPSFile,
	MenuIdOutputPDFFile, MenuIdOutputPNGFile and MenuIdOutputSVGFile.

2008-06-30  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11menu.c (MARK_PIX_SIZE): change mark pix size.

	* src/gra.c (GRAmark): fix size of triangle.

	* src/gtk/ox11menu.c: remove mxsaveGC() and mxrestoreGC().

	* src/gtk/x11file.c (draw_type_pixbuf): use gra2gdk.

	* src/gtk/x11lgndx.c (LegendGaussDialogPaint): use gra2gdk.

	* src/gtk/x11menu.c (create_markpixmap): use gra2gdk.
	(find_gra2gdk_inst): added.

	* src/gtk/x11view.c (ViewerWinSetup): call OpenGRA() after
	OpenGC().

	* src/gtk/Makefile.am (libngraph_la_SOURCES): add ogra2cairo.c,
	ogra2cairo.h, ogra2cairofile.c, ogra2x11.h, ogra2gdk.c and
	ogra2gdk.h

2008-06-27  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/ogra2x11.c (gtkinit): gtkclose() is now called when
	"delete-event" signal is emitted.
	object 'gra2gtk' is now child of 'gra2cairo'.

2008-06-25  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/ogra2cairofile.c: added.

	* src/gtk/ogra2cairo.c: added.

2008-06-22  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11merge.c: remove ev_key_down().
	(CmMergeWindow): remove setting for d->ev_key.

	* src/gtk/x11axis.c: remove ev_key_down().
	(CmAxisWindow): remove setting for d->ev_key.

	* src/gtk/strconv.c (ascii2greece): bug fix: dlen must be "slen *
	2 + 1".
	(str2utf8): bug fix: dlen must be "slen * 6 + 1".

	* src/gtk/ogra2x11.c (gtk_charwidth, gtk_charheight): save and
	restore fontdir, fontsin and fontcos and set fontdir as 0 before
	call draw_str().

	* src/gtk/gtk_subwin.c (ev_key_down): add case for "GDK_SPACE"

	* src/gtk/gtk_liststore.c (create_tree_view): bug fix: add braces
	as "(n + cnum)" in argument of malloc.

2008-06-19  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11menu.c (detach_toolbar, create_toolbar): added.
	(setupwindow): use create_toolbar().

	* src/gtk/x11view.c (reorder_object): added.
	(ViewTop, ViewLast): use reorder_object().
	(ViewCopyAxis): added.
	(ViewCopy): use ViewCopyAxis().

2008-06-18  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11commn.c (ProgressDialogCreate): set cursor to GDK_WATCH.
	(ProgressDialogFinalize): restore cursor.

	* src/gtk/x11menu.c (GetCursor): added.

	* src/gtk/x11merge.c (ev_key_down): added.

	* src/gtk/x11view.c (Focus): now merge object can be focused.

2008-06-17  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11view.c (mouse_down_move_data)
	(mouse_down_set_points, mouse_down_zoom): added.
	(ViewerEvLButtonDown): use mouse_down_move_data(),
	mouse_down_set_points() and mouse_down_zoom().
	(ViewerEvRButtonDown): use mouse_down_zoom();
	(ViewerEvRButtonDown): cancel make arc, rectangle, gauss and axis
	when Button3 is pressed.
	(create_axis, create_single_axis, create_legendx)
	(create_legend3, create_legend2, create_legend1): added.
	(ViewerEvLButtonDblClk): use create_axis(), create_single_axis(),
	create_legendx(), create_legend3(), create_legend2() and
	create_legend1().
	(clear_focus_obj, UnFocus): add argument "int init_cursor".

2008-06-16  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11view.c (add_focus_obj, clear_focus_obj)
	(mouse_down_point, mouse_down_move, mouse_up_point)
	(set_mouse_cursor_hover, mouse_up_drag, mouse_up_zoom)
	(mouse_up_change, mouse_up_lgend1, mouse_up_lgend2): added.
	(Match, Focus): use add_focus_obj();
	(ViewerWinUpdate, UnFocus, ViewUpdate): use clear_focus_obj();
	(ViewerEvLButtonUp): use mouse_down_point(), mouse_up_drag(),
	mouse_up_zoom() and mouse_up_change().

	* src/gtk/x11menu.c (Command2_data): add move tool button.
	(createcommand2): default sensitivity of the MoveButton is false.
	(SetMoveButtonState): added.
	(SetCursor): add GDK_FLEUR.

	* src/gtk/x11view.c (enum ViewerPopupIdn): add alignment id.
	(struct viewer_popup): add member 'struct viewer_popup *submenu'
	(create_menu): added.
	(create_popup_menu): add alignment submenu. use create_menu.
	(AlignFocusedObj): added.
	(do_popup): add codes for alignment submenu.
	(check_focused_obj): added.
	(Focus): add argument "int add". add codes for multiple focus.
	(ViewerPopupMenu): call AlignFocusedObj().

	* src/gtk/x11axis.c (ev_key_down): check 'e->state &
	GDK_SHIFT_MASK' when e->keyval == GDK_space.

	* src/gtk/gtk_subwin.c (focus, tree_focus): add argument "int
	add".
	(ev_key_down_tree): check 'e->state & GDK_SHIFT_MASK' when
	e->keyval == GDK_space.
	(list_sub_window_add_focus, tree_sub_window_add_focus): added.

2008-06-13  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11lgnd.c (legend_dialog_close)
	(legend_dialog_setup_item, LegendRectDialogSetup): use width and
	height instaed of x2 and y2 for legend rectangle.

	* src/gtk/x11view.c (swapint): added.
	(ViewerEvLButtonDblClk): x2 and y2 are always greater than x1 and
	y2 respectivery.

2008-06-12  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11view.c (EvalDialogSetup): now "X" and "Y" is string.
	(EvalDialogSetupItem): add string converted from double.

	* src/gtk/x11file.c (FileMoveDialogClose): x and y is converted
	from string to double.
	(FileMoveDialogSetup): now "X" and "Y" is string.
	(FileMoveDialogAdd): add string converted from double.

	* src/omerge.c (mergeinit): initialize "line_num".

	* src/ogra.c (set_progress_val): added.
	(oGRAdraw): use set_progress_val().
	(oGRAdrawparent): call set_progress_val().

	* src/omerge.c (mergeredraw): check redraw_num.

	* src/gra.c (_GRAredraw): set "redraw_flag" as FALSE when redrawf
	is zero.
	(GRAredraw2, GRAredraw, _GRAredraw): replace redrawf to redraw_num.

	* src/omerge.c (merge): add "line_num"

	* src/oaxis.c (axisautoscalefile): display "group" property when
	the property is not NULL.

	* src/gtk/x11axis.c (axis_list_set_val): get "group" instead of "name".

	* src/gtk/ox11menu.c (mx_redraw): remove set_draw_lock().

	* src/gtk/x11view.c (AddInvalidateRect, Match): remove set_draw_lock().

	* src/gtk/x11menu.c (ChkInterrupt): do gtk_main_iteration_do() only
	when DrawLock == DrawLockDraw.

	* src/gtk/ox11menu.c (mx_output): bug fix: add 360 to
	Mxlocal->fontdir when Mxlocal->fontdir is negative.

	* configure.in: required version of GTK+ is greater than 2.12
	because gtk_tool_item_set_tooltip_text() is available since 2.12.

2008-06-10  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11commn.c (FreeConsole): restore ninterrupt.

	* driver/gra2wmf.c (draw, getboundingbox): bug fix: reported at
	http://www2e.biglobe.ne.jp/~isizaka/bbs_old/light.cgi [670].

	* src/gtk/ox11menu.c (mx_get_focused): added.
	(gtkmenu): add "focused".

	* src/gtk/x11dialg.c (CopyDialogSetup, SelectDialogSetup): select
	item if there is only one item.

	* src/gtk/x11view.c (Match, AddInvalidateRect): add
	set_draw_lock().

	* src/gtk/x11menu.c (save_hist): bug fix: remove redundant return.

	* src/gtk/x11opt.c (ViewerDialogSetupItem, ViewerDialogSetup)
	(ViewerDialogClose): add settings for "redraw_num".

	* src/gtk/ox11menu.c (menuinit): set "redraw_num".
	(mxredraw_num): added.
	(mx_redraw): check Mxlocal->redrawf_num.
	(mgtkloadconfig): get Mxlocal->redrawf_num from init file.
	(menuinit): initialize Mxlocal->redrawf_num.
	(gtkmenu): add "redraw_num"

	* src/odraw.c (draw): add "redraw_num".

	* src/gra.c (_GRAredraw): set "redraw_num".

	* src/ofile.c (f2dredraw): check "redraw_num".

	* src/gtk/x11commn.c (ProgressDialogFinalize)
	(ProgressDialogCreate): call set_draw_lock().

	* src/gtk/x11menu.c (ChkInterrupt): check DrawLock.
	(set_draw_lock): added.
	add DrawLock.

	* src/gtk/ox11menu.c (mx_redraw): call set_draw_lock().

	* src/gtk/x11commn.c: add ProgressBar2.

	* src/ogra.c (oGRAdraw): call set_progress().

	* src/gtk/x11print.c (CmOutputDriver, CmOutputViewer)
	(CmPrintGRAFile, CmPrintDataFile): call ProgressDialogCreate() and
	ProgressDialogFinalize().

2008-06-09  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/ofit.c (fituser): call set_progress() instead of
	ndisplaystatus().

	* src/ioutil.c add ShowProgressFunc, set_progress_func() and
	set_progress().

	* src/ofile.c add set_data_progress().
	(getdata): call set_data_progress().

	* src/gtk/x11menu.c (Command1_data): remove do_interrupt.
	(application): remove snooper_id, gtk_key_snooper_remove() and
	gtk_key_snooper_install().

	* src/gtk/x11commn.c add global variables ProgressBar and
	ProgressDiaog.  add ProgressDialogCreate(),
	ProgressDialogFinalize() and ProgressDialogSetTitle().

	* src/gtk/x11view.c (Draw): call ProgressDialogCreate(),
	ProgressDialogFinalize() and ProgressDialogSetTitle().

	* src/object.c (addobject): add alignment for 64bit architecture.

2008-06-08  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11view.c (ViewerWinFileUpdate): bug fix: reported at
	http://www2e.biglobe.ne.jp/~isizaka/bbs_old/light.cgi [802]-[805].
	(ViewerEvLButtonDown, ViewerEvRButtonDown): use nround() when
	change dpi.
	(ViewerEvScroll): bug fix: d->VScroll to d->HScroll.

2008-06-07  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/main.c (main): add g_set_application_name().

	* src/gtk/x11menu.c (application): remove
	g_set_application_name().

	* src/gtk/x11gui.c (FileSelectionDialog): call ResetEvent() after
	gtk_widget_destroy().

2008-06-04  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/shell.c (ngraphenvironment): add $NGRAPHHOME to PATH.

	* src/ofile.c (f2dsettings): ignore remark character placed at the
	top of the line.

2008-06-03  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11opt.c (DefaultDialogClose): add preserve_width.
	(MiscDialogSetupItem): add preserve_width.
	(MiscDialogSetup): add preserve_width.
	(MiscDialogClose): add preserve_width.
	(MiscDialogClose): add preserve_width.

	* src/gtk/ox11menu.c (mgtkloadconfig): add preserve_width.

	* src/gtk/x11view.c (ViewerEvLButtonUp): add preserve_width.

	* src/orect.c (rectzoom): add preserve_width.

	* src/omark.c (markzoom): add preserve_width.

	* src/olegend.c (legendzoom): add preserve_width.

	* src/oaxis.c (axiszoom2): add preserve_width.

	* src/oarc.c (arczoom): add preserve_width.

	* src/gtk/gtk_liststore.c (create_tree_view): add
	gtk_tree_view_column_set_resizable();

	* src/gtk/x11file.c (FileDialogSetup): check string by
	g_utf8_validate();

	* src/gtk/x11lgnd.c (legend_list_set_val): use g_utf8_strncpy()
	instead of strncpy().

2008-06-02  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11axis.c (AxisPosDialogSetupItem): add
	combo_box_clear(d->adjust).

	* src/gtk/ox11menu.c (mx_output): in the case 'V': remove
	Mxlocal->scrollx and Mxlocal->scrolly.
	(mx_output): in the case 'V': second argument must be mxd2py and
	third argument must be mxd2px.

	* src/gtk/x11view.c (MakeRuler): use mxd2p() instead of mxd2px()
	and mxd2y().

2008-05-30  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11view.c (CloseGC): fix conditional
	expression ("Mxlocal->font[i].fontalias != NULL" to
	"Mxlocal->font[i].fontalias != NULL").

	* src/gtk/ox11menu.c (menudone): free Mxlocal->font[i].fontalias
	and Mxlocal->font[i].font only when Mxlocal->font[i].fontalias is
	not NULL.

	* src/gtk/gtk_subwin.c (sub_window_minimize): do nothing when a
	sub window is already iconified.

2008-05-27  gettextize  <bug-gnu-gettext@gnu.org>

	* Makefile.am (SUBDIRS): Add po, m4.
	(ACLOCAL_AMFLAGS): New variable.
	(EXTRA_DIST): Add config.rpath.

	* configure.in (AC_CONFIG_FILES): Add po/Makefile.in, m4/Makefile.

