2008-06-27  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/ogra2x11.c (gtkinit): gtkclose() is now called when
	"delete-event" signal is emitted.
	object 'gra2gtk' is now chiled of 'gra2cairo'.

2008-06-25  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/ogra2cairofile.c: add.

	* src/gtk/ogra2cairo.c: add.

2008-06-22  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11merge.c: remove ev_key_down().
	(CmMergeWindow): remove setting for d->ev_key.

	* src/gtk/x11axis.c: remove ev_key_down().
	(CmAxisWindow): remove setting for d->ev_key.

	* src/gtk/strconv.c (ascii2greece): bug fix. dlen must be "slen *
	2 + 1".
	(str2utf8): bug fix. dlen must be "slen * 6 + 1".

	* src/gtk/ogra2x11.c (gtk_charwidth, gtk_charheight): save and
	restore fontdir, fontsin and fontcos and set fontdir as 0 before
	call draw_str().

	* src/gtk/gtk_subwin.c (ev_key_down): add case for "GDK_SPACE"

	* src/gtk/gtk_liststore.c (create_tree_view): bug fix. add braces
	as "(n + cnum)" in argument of malloc.

2008-06-19  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11menu.c (detach_toolbar, create_toolbar): add.
	(setupwindow): use create_toolbar().

	* src/gtk/x11view.c (reorder_object): add.
	(ViewTop, ViewLast): use reorder_object().
	(ViewCopyAxis): add.
	(ViewCopy): use ViewCopyAxis().

2008-06-18  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11commn.c (ProgressDialogCreate): set cursor to GDK_WATCH.
	(ProgressDialogFinalize): restore cursor.

	* src/gtk/x11menu.c (GetCursor): add.

	* src/gtk/x11merge.c (ev_key_down): add.

	* src/gtk/x11view.c (Focus): now merge object can be focused.

2008-06-17  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11view.c (mouse_down_move_data)
	(mouse_down_set_points, mouse_down_zoom): add.
	(ViewerEvLButtonDown): use mouse_down_move_data(),
	mouse_down_set_points() and mouse_down_zoom().
	(ViewerEvRButtonDown): use mouse_down_zoom();
	(ViewerEvRButtonDown): cancel make arc, rectangle, gauss and axis
	when Button3 is pressed.
	(create_axis, create_single_axis, create_legendx)
	(create_legend3, create_legend2, create_legend1): add.
	(ViewerEvLButtonDblClk): use create_axis(), create_single_axis(),
	create_legendx(), create_legend3(), create_legend2() and
	create_legend1().
	(clear_focus_obj, UnFocus): add argument "int init_cursor".

2008-06-16  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11view.c (add_focus_obj, clear_focus_obj)
	(mouse_down_point, mouse_down_move, mouse_up_point)
	(set_mouse_cursor_hover, mouse_up_drag, mouse_up_zoom)
	(mouse_up_change, mouse_up_lgend1, mouse_up_lgend2): add.
	(Match, Focus): use add_focus_obj();
	(ViewerWinUpdate, UnFocus, ViewUpdate): use clear_focus_obj();
	(ViewerEvLButtonUp): use mouse_down_point(), mouse_up_drag(),
	mouse_up_zoom() and mouse_up_change().

	* src/gtk/x11menu.c (Command2_data): add move tool button.
	(createcommand2): default sensitivity of the MoveButton is false.
	(SetMoveButtonState): add.
	(SetCursor): add GDK_FLEUR.

	* src/gtk/x11view.c (enum ViewerPopupIdn): add alignment id.
	(struct viewer_popup): add member 'struct viewer_popup *submenu'
	(create_menu): add.
	(create_popup_menu): add alignment submenu. use create_menu.
	(AlignFocusedObj): add.
	(do_popup): add codes for alignment submenu.
	(check_focused_obj): add.
	(Focus): add argument "int add". add codes for multiple focus.
	(ViewerPopupMenu): call AlignFocusedObj().

	* src/gtk/x11axis.c (ev_key_down): check 'e->state &
	GDK_SHIFT_MASK' when e->keyval == GDK_space.

	* src/gtk/gtk_subwin.c (focus, tree_focus): add argument "int
	add".
	(ev_key_down_tree): check 'e->state & GDK_SHIFT_MASK' when
	e->keyval == GDK_space.
	(list_sub_window_add_focus, tree_sub_window_add_focus): add.

2008-06-13  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11lgnd.c (legend_dialog_close)
	(legend_dialog_setup_item, LegendRectDialogSetup): use width and
	height instaed of x2 and y2 for legend rectangle.

	* src/gtk/x11view.c (swapint): add.
	(ViewerEvLButtonDblClk): x2 and y2 are always greater than x1 and
	y2 respectivery.

2008-06-12  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11view.c (EvalDialogSetup): now "X" and "Y" is string.
	(EvalDialogSetupItem): add string converted from double.

	* src/gtk/x11file.c (FileMoveDialogClose): x and y is converted
	from string to double.
	(FileMoveDialogSetup): now "X" and "Y" is string.
	(FileMoveDialogAdd): add string converted from double.

	* src/omerge.c (mergeinit): initialize "line_num".

	* src/ogra.c (set_progress_val): add.
	(oGRAdraw): use set_progress_val().
	(oGRAdrawparent): call set_progress_val().

	* src/omerge.c (mergeredraw): check redraw_num.

	* src/gra.c (_GRAredraw): set "redraw_flag" as FALSE when redrawf
	is zero.
	(GRAredraw2, GRAredraw, _GRAredraw): replacec redrawf to redraw_num.

	* src/omerge.c (merge): add "line_num"

	* src/oaxis.c (axisautoscalefile): display "groupe" property when
	the property is not NULL.

	* src/gtk/x11axis.c (axis_list_set_val): get "group" instead of "name".

	* src/gtk/ox11menu.c (mx_redraw): remove set_draw_lock().

	* src/gtk/x11view.c (AddInvalidateRect, Match): remove set_draw_lock().

	* src/gtk/x11menu.c (ChkInterrupt): do gtk_main_iteration_do() only
	when DrawLock == DrawLockDraw.

	* src/gtk/ox11menu.c (mx_output): bug fix add 360 to
	Mxlocal->fontdir when Mxlocal->fontdir is negative.

	* configure.in: required version of GTK+ is greater than 2.12
	because gtk_tool_item_set_tooltip_text() is available since 2.12.


2008-06-10  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11commn.c (FreeConsole): restore ninterrupt.

	* driver/gra2wmf.c (draw, getboundingbox): fix bug reported at
	http://www2e.biglobe.ne.jp/~isizaka/bbs_old/light.cgi [670].

	* src/gtk/ox11menu.c (mx_get_focused): add.
	(gtkmenu): add "focused".

	* src/gtk/x11dialg.c (CopyDialogSetup, SelectDialogSetup): select
	item if there is only one item.

	* src/gtk/x11view.c (Match, AddInvalidateRect): add
	set_draw_lock().

	* src/gtk/x11menu.c (save_hist): fix bug: remove redundant return.

	* src/gtk/x11opt.c (ViewerDialogSetupItem, ViewerDialogSetup)
	(ViewerDialogClose): add settings for "redraw_num".

	* src/gtk/ox11menu.c (menuinit): set "redraw_num".
	(mxredraw_num): add.
	(mx_redraw): check Mxlocal->redrawf_num.
	(mgtkloadconfig): get Mxlocal->redrawf_num from init file.
	(menuinit): initialize Mxlocal->redrawf_num.
	(gtkmenu): add "redraw_num"

	* src/odraw.c (draw): add "redraw_num".

	* src/gra.c (_GRAredraw): set "redraw_num".

	* src/ofile.c (f2dredraw): check "redraw_num".

	* src/gtk/x11commn.c (ProgressDialogFinalize)
	(ProgressDialogCreate): call set_draw_lock().

	* src/gtk/x11menu.c (ChkInterrupt): check DrawLock.
	(set_draw_lock): add.
	add DrawLock.

	* src/gtk/ox11menu.c (mx_redraw): call set_draw_lock().

	* src/gtk/x11commn.c: add ProgressBar2.

	* src/ogra.c (oGRAdraw): call set_progress().

	* src/gtk/x11print.c (CmOutputDriver, CmOutputViewer)
	(CmPrintGRAFile, CmPrintDataFile): call ProgressDialogCreate() and
	ProgressDialogFinalize().


2008-06-09  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/ofit.c (fituser): call set_progress() instead of
	ndisplaystatus().

	* src/ioutil.c add ShowProgressFunc, set_progress_func() and
	set_progress().

	* src/ofile.c add set_data_progress().
	(getdata): call set_data_progress().

	* src/gtk/x11menu.c (Command1_data): remove do_interrupt.
	(application): remove snooper_id, gtk_key_snooper_remove() and
	gtk_key_snooper_install().

	* src/gtk/x11commn.c add global variables ProgressBar and
	ProgressDiaog.  add ProgressDialogCreate(),
	ProgressDialogFinalize() and ProgressDialogSetTitle().

	* src/gtk/x11view.c (Draw): call ProgressDialogCreate(),
	ProgressDialogFinalize() and ProgressDialogSetTitle().

	* src/object.c (addobject): add alignment for 64bit architecture.


2008-06-08  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11view.c (ViewerWinFileUpdate): fix bug reported at
	http://www2e.biglobe.ne.jp/~isizaka/bbs_old/light.cgi [802]-[805].
	(ViewerEvLButtonDown, ViewerEvRButtonDown): use nround() when
	change dpi.
	(ViewerEvScroll): fix bug d->VScroll to d->HScroll.


2008-06-07  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/main.c (main): add g_set_application_name().

	* src/gtk/x11menu.c (application): remove
	g_set_application_name().

	* src/gtk/x11gui.c (FileSelectionDialog): call ResetEvent() after
	gtk_widget_destroy().


2008-06-04  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/shell.c (ngraphenvironment): add $NGRAPHHOME to PATH.

	* src/ofile.c (f2dsettings): ignore remark character placed at the
	top of the line.


2008-06-03  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11opt.c (DefaultDialogClose): add preserve_width.
	(MiscDialogSetupItem): add preserve_width.
	(MiscDialogSetup): add preserve_width.
	(MiscDialogClose): add preserve_width.
	(MiscDialogClose): add preserve_width.

	* src/gtk/ox11menu.c (mgtkloadconfig): add preserve_width.

	* src/gtk/x11view.c (ViewerEvLButtonUp): add preserve_width.

	* src/orect.c (rectzoom): add preserve_width.

	* src/omark.c (markzoom): add preserve_width.

	* src/olegend.c (legendzoom): add preserve_width.

	* src/oaxis.c (axiszoom2): add preserve_width.

	* src/oarc.c (arczoom): add preserve_width.

	* src/gtk/gtk_liststore.c (create_tree_view): add
	gtk_tree_view_column_set_resizable();

	* src/gtk/x11file.c (FileDialogSetup): check string by
	g_utf8_validate();

	* src/gtk/x11lgnd.c (legend_list_set_val): use g_utf8_strncpy()
	instead of strncpy().

2008-06-02  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11axis.c (AxisPosDialogSetupItem): add
	combo_box_clear(d->adjust).

	* src/gtk/ox11menu.c (mx_output): in the case 'V': remove
	Mxlocal->scrollx and Mxlocal->scrolly.
	(mx_output): in the case 'V': second argument must be mxd2py and
	third argument must be mxd2px.

	* src/gtk/x11view.c (MakeRuler): use mxd2p() instead of mxd2px()
	and mxd2y().

2008-05-30  Ito Hiroyuki  <ZXB01226 at nifty.com>

	* src/gtk/x11view.c (CloseGC): fix conditional
	expression ("Mxlocal->font[i].fontalias != NULL" to
	"Mxlocal->font[i].fontalias != NULL").

	* src/gtk/ox11menu.c (menudone): free Mxlocal->font[i].fontalias
	and Mxlocal->font[i].font only when Mxlocal->font[i].fontalias is
	not NULL.

	* src/gtk/gtk_subwin.c (sub_window_minimize): do nothing when a
	sub window is already iconified.

2008-05-27  gettextize  <bug-gnu-gettext@gnu.org>

	* Makefile.am (SUBDIRS): Add po, m4.
	(ACLOCAL_AMFLAGS): New variable.
	(EXTRA_DIST): Add config.rpath.

	* configure.in (AC_CONFIG_FILES): Add po/Makefile.in, m4/Makefile.

